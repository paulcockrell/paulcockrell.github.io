var shadow$provide = {};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(a==Array.prototype||a==Object.prototype)return a;a[c]=b.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,c,b){if(!b||null!=a){b=$jscomp.propertyToPolyfillSymbol[c];if(null==b)return a[c];b=a[b];return void 0!==b?b:a[c]}};$jscomp.polyfill=function(a,c,b,d){c&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,c,b,d):$jscomp.polyfillUnisolated(a,c,b,d))};
$jscomp.polyfillUnisolated=function(a,c,b,d){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];if(!(e in b))return;b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})};
$jscomp.polyfillIsolated=function(a,c,b,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];if(!(g in d))return;d=d[g]}e=e[e.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?d[e]:null;c=c(b);null!=c&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:c}):c!==b&&(void 0===$jscomp.propertyToPolyfillSymbol[e]&&(b=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+b+"$"+e),$jscomp.defineProperty(d,$jscomp.propertyToPolyfillSymbol[e],{configurable:!0,writable:!0,value:c})))};$jscomp.arrayIteratorImpl=function(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(a){if(a)return a;var c=function(f,g){this.$jscomp$symbol$id_=f;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:g})};c.prototype.toString=function(){return this.$jscomp$symbol$id_};var b="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",d=0,e=function(f){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new c(b+(f||"")+"_"+d++,f)};return e},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var c="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),b=0;b<c.length;b++){var d=$jscomp.global[c[b]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&$jscomp.defineProperty(d.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.polyfill("Symbol.asyncIterator",function(a){return a?a:Symbol("Symbol.asyncIterator")},"es9","es3");$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};
(function(){
shadow$provide[0]=function(P,X,V,ha){function R(...a){if(0===a.length)return new Y(255,255,255);if(1===a.length){if(a[0]instanceof Y)return a[0].clone();if("string"==typeof a[0])return Y.fromHex(a[0]);if(Array.isArray(a[0])&&3===a[0].length)return Y.fromArray(a[0])}else if(2===a.length){if(a[0]instanceof Y)return a[0].clone()}else if(3===a.length||4===a.length)return new Y(a[0],a[1],a[2]);throw Error("Invalid color arguments");}function ca(a){return a*Math.PI/180}function Ba(a){return 180*a/Math.PI}
function Na(a,b,c){return b>c?Na(a,c,b):Math.min(Math.max(a,b),c)}function wa(a,b,c){if("number"==typeof a&&"number"==typeof b)return a+(b-a)*c;if(a instanceof C&&b instanceof C||a instanceof Y&&b instanceof Y)return a.lerp(b,c);throw Error(`Bad value for lerp(): ${a}, ${b}. Only number, Vec2 and Color is supported.`);}function Oa(a,b,c,d,e){return d+(a-b)/(c-b)*(e-d)}function ne(a,b,c,d,e){return Na(Oa(a,b,c,d,e),d,e)}function y(...a){if(1===a.length){if(a[0]instanceof C)return new C(a[0].x,a[0].y);
if(Array.isArray(a[0])&&2===a[0].length)return new C(...a[0])}return new C(...a)}function na(a,b,c,d){return new la(a,b,c,d)}function Vc(a,b,c,d=e=>-Math.cos(e)){return a+(d(c)+1)/2*(b-a)}function oe(a){return null!=a&&(Wc.seed=a),Wc.seed}function pa(...a){return Wc.genAny(...a)}function Xc(...a){return Math.floor(pa(...(0<a.length?a:[2])))}function pe(a){return pa()<=a}function Yc(a){for(let b=a.length-1;0<b;b--){let c=Math.floor(Math.random()*(b+1));[a[b],a[c]]=[a[c],a[b]]}return a}function qe(a,
b){return a.length<=b?a.slice():Yc(a.slice()).slice(0,b)}function re(a){return a[Xc(a.length)]}function Zc(a,b){return a.pos.x+a.width>b.pos.x&&a.pos.x<b.pos.x+b.width&&a.pos.y+a.height>b.pos.y&&a.pos.y<b.pos.y+b.height}function se(a,b){if(a.p1.x===a.p2.x&&a.p1.y===a.p2.y||b.p1.x===b.p2.x&&b.p1.y===b.p2.y)return null;let c=(b.p2.y-b.p1.y)*(a.p2.x-a.p1.x)-(b.p2.x-b.p1.x)*(a.p2.y-a.p1.y);if(0===c)return null;let d=((b.p2.x-b.p1.x)*(a.p1.y-b.p1.y)-(b.p2.y-b.p1.y)*(a.p1.x-b.p1.x))/c;a=((a.p2.x-a.p1.x)*
(a.p1.y-b.p1.y)-(a.p2.y-a.p1.y)*(a.p1.x-b.p1.x))/c;return 0>d||1<d||0>a||1<a?null:d}function fc(a,b){return(b=se(a,b))?y(a.p1.x+b*(a.p2.x-a.p1.x),a.p1.y+b*(a.p2.y-a.p1.y)):null}function gc(a,b){let c=b.p2.sub(b.p1),d=Number.NEGATIVE_INFINITY,e=Number.POSITIVE_INFINITY;if(0!=c.x){var g=(a.pos.x-b.p1.x)/c.x;let h=(a.pos.x+a.width-b.p1.x)/c.x;d=Math.max(d,Math.min(g,h));e=Math.min(e,Math.max(g,h))}0!=c.y&&(g=(a.pos.y-b.p1.y)/c.y,a=(a.pos.y+a.height-b.p1.y)/c.y,d=Math.max(d,Math.min(g,a)),e=Math.min(e,
Math.max(g,a)));return e>=d&&0<=e&&1>=d}function Kb(a,b){return b.x>a.pos.x&&b.x<a.pos.x+a.width&&b.y>a.pos.y&&b.y<a.pos.y+a.height}function $c(a,b){return y(Math.max(a.pos.x,Math.min(b.center.x,a.pos.x+a.width)),Math.max(a.pos.y,Math.min(b.center.y,a.pos.y+a.height))).sdist(b.center)<=b.radius*b.radius}function ad(a,b){return bd(b,new xa(a.points()))}function hc(a,b){b=b.sub(a.p1);a=a.p2.sub(a.p1);if(Math.abs(b.cross(a))>Number.EPSILON)return!1;a=b.dot(a)/a.dot(a);return 0<=a&&1>=a}function tb(a,
b){var c=a.p2.sub(a.p1),d=c.dot(c),e=a.p1.sub(b.center);c=2*c.dot(e);e=e.dot(e)-b.radius*b.radius;let g=c*c-4*d*e;if(d<=Number.EPSILON||0>g)return!1;if(0==g){if(d=-c/(2*d),0<=d&&1>=d)return!0}else if(e=(-c+Math.sqrt(g))/(2*d),d=(-c-Math.sqrt(g))/(2*d),0<=e&&1>=e||0<=d&&1>=d)return!0;return Lb(b,a.p1)}function ic(a,b){if(Va(b,a.p1)||Va(b,a.p2))return!0;for(let c=0;c<b.pts.length;c++)if(fc(a,new Ca(b.pts[c],b.pts[(c+1)%b.pts.length])))return!0;return!1}function Lb(a,b){return a.center.sdist(b)<a.radius*
a.radius}function te(a,b){return a.center.sdist(b.center)<(a.radius+b.radius)*(a.radius+b.radius)}function Mb(a,b){let c=b.pts[b.pts.length-1];for(let d of b.pts){if(tb(new Ca(c,d),a))return!0;c=d}return Lb(a,b.pts[0])?!0:Va(b,a.center)}function bd(a,b){for(let c=0;c<a.pts.length;c++)if(ic(new Ca(a.pts[c],a.pts[(c+1)%a.pts.length]),b))return!0;return!(!a.pts.some(c=>Va(b,c))&&!b.pts.some(c=>Va(a,c)))}function Va(a,b){let c=!1;a=a.pts;for(let d=0,e=a.length-1;d<a.length;e=d++)a[d].y>b.y!=a[e].y>b.y&&
b.x<(a[e].x-a[d].x)*(b.y-a[d].y)/(a[e].y-a[d].y)+a[d].x&&(c=!c);return c}function jc(a,b){b=b.sub(a.center);var c=ca(a.angle);let d=Math.cos(c),e=Math.sin(c);c=b.x*d+b.y*e;b=-b.x*e+b.y*d;return 1>c*c/(a.radiusX*a.radiusX)+b*b/(a.radiusY*a.radiusY)}function Nb(a,b){var c=b.center.sub(a.center),d=ca(a.angle);let e=Math.cos(d),g=Math.sin(d);d=c.x*e+c.y*g;c=-c.x*g+c.y*e;return jc(new Wa(y(),a.radiusX+b.radius,a.radiusY+b.radius,0),y(d,c))}function cd(a,b){let c=a.toMat2().inverse;return b=new Ca(c.transform(b.p1.sub(a.center)),
c.transform(b.p2.sub(a.center))),tb(b,new Da(y(),1))}function ue(a,b){if(a.radiusX===a.radiusY)return Nb(b,new Da(a.center,a.radiusX));if(b.radiusX===b.radiusY)return Nb(a,new Da(b.center,b.radiusX));var c=new Ob(1/a.radiusX**2,0,0,0,1/a.radiusY**2,0,0,0,-1),d=new Ob(1/b.radiusX**2,0,0,0,1/b.radiusY**2,0,0,0,-1),e=a.center.x,g=a.center.y,h=b.center.x,m=b.center.y;a=ca(a.angle);b=ca(b.angle);e=new Ob(Math.cos(a),-Math.sin(a),e,Math.sin(a),Math.cos(a),g,0,0,1);h=new Ob(Math.cos(b),-Math.sin(b),h,Math.sin(b),
Math.cos(b),m,0,0,1);m=e.inverse;h=h.inverse;var k=m.transpose.mul(c).mul(m),p=h.transpose.mul(d).mul(h);d=k.m11;c=k.m12;h=k.m13;m=k.m21;e=k.m22;g=k.m23;b=k.m31;a=k.m32;let r=k.m33;k=p.m11;let B=p.m12,n=p.m13,v=p.m21,u=p.m22,z=p.m23,D=p.m31,I=p.m32,J=p.m33,N=d*e*r-d*g*a-c*m*r+c*g*b+h*m*a-h*e*b;p=(d*e*J-d*g*I-d*a*z+d*r*u-c*m*J+c*g*D+c*b*z-c*r*v+h*m*I-h*e*D-h*b*u+h*a*v+m*a*n-m*r*B-e*b*n+e*r*k+g*b*B-g*a*k)/N;d=(d*u*J-d*z*I-c*v*J+c*z*D+h*v*I-h*u*D-m*B*J+m*n*I+e*k*J-e*n*D-g*k*I+g*B*D+b*B*z-b*n*u-a*k*z+
a*n*v+r*k*u-r*B*v)/N;c=(k*u*J-k*z*I-B*v*J+B*z*D+n*v*I-n*u*D)/N;return 0<=p?!(0<-3*d+p**2&&0>3*p*c+d*p**2-4*d**2&&0<-27*c**2+18*c*p*d+p**2*d**2-4*p**3*c-4*d**3):!(0<-3*d+p**2&&0<-27*c**2+18*c*p*d+p**2*d**2-4*p**3*c-4*d**3)}function dd(a,b){return kc(a,new xa(b.points()))}function kc(a,b){let c=a.toMat2().inverse;return b=new xa(b.pts.map(d=>c.transform(d.sub(a.center)))),Mb(new Da(y(),1),b)}function ve(a,b){return a.x===b.x&&a.y===b.y}function we(a,b){return b instanceof C?ve(b,a.pt):b instanceof Da?
Lb(b,a.pt):b instanceof Ca?hc(b,a.pt):b instanceof ka?Kb(b,a.pt):b instanceof xa?Va(b,a.pt):b instanceof Wa?jc(b,a.pt):!1}function xe(a,b){return b instanceof C?hc(a,b):b instanceof Da?tb(a,b):b instanceof Ca?null!=fc(a,b):b instanceof ka?gc(b,a):b instanceof xa?ic(a,b):b instanceof Wa?cd(b,a):!1}function ye(a,b){return b instanceof C?Lb(a,b):b instanceof Da?te(a,b):b instanceof Ca?tb(b,a):b instanceof ka?$c(b,a):b instanceof xa?Mb(a,b):b instanceof Wa?Nb(b,a):!1}function ze(a,b){return b instanceof
C?Kb(a,b):b instanceof Da?$c(a,b):b instanceof Ca?gc(a,b):b instanceof ka?Zc(a,b):b instanceof xa?ad(a,b):b instanceof Wa?dd(b,a):!1}function Ae(a,b){return b instanceof C?Va(a,b):b instanceof Da?Mb(b,a):b instanceof Ca?ic(b,a):b instanceof ka?ad(b,a):b instanceof xa?bd(b,a):b instanceof Wa?kc(b,a):!1}function Be(a,b){return b instanceof C?jc(a,b):b instanceof Da?Nb(a,b):b instanceof Ca?cd(a,b):b instanceof ka?dd(a,b):b instanceof xa?kc(a,b):b instanceof Wa?ue(b,a):!1}function ed(a,b,c){var d=c.p1;
c=c.p2.sub(d);var e=b.cross(c);if(Math.abs(e)<Number.EPSILON)return null;let g=d.sub(a);d=g.cross(c)/e;if(0>=d||1<=d)return null;e=g.cross(b)/e;if(0>=e||1<=e)return null;c=c.normal().unit();return 0<b.dot(c)&&(c.x*=-1,c.y*=-1),{point:a.add(b.scale(d)),normal:c,fraction:d}}function Ce(a,b,c){let d=Number.NEGATIVE_INFINITY,e=Number.POSITIVE_INFINITY,g;if(0!=a.x){var h=(c.pos.x-a.x)/b.x;let m=(c.pos.x+c.width-a.x)/b.x;g=y(-Math.sign(b.x),0);d=Math.max(d,Math.min(h,m));e=Math.min(e,Math.max(h,m))}0!=
a.y&&(h=(c.pos.y-a.y)/b.y,c=(c.pos.y+c.height-a.y)/b.y,Math.min(h,c)>d&&(g=y(0,-Math.sign(b.y))),d=Math.max(d,Math.min(h,c)),e=Math.min(e,Math.max(h,c)));return e>=d&&0<=d&&1>=d?{point:a.add(b.scale(d)),normal:g,fraction:d}:null}function fd(a,b,c){let d=c.center;var e=b.dot(b),g=a.sub(d),h=2*b.dot(g);c=g.dot(g)-c.radius*c.radius;g=h*h-4*e*c;if(e<=Number.EPSILON||0>g)return null;if(0==g){if(e=-h/(2*e),0<=e&&1>=e)return a=a.add(b.scale(e)),{point:a,normal:a.sub(d),fraction:e}}else if(c=(-h+Math.sqrt(g))/
(2*e),h=(-h-Math.sqrt(g))/(2*e),e=null,0<=c&&1>=c&&(e=c),0<=h&&1>=h&&(e=Math.min(h,e??h)),null!=e)return a=a.add(b.scale(e)),{point:a,normal:a.sub(d).unit(),fraction:e};return null}function De(a,b,c){c=c.pts;let d=null;var e=c[c.length-1];for(let g=0;g<c.length;g++){let h=c[g];(e=ed(a,b,new Ca(e,h)))&&(!d||d.fraction>e.fraction)&&(d=e);e=h}return d}function Ee(a,b,c){var d=c.toMat2(),e=d.inverse,g=e.transform(a.sub(c.center));e=e.transform(b);let h=fd(g,e,new Da(y(),1));return h?(g=lc.rotation(ca(-c.angle)),
e=lc.scale(c.radiusX,c.radiusY).transform(h.point),d=d.transform(h.point).add(c.center),a=d.dist(a)/b.len(),{point:d,normal:g.transform(y(c.radiusY**2*e.x,c.radiusX**2*e.y)).unit(),fraction:a}):h}function Fe(a,b,c,d=64){let e=b.len();b=b.scale(1/e);let g=0,h=y(Math.floor(a.x),Math.floor(a.y)),m=y(0<b.x?1:-1,0<b.y?1:-1),k=y(Math.abs(1/b.x),Math.abs(1/b.y));var p=y(0<m.x?h.x+1-a.x:a.x-h.x,0<m.y?h.y+1-a.y:a.y-h.y);p=y(k.x<1/0?k.x*p.x:1/0,k.y<1/0?k.y*p.y:1/0);let r=-1;for(;g<=d;){let B=c(h);if(!0===B)return{point:a.add(b.scale(g)),
normal:y(0===r?-m.x:0,1===r?-m.y:0),fraction:g/e,gridPos:h};if(B)return B;p.x<p.y?(h.x+=m.x,g=p.x,p.x+=k.x,r=0):(h.y+=m.y,g=p.y,p.y+=k.y,r=1)}return null}function Ge(a,b,c,d){b=b.sub(a);d=d.sub(c);let e=b.cross(d);return 1E-5>e&&-1E-5<e||(e=c.sub(a).cross(d)/e,0>e||1<e)?null:a.add(b.scale(e))}function He(a,b,c,d){let e=d*d,g=1-d;return a.scale(g*g).add(b.scale(2*g*d)).add(c.scale(e))}function Ie(a,b,c,d){let e=1-d;return b.sub(a).scale(2*e).add(c.sub(b).scale(2*d))}function Je(a,b,c,d){return c.sub(b.scale(2)).add(a).scale(2)}
function mc(a,b,c,d,e){let g=e*e,h=g*e,m=1-e,k=m*m;return a.scale(k*m).add(b.scale(3*k*e)).add(c.scale(3*m*g)).add(d.scale(h))}function Ke(a,b,c,d,e){let g=e*e,h=1-e,m=h*h;return b.sub(a).scale(3*m).add(c.sub(b).scale(6*h*e)).add(d.sub(c).scale(3*g))}function Le(a,b,c,d,e){let g=1-e;return c.sub(b.scale(2)).add(a).scale(6*g).add(d.sub(c.scale(2)).add(b).scale(6*e))}function Me(a,b,c,d,e){let g=.5*((3*e-5)*e*e+2),h=.5*((-3*e+4)*e+1)*e,m=.5*(e-1)*e*e;return a.scale(.5*((-e+2)*e-1)*e).add(b.scale(g)).add(c.scale(h)).add(d.scale(m))}
function Ne(a,b,c,d,e){let g=.5*(9*e-10)*e,h=.5*((-9*e+8)*e+1),m=.5*(3*e-2)*e;return a.scale(.5*((-3*e+4)*e-1)).add(b.scale(g)).add(c.scale(h)).add(d.scale(m))}function Oe(a){let b=gd(a),c=b(1);return d=>{d=b(d*c,!0);return a(d)}}function gd(a,b=10,c=10){let d=[0],e=[0],g=1/(b-1)/c,h=0;var m=a(0);let k=0;for(let p=1;p<b;p++){for(let r=0;r<c;r++){k+=g;let B=a(k);m=B.dist(m);h+=m;m=B}d[p]=h;e[p]=k}return e[b-1]=1,(p,r=!1)=>{if(r){if(0>=p)return 0;if(p>=h)return 1;for(r=0;d[r+1]<p;)r++;var B=e[r],n=
d[r];return B+(p-n)/(d[r+1]-n)*(e[r+1]-B)}if(0>=p)return 0;if(1<=p)return d[b-1];for(r=0;e[r+1]<p;)r++;B=e[r];n=d[r];return n+(p-B)/(e[r+1]-B)*(d[r+1]-n)}}function ub(a,b,c,d){let e=2*a+b-2*d+c,g=-3*a+3*d-2*b-c;return h=>{let m=h*h;return e*m*h+g*m+b*h+a}}function hd(a,b,c,d,e,g=ub){let h=g(b.x,(1-e)*(c.x-a.x),(1-e)*(d.x-b.x),c.x),m=g(b.y,(1-e)*(c.y-a.y),(1-e)*(d.y-b.y),c.y);return k=>new C(h(k),m(k))}function Pb(a,b,c,d,e=ub){return hd(a,b,c,d,.5,e)}function Pe(a,b,c,d,e=ub){return Pb(d.add(a.sub(b).scale(6)),
a,d,a.add(d.sub(c).scale(6)),e)}function Qe(a,b,c,d,e,g,h,m=ub){let k=m(b.x,.5*(1-e)*(1+h)*(1+g)*(b.x-a.x)+.5*(1-e)*(1-h)*(1-g)*(c.x-b.x),.5*(1-e)*(1+h)*(1-g)*(c.x-b.x)+.5*(1-e)*(1-h)*(1+g)*(d.x-c.x),c.x),p=m(b.y,.5*(1-e)*(1+h)*(1+g)*(b.y-a.y)+.5*(1-e)*(1-h)*(1-g)*(c.y-b.y),.5*(1-e)*(1+h)*(1-g)*(c.y-b.y)+.5*(1-e)*(1-h)*(1+g)*(d.y-c.y),c.y);return r=>new C(k(r),p(r))}function Re(a,b,c,d){let e=2*a+b-2*d+c,g=-3*a+3*d-2*b+c;return h=>3*e*h*h+2*g*h+b}function vb(a){return 0<=a&&1>=a}function nc(a,b){return Math.abs(a-
b)<=Number.EPSILON}function wb(a){return 0>a?-Math.pow(-a,1/3):Math.pow(a,1/3)}function Se(a,b,c,d){var e=3*a-6*b+3*c,g=-3*a+3*b,h=a;c=-a+3*b-3*c+d;if(nc(c,0)){if(nc(e,0))return nc(g,0)?[]:[-h/g].filter(vb);h=Math.sqrt(g*g-4*e*h);e*=2;return[(h-g)/e,(-g-h)/e].filter(vb)}e/=c;g/=c;a=(3*g-e*e)/3;b=a/3;g=(2*e*e*e-9*e*g+h/c*27)/27;h=g/2;b=h*h+b*b*b;if(0>b)return h=-a/3,h=Math.sqrt(h*h*h),g=-g/(2*h),g=Math.acos(-1>g?-1:1<g?1:g),h=2*wb(h),[h*Math.cos(g/3)-e/3,h*Math.cos((g+2*Math.PI)/3)-e/3,h*Math.cos((g+
4*Math.PI)/3)-e/3].filter(vb);if(0===b)return g=0>h?wb(-h):-wb(h),[2*g-e/3,-g-e/3].filter(vb);a=Math.sqrt(b);g=wb(a-h);h=wb(a+h);return[g-h-e/3].filter(vb)}function Te(a,b,c,d,e){e=Se(a.x-e,b.x-e,c.x-e,d.x-e);return 0<e.length?mc(a,b,c,d,e[0]).y:NaN}function Ue(a){if(!a||0==a.length)throw Error("Need at least one point for easingLinear.");let b=a.length;return c=>{if(0>=c||1==a.length||c<=a[0].x)return a[0].y;for(let d=0;d<b;d++)if(a[d].x>=c)return Oa(c,a[d-1].x,a[d].x,a[d-1].y,a[d].y);return a[a.length-
1].y}}function Ve(a,b){return c=>Te(y(0,0),a,b,y(1,1),c)}function We(a,b="jump-end"){let c=1/a,d=1/(a+("jump-end"==b||"jump-both"==b?1:0)),e="jump-start"==b||"jump-both"==b?d:0;return g=>e+Math.floor(g/c)*d}function Xe(a,b){var c=Number.MAX_VALUE;let d={normal:y(0),distance:0};for(let k of[a,b])for(let p=0;p<k.pts.length;p++){let r=k.pts[(p+1)%k.pts.length].sub(k.pts[p]).normal().unit(),B=Number.MAX_VALUE;var e=-Number.MAX_VALUE;for(var g=0;g<a.pts.length;g++){var h=a.pts[g].dot(r);B=Math.min(B,h);
e=Math.max(e,h)}g=Number.MAX_VALUE;h=-Number.MAX_VALUE;for(var m=0;m<b.pts.length;m++){let n=b.pts[m].dot(r);g=Math.min(g,n);h=Math.max(h,n)}m=Math.min(e,h)-Math.max(B,g);if(0>m)return null;m<Math.abs(c)&&(c=h-B,e=g-e,c=Math.abs(c)<Math.abs(e)?c:e,d.normal=r,d.distance=c)}return d}function id(a,b,c){return 0<=(b.x-a.x)*(c.y-a.y)-(b.y-a.y)*(c.x-a.x)}function Ye(a){let b=0,c=a[a.length-1];for(let d=0;d<a.length;d++)b+=(a[d].x-c.x)*(a[d].y+c.y),c=a[d];return 0>b}function oc(a,b,c,d){let e=d.x-c.x;d=
d.y-c.y;return 0<=(e*(a.y-c.y)-d*(a.x-c.x))*(e*(b.y-c.y)-d*(b.x-c.x))}function Ze(a,b,c,d){return oc(a,b,c,d)&&oc(a,c,b,d)&&oc(a,d,b,c)}function $e(a,b,c,d){for(let e of a)if(e!==b&&e!==c&&e!==d&&Ze(e,b,c,d))return!0;return!1}function af(a,b,c,d){return id(a,b,c)&&!$e(d,a,b,c)}function jd(a){if(3>a.length)return[];if(3==a.length)return[a];let b=[],c=[];for(var d=0;d<a.length;d++)b[d]=d+1,c[d]=d-1;b[b.length-1]=0;c[0]=c.length-1;Ye(a)||([b,c]=[c,b]);d=[];for(var e=0;e<a.length;++e)id(a[c[e]],a[e],
a[b[e]])||d.push(a[e]);e=[];let g=a.length;var h=1;let m=0,k,p;for(;3<g;){k=b[h];p=c[h];let r=a[p];h=a[h];let B=a[k];if(af(r,h,B,d))e.push([r,h,B]),b[p]=k,c[k]=p,d.splice(d.indexOf(h),1),--g,m=0;else if(++m>g)return[];h=k}return k=b[h],p=c[h],e.push([a[p],a[h],a[k]]),e}function bf(a){if(3>a.length)return!1;let b=a.length-2,c=a.length-1,d=0,e=a[c].sub(a[b]),g=a[d].sub(a[c]),h=e.cross(g);for(;d+1<a.length;)if(b=c,c=d,d++,e=a[c].sub(a[b]),g=a[d].sub(a[c]),0>e.cross(g)*h)return!1;return!0}function cf(a){a=
window.atob(a);let b=a.length,c=new Uint8Array(b);for(let d=0;d<b;d++)c[d]=a.charCodeAt(d);return c.buffer}function df(a){return cf(a.split(",")[1])}function pc(a,b){let c=document.createElement("a");c.href=b;c.download=a;c.click()}function kd(a,b){pc(a,"data:text/plain;charset\x3dutf-8,"+b)}function ef(a,b){kd(a,JSON.stringify(b))}function ld(a,b){b=URL.createObjectURL(b);pc(a,b);URL.revokeObjectURL(b)}function qc(a,b){if(a===b)return!0;var c=typeof a,d=typeof b;if(c!==d)return!1;if("object"===c&&
"object"===d&&null!==a&&null!==b){if(Array.isArray(a)!==Array.isArray(b))return!1;c=Object.keys(a);d=Object.keys(b);if(c.length!==d.length)return!1;for(let e of c)if(!qc(a[e],b[e]))return!1;return!0}return!1}function ff(a){gf.has(a)||(gf.add(a),console.warn(a))}function kb(a,b){ff(`${a} is deprecated. Use ${b} instead.`)}function rc(a,b){return Number(a.toFixed(b))}function ja(a,b){return(...c)=>{let d=c.length;if(d===a.length)return a(...c);if(d===b.length)return b(...c)}}function hf(a){if("string"!=
typeof a)throw new TypeError("string cannot be undefined or null");let b=[],c=0,d=0;for(;c<a.length;)(d+=jf(c+d,a),kf(a[c+d])&&d++,lf(a[c+d])&&d++,mf(a[c+d])&&d++,nf(a[c+d]))?d++:(b.push(a.substring(c,c+d)),c+=d,d=0);return b}function jf(a,b){var c=b[a];if(!of(c)||a===b.length-1)return 1;c+=b[a+1];let d=b.substring(a+2,a+5);return md(c)&&md(d)?4:pf(c)&&qf(d)?b.slice(a).indexOf(String.fromCodePoint(917631))+2:rf(d)?4:2}function of(a){return a&&bb(a[0].charCodeAt(0),55296,56319)}function md(a){return bb(sc(a),
127462,127487)}function pf(a){return bb(sc(a),127988,127988)}function rf(a){return bb(sc(a),127995,127999)}function lf(a){return"string"==typeof a&&bb(a.charCodeAt(0),65024,65039)}function mf(a){return"string"==typeof a&&bb(a.charCodeAt(0),8400,8447)}function qf(a){let b=a.codePointAt(0);return"string"==typeof a&&"number"==typeof b&&bb(b,917504,917631)}function kf(a){return"string"==typeof a&&Th.includes(a.charCodeAt(0))}function nf(a){return"string"==typeof a&&8205===a.charCodeAt(0)}function sc(a){let b=
a.charCodeAt(0)-55296;a=a.charCodeAt(1)-56320;return(b<<10)+a+65536}function bb(a,b,c){return a>=b&&a<=c}function qa(){return l.app.dt()}function tc(){return l.app.fixedDt()}function uc(){return l.app.restDt()}function lb(a){switch(a){case "topleft":return Uh;case "top":return Vh;case "topright":return Wh;case "left":return Xh;case "center":return Yh;case "right":return Zh;case "botleft":return $h;case "bot":return ai;case "botright":return bi;default:return a}}function sf(a){switch(a){case "left":return 0;
case "center":return.5;case "right":return 1;default:return 0}}function tf(a){return a.createBuffer(1,1,44100)}function uf(a,b,c){let d=[];for(d.push(b);b!==a;){if(b=c.get(b),null==b)return null;d.push(b)}return d.reverse()}function vf(a,b,c){let d=new nd((m,k)=>m.cost<k.cost);d.insert({cost:0,node:b});let e=new Map;e.set(b,b);let g=new Map;for(g.set(b,0);0!==d.length;){let m=d.remove()?.node;if(m===c)break;var h=a.getNeighbours(m);for(let k of h)h=(g.get(m)||0)+a.getCost(m,k)+a.getHeuristic(k,c),
(!g.has(k)||h<g.get(k))&&(g.set(k,h),d.insert({cost:h,node:k}),e.set(k,m))}return uf(b,c,e)}function xb(a){let b=new Sa;return a.pos&&b.translate(a.pos),a.scale&&b.scale(a.scale),a.angle&&b.rotate(a.angle),a.parent?b.mult(a.parent.transform):b}function wf(a){return new C(a.x/sa()*2-1,-a.y/ta()*2+1)}function yb(a,b,c,d,e,g=1){d=ca(d%360);e=ca(e%360);e<=d&&(e+=2*Math.PI);let h=[];g=Math.ceil((e-d)/ca(8)*g);e=(e-d)/g;d=y(Math.cos(d),Math.sin(d));e=y(Math.cos(e),Math.sin(e));for(let m=0;m<=g;m++)h.push(a.add(b*
d.x,c*d.y)),d=y(d.x*e.x-d.y*e.y,d.x*e.y+d.y*e.x);return h}function xf(...a){let b=R(...a);a=a[3]??1;l.gfx.bgColor=b;l.gfx.bgAlpha=a;l.gfx.ggl.gl.clearColor(b.r/255,b.g/255,b.b/255,a)}function yf(){return l.gfx.bgColor?.clone?.()??null}function ma(...a){void 0!==a[0]&&(a=y(...a),0===a.x&&0===a.y||l.gfx.transform.translate(a))}function Ea(){l.gfx.transformStack.push(l.gfx.transform.clone())}function zf(a){l.gfx.transform=a.clone()}function zb(...a){void 0!==a[0]&&(a=y(...a),1===a.x&&1===a.y||l.gfx.transform.scale(a))}
function mb(a){a&&l.gfx.transform.rotate(a)}function ya(){0<l.gfx.transformStack.length&&(l.gfx.transform=l.gfx.transformStack.pop())}function Fa(){l.gfx.renderer.flush()}function sa(){return l.gfx.width}function ta(){return l.gfx.height}function od(){return(l.gfx.viewport.width+l.gfx.viewport.height)/(l.gfx.width+l.gfx.height)}function Af(a){return new C(a.x*l.gfx.viewport.width/l.gfx.width,a.y*l.gfx.viewport.height/l.gfx.height)}function Bf(a){return new C((a.x-l.gfx.viewport.x)*sa()/l.gfx.viewport.width,
(a.y-l.gfx.viewport.y)*ta()/l.gfx.viewport.height)}function pd(){return Bf(l.app.mousePos())}function Qb(){return y(sa()/2,ta()/2)}function Ga(a){return"string"!=typeof a||Cf(a)?a:l.assets.urlPrefix+a}function vc(a){return fetch(a).then(b=>{if(!b.ok)throw Error(`Failed to fetch "${a}"`);return b})}function Rb(a){return vc(a).then(b=>b.json())}function Df(a){return vc(a).then(b=>b.text())}function Ef(a){return vc(a).then(b=>b.arrayBuffer())}function Ff(a){return void 0!==a&&(l.assets.urlPrefix=a),
l.assets.urlPrefix}function Gf(a,b){return l.assets.custom.add(a,Rb(Ga(b)))}function Sb(a){let b=new Image;return b.crossOrigin="anonymous",b.src=a,new Promise((c,d)=>{b.onload=()=>c(b);b.onerror=()=>d(Error(`Failed to load image from "${a}"`))})}function cb(){let a=[l.assets.sprites,l.assets.sounds,l.assets.shaders,l.assets.fonts,l.assets.bitmapFonts,l.assets.custom];return a.reduce((b,c)=>b+c.progress(),0)/a.length}function qd(){return[l.assets.sprites,l.assets.sounds,l.assets.shaders,l.assets.fonts,
l.assets.bitmapFonts,l.assets.custom].reduce((a,b)=>a.concat(b.getFailedAssets()),[])}function Hf(a){return l.assets.custom.get(a)??null}function wc(a){return l.assets.custom.add(null,a)}function Tb(a){if("string"==typeof a){let b=rd(a);if(b)return b;if(1>cb())return null;throw Error(`Sprite not found: ${a}`);}if(a instanceof db)return La.loaded(a);if(a instanceof La)return a;throw Error(`Invalid sprite: ${a}`);}function rd(a){return l.assets.sprites.get(a)??null}function Ab(a,b,c={sliceX:1,sliceY:1,
anims:{}}){return b=Ga(b),Array.isArray(b)?b.some(d=>"string"==typeof d)?l.assets.sprites.add(a,Promise.all(b.map(d=>"string"==typeof d?Sb(d):Promise.resolve(d))).then(d=>sd(d,c))):l.assets.sprites.addLoaded(a,sd(b,c)):"string"==typeof b?l.assets.sprites.add(a,db.from(b,c)):l.assets.sprites.addLoaded(a,db.fromImage(b,c))}function td(a=1,b=1,c=0,d=0,e=1,g=1){let h=[];e/=a;g/=b;for(let m=0;m<b;m++)for(let k=0;k<a;k++)h.push(new la(c+k*e,d+m*g,e,g));return h}function sd(a,b={}){var c=document.createElement("canvas");
let d=a[0].width,e=a[0].height;c.width=d*a.length;c.height=e;let g=c.getContext("2d");if(!g)throw Error("Failed to create canvas context");a.forEach((h,m)=>{h instanceof ImageData?g.putImageData(h,m*d,0):g.drawImage(h,m*d,0)});c=g.getImageData(0,0,a.length*d,e);return db.fromImage(c,{...b,sliceX:a.length,sliceY:1})}function If(a="bean"){return Ab(a,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAA1CAYAAADyMeOEAAAAAXNSR0IArs4c6QAAAoVJREFUaIHdm7txwkAQhheGAqACiCHzOKQDQrqgILpwSAeEDBnEUAF0gCMxZ7G72qce/mec2Lpf9+3unaS78wgSNZ8uX5729+d1FNWXUuGmXlBOUUEIMckEpeQJgBu6C+BSFngztBR2vd+ovY+7g+p6LbgaWgJrAeUkDYIUXgXdBBwNi6kpABJwMTQH3AZsXRR8GHTfgEth8E3gjdAUcNewpbTgY85sCMCUuOokozE0YM0YRzM9NGAAXd8+omAF5h4lnmBRvpSnZHyLoLEbaN+aKB9KWv/KWw0tAbbANnlG+UvB2dm77NxxdwgBpjrF/d7rW9cbmpvio2A5z8iAYpVU8pGZlo6/2+MSco2lHfd3rv9jAP038e1xef9o2mjvYb2OqpqKE81028/jeietlSEVO5FRWsxWsJit1G3aFpW8iWe5RwpiCZAk25QvV6nz6fIlynRGuTd5WqpJ4guAlDfVKBK87hXljflgv1ON6fV+4+5gVlA17SfeG0heKqQd4l4jI/wrmaA9N9R4ar+wpHJDZyrrfcH0nB66PqAzPi76pn+faSyJk/vzOorYhGurQrzj/P68jtBMawHaHBIR9xoD5O34dy0qQOSYHvqExq2TpT2nf76+w7y251OYF0CRaU+J920TwLUa6inx6OxE6g80lu2ux7Y2eJLF/rCXE6zEPdnenk9o+4ih9AEdnW2q81HXl5LuU6OTl2fXUhqganbXAGq3g6jJOWV/OnoesO6YqqEB/GdNsjf7uHtwj2DzmRNpp7iOZfm6D9oAxB6Yi1gC4oIYeo4MIPdopEQRB+cAko5J1tW386HpB2Kz1eop4Epdwls/kgZ1sh8gZsEjdcWkr//D8Qu3Z3l5Nl1NtAAAAABJRU5ErkJggg\x3d\x3d")}
function Jf(a,b,c){b=Ga(b);c=Ga(c);"string"==typeof b&&!c&&(c=ci(b)+".json");c="string"==typeof c?Rb(c):Promise.resolve(c);return l.assets.sprites.add(a,c.then(d=>{let e=d.meta.size,g=d.frames.map(m=>new la(m.frame.x/e.w,m.frame.y/e.h,m.frame.w/e.w,m.frame.h/e.h)),h={};for(let m of d.meta.frameTags)m.from===m.to?h[m.name]=m.from:h[m.name]={from:m.from,to:m.to,speed:10,loop:!0,pingpong:"pingpong"===m.direction};return db.from(b,{frames:g,anims:h})}))}function ud(a){if(!a)return ud(l.globalOpt.font??
"monospace");if("string"==typeof a){let b=vd(a),c=wd(a);if(b)return b.data??b;if(c)return c.data??c;if(document.fonts.check(`${64}px ${a}`))return a;if(1>cb())return null;throw Error(`Font not found: ${a}`);}return a instanceof La?a.data?a.data:a:a}function wd(a){return l.assets.fonts.get(a)??null}function Kf(a,b,c={}){let d=Ga(b);b=new FontFace(a,"string"==typeof b?`url(${d})`:d);return document.fonts.add(b),l.assets.fonts.add(a,b.load().catch(e=>{throw Error(`Failed to load font from "${d}": ${e}`);
}).then(e=>new Ub(e,c)))}function Lf(a,b,c,d){let e=a.width/b,g={};d=d.split("").entries();for(let [h,m]of d)g[m]=new la(h%e*b,Math.floor(h/e)*c,b,c);return{tex:a,map:g,size:c}}function vd(a){return l.assets.bitmapFonts.get(a)??null}function Mf(a,b,c,d,e={}){b=Ga(b);return l.assets.bitmapFonts.add(a,Sb(b).then(g=>Lf(eb.fromImage(l.gfx.ggl,g,e),c,d,e.chars??" !\"#$%\x26'()*+,-./0123456789:;\x3c\x3d\x3e?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~")))}function Nf(a,b){return b=Ga(b),
l.assets.sprites.add(a,new Promise(async c=>{let d="string"==typeof b?await Rb(b):b;var e=await Promise.all(d.frames.map(Sb));let g=document.createElement("canvas");g.width=d.width;g.height=d.height*d.frames.length;let h=g.getContext("2d");if(!h)throw Error("Failed to create canvas context");e.forEach((m,k)=>{h.drawImage(m,0,k*d.height)});e=await Ab(null,g,{sliceY:d.frames.length,anims:d.anims});c(e)}))}function xc(a,b="\nvec4 vert(vec2 pos, vec2 uv, vec4 color) {\n\treturn def_vert();\n}\n",c="\nvec4 frag(vec2 pos, vec2 uv, vec4 color, sampler2D tex) {\n\treturn def_frag();\n}\n"){b=
"\nattribute vec2 a_pos;\nattribute vec2 a_uv;\nattribute vec4 a_color;\n\nvarying vec2 v_pos;\nvarying vec2 v_uv;\nvarying vec4 v_color;\n\nvec4 def_vert() {\n\treturn vec4(a_pos, 0.0, 1.0);\n}\n\n{{user}}\n\nvoid main() {\n\tvec4 pos \x3d vert(a_pos, a_uv, a_color);\n\tv_pos \x3d a_pos;\n\tv_uv \x3d a_uv;\n\tv_color \x3d a_color;\n\tgl_Position \x3d pos;\n}\n".replace("{{user}}",b??"\nvec4 vert(vec2 pos, vec2 uv, vec4 color) {\n\treturn def_vert();\n}\n");c="\nprecision mediump float;\n\nvarying vec2 v_pos;\nvarying vec2 v_uv;\nvarying vec4 v_color;\n\nuniform sampler2D u_tex;\n\nvec4 def_frag() {\n\tvec4 texColor \x3d texture2D(u_tex, v_uv);\n\treturn vec4((v_color.rgb * texColor.rgb), texColor.a) * v_color.a;\n}\n\n{{user}}\n\nvoid main() {\n\tgl_FragColor \x3d frag(v_pos, v_uv, v_color, u_tex);\n\tif (gl_FragColor.a \x3d\x3d 0.0) {\n\t\tdiscard;\n\t}\n}\n".replace("{{user}}",
c??"\nvec4 frag(vec2 pos, vec2 uv, vec4 color, sampler2D tex) {\n\treturn def_frag();\n}\n");try{return new Of(a,b,c,xd.map(d=>d.name))}catch(d){b=di(d).match(/(?<type>^\w+) SHADER ERROR: 0:(?<line>\d+): (?<msg>.+)/);if(!b?.groups)throw d;a=Number(b.groups.line)-14;c=b.groups.msg.trim();b=b.groups.type.toLowerCase();throw Error(`${b} shader line ${a}: ${c}`);}}function Pf(a){if(!a)return l.gfx.defShader;if("string"==typeof a){let b=yd(a);if(b)return b.data??b;if(1>cb())return null;throw Error(`Shader not found: ${a}`);
}return a instanceof La?a.data?a.data:a:a}function yd(a){return l.assets.shaders.get(a)??null}function Qf(a,b,c){return l.assets.shaders.addLoaded(a,xc(l.gfx.ggl,b,c))}function Rf(a,b,c){b=Ga(b);c=Ga(c);let d=f(e=>e?Df(e):Promise.resolve(null),"resolveUrl");b=Promise.all([d(b),d(c)]).then(([e,g])=>xc(l.gfx.ggl,e,g));return l.assets.shaders.add(a,b)}function Sf(a){if("string"==typeof a){let b=zd(a);if(b)return b;if(1>cb())return null;throw Error(`Sound not found: ${a}`);}if(a instanceof Vb)return La.loaded(a);
if(a instanceof La)return a;throw Error(`Invalid sound: ${a}`);}function zd(a){return l.assets.sounds.get(a)??null}function Tf(a,b){return b=Ga(b),l.assets.sounds.add(a,"string"==typeof b?Vb.fromURL(b):Vb.fromArrayBuffer(b))}function Uf(a,b){b=Ga(b);return(new Audio(b)).preload="auto",l.assets.music[a]=b}function Ad(a,b){return a=Ga(a),"string"==typeof b?wc(new Promise((c,d)=>{Rb(b).then(e=>{Ad(a,e).then(c).catch(d)})})):wc(db.from(a).then(c=>{let d={};for(let g in b){let h=b[g],m=c.frames[0],k=2048*
m.w,p=2048*m.h;var e=h.frames?h.frames.map(r=>new la(m.x+(h.x+r.x)/k*m.w,m.y+(h.y+r.y)/p*m.h,r.w/k*m.w,r.h/p*m.h)):td(h.sliceX||1,h.sliceY||1,m.x+h.x/k*m.w,m.y+h.y/p*m.h,h.width/k*m.w,h.height/p*m.h);e=new db(c.tex,e,h.anims);l.assets.sprites.addLoaded(g,e);d[g]=e}return d}))}function Xa(a,b,c=!1,d,e,g={}){d=d??l.gfx.defTex;if((e=Pf(e??l.gfx.defShader))&&!(e instanceof La)){c=l.gfx.fixed||c?l.gfx.transform:l.game.cam.transform.mult(l.gfx.transform);var h=[];for(let m of a)a=wf(c.multVec2(m.pos)),
h.push(a.x,a.y,m.uv.x,m.uv.y,m.color.r/255,m.color.g/255,m.color.b/255,m.opacity);l.gfx.renderer.push(l.gfx.ggl.gl.TRIANGLES,h,b,e,d,g)}}function Ya(a){if(!a.pts)throw Error('drawPolygon() requires property "pts".');let b=a.pts.length;if(!(3>b)){if(Ea(),ma(a.pos),zb(a.scale),mb(a.angle),ma(a.offset),!1!==a.fill){let c=a.color??Y.WHITE,d=a.pts.map((g,h)=>({pos:new C(g.x,g.y),uv:a.uv?a.uv[h]:new C(0,0),color:a.colors&&a.colors[h]?a.colors[h].mult(c):c,opacity:a.opacity??1})),e;a.triangulate?e=jd(a.pts).map(g=>
g.map(h=>a.pts.indexOf(h))).flat():e=[...Array(b-2).keys()].map(g=>[0,g+1,g+2]).flat();Xa(d,a.indices??e,a.fixed,a.uv?a.tex:l.gfx.defTex,a.shader,a.uniform??void 0)}a.outline&&yc({pts:[...a.pts,a.pts[0]],radius:a.radius,width:a.outline.width,color:a.outline.color,join:a.outline.join,uniform:a.uniform,fixed:a.fixed,opacity:a.opacity??a.outline.opacity});ya()}}function Bd(a){if(void 0===a.radiusX||void 0===a.radiusY)throw Error('drawEllipse() requires properties "radiusX" and "radiusY".');if(0!==a.radiusX&&
0!==a.radiusY){var b=a.start??0,c=a.end??360,d=lb(a.anchor??"center").scale(new C(-a.radiusX,-a.radiusY)),e=yb(d,a.radiusX,a.radiusY,b,c,a.resolution);e.unshift(d);d=Object.assign({},a,{pts:e,radius:0,...(a.gradient?{colors:[a.gradient[0],...Array(e.length-1).fill(a.gradient[1])]}:{})});360<=c-b&&a.outline?(!1!==a.fill&&Ya(Object.assign({},d,{outline:null})),Ya(Object.assign({},d,{pts:e.slice(1),fill:!1}))):Ya(d)}}function nb(a){if("number"!=typeof a.radius)throw Error('drawCircle() requires property "radius".');
0!==a.radius&&Bd(Object.assign({},a,{radiusX:a.radius,radiusY:a.radius,angle:0}))}function Bb(a){let {p1:b,p2:c}=a;if(!b||!c)throw Error('drawLine() requires properties "p1" and "p2".');var d=a.width||1;d=c.sub(b).unit().normal().scale(.5*d);d=[b.sub(d),b.add(d),c.add(d),c.sub(d)].map(e=>({pos:new C(e.x,e.y),uv:new C(0),color:a.color??Y.WHITE,opacity:a.opacity??1}));Xa(d,[0,1,3,1,2,3],a.fixed,l.gfx.defTex,a.shader,a.uniform??void 0)}function Vf(a){var b=a.pts;let c=[];var d=.5*(a.width||1);let e=
b[0]===b[b.length-1]||b[0].eq(b[b.length-1]),g=a.pos||y(0,0);var h;e?h=b[0].sub(b[b.length-2]):h=b[1].sub(b[0]);var m=h.len(),k=h.normal().scale(-d/m),p=b[0];if(!e)switch(a.cap){case "square":var r=h.scale(-d/m);c.push(p.add(r).add(k));c.push(p.add(r).sub(k));break;case "round":r=Math.max(d,10);var B=Math.PI/r,n=k.scale(-1),v=Math.cos(B);B=Math.sin(B);for(var u=0;u<r;u++)c.push(p),c.push(p.sub(n)),n=y(n.x*v-n.y*B,n.x*B+n.y*v)}for(n=1;n<b.length;n++){if(p===b[n]||p.eq(b[n]))continue;r=p;p=b[n];v=p.sub(r);
B=v.len();u=v.normal().scale(-d/B);let z=h.cross(v);.05>Math.abs(z)/(m*B)?(c.push(r.add(k)),c.push(r.sub(k)),0>h.dot(v)&&(c.push(r.sub(k)),c.push(r.add(k))),h=v,m=B,k=u):(m=u.sub(k).cross(v)/z,h=k.add(h.scale(m)),0<z?(c.push(r.add(h)),c.push(r.sub(k)),c.push(r.add(h)),c.push(r.sub(u))):(c.push(r.add(k)),c.push(r.sub(h)),c.push(r.add(u)),c.push(r.sub(h))),h=v,m=B,k=u)}if(!e)switch(c.push(p.add(k)),c.push(p.sub(k)),a.cap){case "square":b=h.scale(d/m);c.push(p.add(b).add(k));c.push(p.add(b).sub(k));
break;case "round":for(b=Math.max(d,10),h=Math.PI/b,k=k.scale(1),d=Math.cos(h),h=Math.sin(h),m=0;m<b;m++)k=y(k.x*d-k.y*h,k.x*h+k.y*d),c.push(p),c.push(p.sub(k))}if(!(4>c.length)){p=c.map(z=>({pos:g.add(z),uv:y(),color:a.color||Y.WHITE,opacity:a.opacity??1}));k=[];b=0;for(d=0;d<c.length-2;d+=2)k[b++]=d+1,k[b++]=d,k[b++]=d+2,k[b++]=d+2,k[b++]=d+3,k[b++]=d+1;e&&(k[b++]=c.length-1,k[b++]=c.length-2,k[b++]=0,k[b++]=0,k[b++]=1,k[b++]=c.length-1);Xa(p,k,a.fixed,l.gfx.defTex,a.shader,a.uniform??void 0)}}
function Wf(a){var b=a.pts;let c=[];var d=.5*(a.width||1);let e=b[0]===b[b.length-1]||b[0].eq(b[b.length-1]),g=a.pos||y(0,0);var h;e?h=b[0].sub(b[b.length-2]):h=b[1].sub(b[0]);var m=h.len(),k=h.normal().scale(-d/m),p=b[0];if(!e)switch(a.cap){case "square":var r=h.scale(-d/m);c.push(p.add(r).add(k));c.push(p.add(r).sub(k));break;case "round":r=Math.max(d,10);var B=Math.PI/r,n=k.scale(-1),v=Math.cos(B);B=Math.sin(B);for(var u=0;u<r;u++)c.push(p),c.push(p.sub(n)),n=y(n.x*v-n.y*B,n.x*B+n.y*v)}for(n=1;n<
b.length;n++)if(p!==b[n]&&!p.eq(b[n])){r=p;p=b[n];v=p.sub(r);B=v.len();u=v.normal().scale(-d/B);var z=h.cross(v);if(.05>Math.abs(z)/(m*B))c.push(r.add(k)),c.push(r.sub(k)),0>h.dot(v)&&(c.push(r.sub(k)),c.push(r.add(k))),h=v,m=B,k=u;else{m=u.sub(k).cross(v)/z;h=k.add(h.scale(m));if(0<z){h=r.add(h);m=Math.max(d,10);var D=ca(k.angleBetween(u)/m);z=Math.cos(D);D=Math.sin(D);for(var I=0;I<m;I++)c.push(h),c.push(r.sub(k)),k=y(k.x*z-k.y*D,k.x*D+k.y*z)}else for(h=r.sub(h),m=Math.max(d,10),D=ca(k.angleBetween(u)/
m),z=Math.cos(D),D=Math.sin(D),I=0;I<m;I++)c.push(r.add(k)),c.push(h),k=y(k.x*z-k.y*D,k.x*D+k.y*z);h=v;m=B;k=u}}if(!e)switch(c.push(p.add(k)),c.push(p.sub(k)),a.cap){case "square":b=h.scale(d/m);c.push(p.add(b).add(k));c.push(p.add(b).sub(k));break;case "round":for(b=Math.max(d,10),r=Math.PI/b,d=k.scale(1),k=Math.cos(r),r=Math.sin(r),n=0;n<b;n++)d=y(d.x*k-d.y*r,d.x*r+d.y*k),c.push(p),c.push(p.sub(d))}if(!(4>c.length)){p=c.map(J=>({pos:g.add(J),uv:y(),color:a.color||Y.WHITE,opacity:a.opacity??1}));
b=[];d=0;for(k=0;k<c.length-2;k+=2)b[d++]=k+1,b[d++]=k,b[d++]=k+2,b[d++]=k+2,b[d++]=k+3,b[d++]=k+1;e&&(b[d++]=c.length-1,b[d++]=c.length-2,b[d++]=0,b[d++]=0,b[d++]=1,b[d++]=c.length-1);Xa(p,b,a.fixed,l.gfx.defTex,a.shader,a.uniform??void 0)}}function Xf(a){var b=a.pts;let c=[];var d=.5*(a.width||1);let e=b[0]===b[b.length-1]||b[0].eq(b[b.length-1]),g=a.pos||y(0,0);var h;e?h=b[0].sub(b[b.length-2]):h=b[1].sub(b[0]);var m=h.len(),k=h.normal().scale(-d/m),p=b[0];if(!e)switch(a.cap){case "square":var r=
h.scale(-d/m);c.push(p.add(r).add(k));c.push(p.add(r).sub(k));break;case "round":r=Math.max(d,10);var B=Math.PI/r,n=k.scale(-1),v=Math.cos(B);B=Math.sin(B);for(var u=0;u<r;u++)c.push(p),c.push(p.sub(n)),n=y(n.x*v-n.y*B,n.x*B+n.y*v)}for(n=1;n<b.length;n++){if(p===b[n]||p.eq(b[n]))continue;r=p;p=b[n];v=p.sub(r);B=v.len();u=v.normal().scale(-d/B);let z=h.cross(v);.05>Math.abs(z)/(m*B)?(c.push(r.add(k)),c.push(r.sub(k)),0>h.dot(v)&&(c.push(r.sub(k)),c.push(r.add(k))),h=v,m=B,k=u):(m=u.sub(k).cross(v)/
z,k=k.add(h.scale(m)),c.push(r.add(k)),c.push(r.sub(k)),h=v,m=B,k=u)}if(!e)switch(c.push(p.add(k)),c.push(p.sub(k)),a.cap){case "square":b=h.scale(d/m);c.push(p.add(b).add(k));c.push(p.add(b).sub(k));break;case "round":for(b=Math.max(d,10),h=Math.PI/b,k=k.scale(1),d=Math.cos(h),h=Math.sin(h),m=0;m<b;m++)k=y(k.x*d-k.y*h,k.x*h+k.y*d),c.push(p),c.push(p.sub(k))}if(!(4>c.length)){p=c.map(z=>({pos:g.add(z),uv:y(),color:a.color||Y.WHITE,opacity:a.opacity??1}));k=[];b=0;for(d=0;d<c.length-2;d+=2)k[b++]=
d+1,k[b++]=d,k[b++]=d+2,k[b++]=d+2,k[b++]=d+3,k[b++]=d+1;e&&(k[b++]=c.length-1,k[b++]=c.length-2,k[b++]=0,k[b++]=0,k[b++]=1,k[b++]=c.length-1);Xa(p,k,a.fixed,l.gfx.defTex,a.shader,a.uniform??void 0)}}function yc(a){let b=a.pts;var c=a.width??1;if(!b)throw Error('drawLines() requires property "pts".');if(!(2>b.length)){if(2<b.length)switch(a.join){case "bevel":return Vf(a);case "round":return Wf(a);case "miter":return Xf(a)}if(a.radius&&3<=b.length){Bb(Object.assign({},a,{p1:b[0],p2:b[1]}));for(c=
1;c<b.length-2;c++)Bb(Object.assign({},a,{p1:b[c],p2:b[c+1]}));Bb(Object.assign({},a,{p1:b[b.length-2],p2:b[b.length-1]}))}else for(let d=0;d<b.length-1;d++)Bb(Object.assign({},a,{p1:b[d],p2:b[d+1]})),"none"!==a.join&&nb(Object.assign({},a,{pos:b[d],radius:c/2}))}}function Cd(a,b){let c=b.segments??16,d=[];for(let e=0;e<=c;e++)d.push(a(e/c));yc({pts:d,width:b.width||1,pos:b.pos,color:b.color,opacity:b.opacity})}function Yf(a){Cd(b=>mc(a.pt1,a.pt2,a.pt3,a.pt4,b),a)}function fb(a){let b=[],c=f(g=>{b.push(g);
a(g)},"push"),d=f(()=>{b.pop();a(e()??null)},"pop"),e=f(()=>b[b.length-1],"cur");return[c,d,e]}function Zf(a,b={}){function c(x){g.push(x)}function d(){g.forEach(w=>w());let x=a.getExtension("WEBGL_lose_context");x&&x.loseContext()}function e(x){if(!qc(x,h)){h=x;var w=x.reduce((E,G)=>E+G.size,0);x.reduce((E,G,Q)=>(a.vertexAttribPointer(Q,G.size,a.FLOAT,!1,4*w,E),a.enableVertexAttribArray(Q),E+4*G.size),0)}}let g=[];f(c,"onDestroy");f(d,"destroy");let h=null;f(e,"setVertexFormat");let [m,k]=fb(x=>
a.bindTexture(a.TEXTURE_2D,x)),[p,r]=fb(x=>a.bindBuffer(a.ARRAY_BUFFER,x)),[B,n]=fb(x=>a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,x)),[v,u]=fb(x=>a.bindFramebuffer(a.FRAMEBUFFER,x)),[z,D]=fb(x=>a.bindRenderbuffer(a.RENDERBUFFER,x)),[I,J]=fb(x=>{if(x){var {x:w,y:E,w:G,h:Q}=x;a.viewport(w,E,G,Q)}}),[N,H]=fb(x=>a.useProgram(x));return I({x:0,y:0,w:a.drawingBufferWidth,h:a.drawingBufferHeight}),{gl:a,opts:b,onDestroy:c,destroy:d,pushTexture2D:m,popTexture2D:k,pushArrayBuffer:p,popArrayBuffer:r,pushElementArrayBuffer:B,
popElementArrayBuffer:n,pushFramebuffer:v,popFramebuffer:u,pushRenderbuffer:z,popRenderbuffer:D,pushViewport:I,popViewport:J,pushProgram:N,popProgram:H,setVertexFormat:e}}function Dd(a,b){b.override?Object.assign(a,b):(b.pos&&(a.pos=a.pos.add(b.pos)),b.scale&&(a.scale=a.scale.scale(y(b.scale))),b.angle&&(a.angle+=b.angle),b.color&&1===a.ch.length&&(a.color=a.color.mult(b.color)),null!=b.opacity&&(a.opacity*=b.opacity))}function zc(a){let b={},c="",d=[];a=String(a);let e=f(h=>{0<d.length&&(b[c.length]=
d.slice());c+=h},"emit");for(;""!==a;)if("\\"===a[0]){if(1===a.length)throw Error("Styled text error: \\ at end of string");e(a[1]);a=a.slice(2)}else if("["===a[0]){var g=/^\[(\/)?(\w+?)\]/.exec(a);if(!g){e(a[0]);a=a.slice(1);continue}let [h,m,k]=g;if(void 0!==m){if(g=d.pop(),g!==k)throw void 0!==g?Error(`Styled text error: mismatched tags. Expected [/${g}], got [/${k}]`):Error(`Styled text error: stray end tag [/${k}]`);}else d.push(k);a=a.slice(h.length)}else e(a[0]),a=a.slice(1);if(0<d.length)throw Error(`Styled text error: unclosed tags ${d}`);
return{charStyleMap:b,text:c}}function gb(a){if(void 0===a.text)throw Error('formatText() requires property "text".');var b=ud(a.font);if(!a.text||""===a.text||b instanceof La||!b)return{width:0,height:0,chars:[],opt:a,renderedText:""};let {charStyleMap:c,text:d}=zc(a.text+"");var e=hf(d);if(b instanceof Ub||"string"==typeof b){var g=b instanceof Ub?b.fontface.family:b;b=b instanceof Ub?{outline:b.outline,filter:b.filter}:{outline:null,filter:"linear"};var h=Ed[g]??{font:{tex:new eb(l.gfx.ggl,2048,
2048,{filter:b.filter}),map:{},size:64},cursor:new C(0),maxHeight:0,outline:b.outline};Ed[g]||(Ed[g]=h);b=h.font;for(var m of e)if(!h.font.map[m]){var k=l.fontCacheC2d;if(!k)throw Error("fontCacheC2d is not defined.");if(!l.fontCacheCanvas)throw Error("fontCacheCanvas is not defined.");k.clearRect(0,0,l.fontCacheCanvas.width,l.fontCacheCanvas.height);k.font=`${b.size}px ${g}`;k.textBaseline="top";k.textAlign="left";k.fillStyle="#ffffff";var p=k.measureText(m),r=Math.ceil(p.width);if(r){p=Math.ceil(Math.abs(p.actualBoundingBoxAscent))+
Math.ceil(Math.abs(p.actualBoundingBoxDescent));h.outline&&h.outline.width&&h.outline.color&&(k.lineJoin="round",k.lineWidth=2*h.outline.width,k.strokeStyle=h.outline.color.toHex(),k.strokeText(m,h.outline.width,h.outline.width),r+=2*h.outline.width,p+=3*h.outline.width);k.fillText(m,h.outline?.width??0,h.outline?.width??0);k=k.getImageData(0,0,r,p);if(2048<h.cursor.x+r&&(h.cursor.x=0,h.cursor.y+=h.maxHeight,h.maxHeight=0,2048<h.cursor.y))throw Error("Font atlas exceeds character limit");b.tex.update(k,
h.cursor.x,h.cursor.y);b.map[m]=new la(h.cursor.x,h.cursor.y,r,p);h.cursor.x+=r+1;h.maxHeight=Math.max(h.maxHeight,p)}}}k=a.size||b.size;g=y(a.scale??1).scale(k/b.size);p=a.lineSpacing??0;var B=a.letterSpacing??0;let n=0;h=m=0;r=[];let v=[],u=0,z=null,D=0;for(var I;u<e.length;){let J=e[u];if("\n"===J)h+=k+p,r.push({width:n-B,chars:v}),z=null,n=D=0,v=[],I=void 0;else{let N=b.map[J];if(N){let H=N.w*g.x;a.width&&n+H>a.width&&(h+=k+p,null!=z&&(u-=v.length-z,J=e[u],N=b.map[J],H=N.w*g.x,v=v.slice(0,z-1),
n=D),z=null,D=0,r.push({width:n-B,chars:v}),n=I??0,v=[]);v.push({tex:b.tex,width:N.w,height:N.h,quad:new la(N.x/b.tex.width,N.y/b.tex.height,N.w/b.tex.width,N.h/b.tex.height),ch:J,pos:new C(n,h),opacity:a.opacity??1,color:a.color??Y.WHITE,scale:y(g),angle:0});" "===J&&(z=v.length,D=n);a.indentAll&&void 0===I&&/\S/.test(J)&&(I=n);n+=H;m=Math.max(m,n);n+=B}}u++}r.push({width:n-B,chars:v});h+=k;a.width&&(m=a.width);e=[];for(I=0;I<r.length;I++){k=(m-r[I].width)*sf(a.align??"left");for(let J of r[I].chars){B=
b.map[J.ch];p=e.length+I;(J.pos=J.pos.add(k,0).add(B.w*g.x*.5,B.h*g.y*.5),a.transform)&&(B="function"==typeof a.transform?a.transform(p,J.ch):a.transform)&&Dd(J,B);if(c[p]){B=c[p];for(let N of B)B=a.styles?.[N],(B="function"==typeof B?B(p,J.ch):B)&&Dd(J,B)}e.push(J)}}return{width:m,height:h,chars:e,opt:a,renderedText:d}}function Cb(a){if(void 0===a.width||void 0===a.height)throw Error('drawUVQuad() requires property "width" and "height".');if(!(0>=a.width||0>=a.height)){var b=a.width,c=a.height,d=
lb(a.anchor||"topleft").scale((new C(b,c)).scale(-.5)),e=a.quad||new la(0,0,1,1),g=a.color||R(255,255,255),h=a.opacity??1,m=a.tex?.1/a.tex.width:0,k=a.tex?.1/a.tex.height:0,p=e.x+m,r=e.y+k;m=e.w-2*m;e=e.h-2*k;Ea();ma(a.pos);mb(a.angle);zb(a.scale);ma(d);Xa([{pos:new C(-b/2,c/2),uv:new C(a.flipX?p+m:p,a.flipY?r:r+e),color:g,opacity:h},{pos:new C(-b/2,-c/2),uv:new C(a.flipX?p+m:p,a.flipY?r+e:r),color:g,opacity:h},{pos:new C(b/2,-c/2),uv:new C(a.flipX?p:p+m,a.flipY?r+e:r),color:g,opacity:h},{pos:new C(b/
2,c/2),uv:new C(a.flipX?p:p+m,a.flipY?r:r+e),color:g,opacity:h}],[0,1,3,1,2,3],a.fixed,a.tex,a.shader,a.uniform??void 0);ya()}}function hb(a){Ea();ma(a.opt.pos);mb(a.opt.angle);ma(lb(a.opt.anchor??"topleft").add(1,1).scale(a.width,a.height).scale(-.5));a.chars.forEach(b=>{Cb({tex:b.tex,width:b.width,height:b.height,pos:b.pos,scale:b.scale,angle:b.angle,color:b.color,opacity:b.opacity,quad:b.quad,anchor:"center",uniform:a.opt.uniform,shader:a.opt.shader,fixed:a.opt.fixed})});ya()}function Ha(a){if(void 0===
a.width||void 0===a.height)throw Error('drawRect() requires property "width" and "height".');if(!(0>=a.width||0>=a.height)){var b=a.width,c=a.height,d=lb(a.anchor||"topleft").add(1,1).scale((new C(b,c)).scale(-.5)),e=[new C(0,0),new C(b,0),new C(b,c),new C(0,c)];if(a.radius){let g=Math.min(b,c)/2;e=Array.isArray(a.radius)?a.radius.map(h=>Math.min(g,h)):Array(4).fill(Math.min(g,a.radius));e=[new C(e[0],0),...(e[1]?yb(new C(b-e[1],e[1]),e[1],e[1],270,360):[y(b,0)]),...(e[2]?yb(new C(b-e[2],c-e[2]),
e[2],e[2],0,90):[y(b,c)]),...(e[3]?yb(new C(e[3],c-e[3]),e[3],e[3],90,180):[y(0,c)]),...(e[0]?yb(new C(e[0],e[0]),e[0],e[0],180,270):[])]}Ya(Object.assign({},a,{offset:d,pts:e,...(a.gradient?{colors:a.horizontal?[a.gradient[0],a.gradient[1],a.gradient[1],a.gradient[0]]:[a.gradient[0],a.gradient[0],a.gradient[1],a.gradient[1]]}:{})}))}}function Za(a){Fa();let b=l.gfx.width,c=l.gfx.height;l.gfx.width=l.gfx.viewport.width;l.gfx.height=l.gfx.viewport.height;a();Fa();l.gfx.width=b;l.gfx.height=c}function Fd(a,
b){Za(()=>{var c=y(8);Ea();ma(a);let d=gb({text:b,font:"monospace",size:16,pos:c,color:R(255,255,255),fixed:!0}),e=d.width+2*c.x;c=d.height+2*c.x;a.x+e>=sa()&&ma(y(-e,0));a.y+c>=ta()&&ma(y(0,-c));Ha({width:e,height:c,color:R(0,0,0),radius:4,opacity:.8,fixed:!0});hb(d);ya()})}function Gd(a){if(!a.p1||!a.p2||!a.p3)throw Error('drawTriangle() requires properties "p1", "p2" and "p3".');return Ya(Object.assign({},a,{pts:[a.p1,a.p2,a.p3]}))}function $f(){if(l.debug.inspect){var a=null;for(var b of l.game.root.get("*",
{recursive:!0}))if(b.c("area")&&b.isHovering()){a=b;break}if(l.game.root.drawInspect(),a){b=[];a=a.inspect();for(let c in a)a[c]?b.push(`${a[c]}`):b.push(`${c}`);Fd(Af(pd()),b.join("\n"))}Fd(y(8),`FPS: ${l.debug.fps()}`)}l.debug.paused&&Za(()=>{Ea();ma(sa(),0);ma(-8,8);Ha({width:32,height:32,anchor:"topright",color:R(0,0,0),opacity:.8,radius:4,fixed:!0});for(let c=1;2>=c;c++)Ha({width:4,height:19.2,anchor:"center",pos:y(-32/3*c,16),color:R(255,255,255),radius:2,fixed:!0});ya()});1!==l.debug.timeScale&&
Za(()=>{Ea();ma(sa(),ta());ma(-8,-8);let c=gb({text:l.debug.timeScale.toFixed(1),font:"monospace",size:16,color:R(255,255,255),pos:y(-8),anchor:"botright",fixed:!0});Ha({width:c.width+16+32,height:c.height+16,anchor:"botright",color:R(0,0,0),opacity:.8,radius:4,fixed:!0});for(let d=0;2>d;d++){let e=1>l.debug.timeScale;Gd({p1:y(-c.width-8*(e?2:3.5),-8),p2:y(-c.width-8*(e?2:3.5),-8-c.height),p3:y(-c.width-8*(e?3.5:2),-8-c.height/2),pos:y(8*-d+(e?-4:0),0),color:R(255,255,255),fixed:!0})}hb(c);ya()});
l.debug.curRecording&&Za(()=>{Ea();ma(0,ta());ma(24,-24);nb({radius:12,color:R(255,0,0),opacity:Vc(0,1,4*l.app.time()),fixed:!0});ya()});l.debug.showLog&&0<l.game.logs.length&&Za(()=>{Ea();ma(0,ta());ma(8,-8);var c=[];for(let d of l.game.logs){let e="",g=d.msg instanceof Error?"error":"info";e+=`[time]${d.time.toFixed(2)}[/time]`;e+=" ";e+=`[${g}]${Ac(d.msg)}[/${g}]`;c.push(e)}l.game.logs=l.game.logs.filter(d=>l.app.time()-d.time<(l.globalOpt.logTime||4));c=gb({text:c.join("\n"),font:"monospace",
pos:y(8,-8),anchor:"botleft",size:16,width:.6*sa(),lineSpacing:4,fixed:!0,styles:{time:{color:R(127,127,127)},info:{color:R(255,255,255)},error:{color:R(255,0,127)}}});Ha({width:c.width+16,height:c.height+16,anchor:"botleft",color:R(0,0,0),radius:4,opacity:.8,fixed:!0});hb(c);ya()})}function Ac(a,b=!1,c=new Set){if(c.has(a))return"\x3crecursive\x3e";var d="",e;return b&&"string"==typeof a&&(a=JSON.stringify(a)),Array.isArray(a)&&(d=["[",a.map(g=>Ac(g,!0,c.union(new Set([a])))).join(", "),"]"].join(""),
a=d),null===a?"null":("object"==typeof a&&a.toString===Object.prototype.toString&&(a.constructor!==Object&&(d+=a.constructor.name+" "),d+=["{",(e=Object.getOwnPropertyNames(a).map(g=>`${/^\w+$/.test(g)?g:JSON.stringify(g)}: ${Ac(a[g],!0,c.union(new Set([a])))}`).join(", "))?` ${e} `:"","}"].join(""),a=d),String(a).replaceAll(/(?<!\\)\[/g,"\\["))}function ag(){let a=l.game.cam,b=C.fromAngle(pa(0,360)).scale(a.shake);a.shake=wa(a.shake,0,5*qa());a.transform=(new Sa).translate(Qb()).scale(a.scale).rotate(a.angle).translate((a.pos??
Qb()).scale(-1).add(b));l.game.root.draw();Fa()}function bg(){let a=cb();0<l.game.events.numListeners("loading")?l.game.events.trigger("loading",a):Za(()=>{let b=sa()/2,c=y(sa()/2,ta()/2).sub(y(b/2,12));Ha({pos:y(0),width:sa(),height:ta(),color:R(0,0,0)});Ha({pos:c,width:b,height:24,fill:!1,outline:{width:4}});Ha({pos:c,width:b*a,height:24})})}function Hd(a,b,c){let d=l.gfx.ggl.gl;Fa();d.clear(d.STENCIL_BUFFER_BIT);d.enable(d.STENCIL_TEST);d.stencilFunc(d.NEVER,1,255);d.stencilOp(d.REPLACE,d.REPLACE,
d.REPLACE);b();Fa();d.stencilFunc(c,1,255);d.stencilOp(d.KEEP,d.KEEP,d.KEEP);a();Fa();d.disable(d.STENCIL_TEST)}function cg(a,b){Hd(a,b,l.gfx.ggl.gl.EQUAL)}function Wb(a){if(!a.tex)throw Error('drawTexture() requires property "tex".');let b=a.quad??new la(0,0,1,1),c=a.tex.width*b.w,d=a.tex.height*b.h;var e=new C(1);if(a.tiled){let p=lb(a.anchor||"topleft");var g=(a.width||c)/c,h=(a.height||d)/d;e=Math.floor(g);let r=Math.floor(h);g-=e;h-=r;var m=(e+g?1:0)*(r+h?1:0);let B=Array(6*m),n=Array(4*m),v=
0;m=f((u,z,D,I,J)=>{B[6*v]=4*v;B[6*v+1]=4*v+1;B[6*v+2]=4*v+3;B[6*v+3]=4*v+1;B[6*v+4]=4*v+2;B[6*v+5]=4*v+3;n[4*v]={pos:new C(u-p.x,z-p.y),uv:new C(J.x,J.y),color:a.color||Y.WHITE,opacity:a.opacity||1};n[4*v+1]={pos:new C(u+D-p.x,z-p.y),uv:new C(J.x+J.w,J.y),color:a.color||Y.WHITE,opacity:a.opacity||1};n[4*v+2]={pos:new C(u+D-p.x,z+I-p.y),uv:new C(J.x+J.w,J.y+J.h),color:a.color||Y.WHITE,opacity:a.opacity||1};n[4*v+3]={pos:new C(u-p.x,z+I-p.y),uv:new C(J.x,J.y+J.h),color:a.color||Y.WHITE,opacity:a.opacity||
1};v++},"addQuad");for(var k=0;k<r;k++){for(let u=0;u<e;u++)m(u*c,k*d,c,d,b);g&&m(e*c,k*d,c*g,d,new la(b.x,b.y,b.w*g,b.h))}if(h){for(k=0;k<e;k++)m(k*c,r*d,c,d*h,new la(b.x,b.y,b.w,b.h*h));g&&m(e*c,r*d,c*g,d*h,new la(b.x,b.y,b.w*g,b.h*h))}Xa(n,B,a.fixed,a.tex,a.shader,a.uniform??void 0)}else a.width&&a.height?(e.x=a.width/c,e.y=a.height/d):a.width?(e.x=a.width/c,e.y=e.x):a.height&&(e.y=a.height/d,e.x=e.y),Cb(Object.assign({},a,{scale:e.scale(a.scale||new C(1)),tex:a.tex,quad:b,width:c,height:d}))}
function dg(a){if(!a.sprite)throw Error('drawSprite() requires property "sprite"');let b=Tb(a.sprite);if(b&&b.data){var c=b.data.frames[a.frame??0];if(!c)throw Error(`Frame not found: ${a.frame??0}`);Wb(Object.assign({},a,{tex:b.data.tex,quad:c.scale(a.quad??new la(0,0,1,1))}))}}function eg(a,b){Hd(a,b,l.gfx.ggl.gl.NOTEQUAL)}function Id(a){hb(gb(a))}function Jd(){var a=l.pixelDensity;let b=l.gfx.ggl.gl.drawingBufferWidth/a;a=l.gfx.ggl.gl.drawingBufferHeight/a;if(l.globalOpt.letterbox){if(!l.globalOpt.width||
!l.globalOpt.height)throw Error("Letterboxing requires width and height defined.");var c=l.globalOpt.width/l.globalOpt.height;b/a>c?(c*=a,l.gfx.viewport={x:(b-c)/2,y:0,width:c,height:a}):(c=b/c,l.gfx.viewport={x:0,y:(a-c)/2,width:b,height:c})}else{if(l.globalOpt.stretch&&(!l.globalOpt.width||!l.globalOpt.height))throw Error("Stretching requires width and height defined.");l.gfx.viewport={x:0,y:0,width:b,height:a}}}function ib(a){return a.fixed?!0:a.parent?ib(a.parent):!1}function jb(a){return{color:a.color,
opacity:a.opacity,anchor:a.anchor,outline:a.outline,shader:a.shader,uniform:a.uniform}}function fg(a,b={}){return{id:"circle",radius:a,draw(){nb(Object.assign(jb(this),{radius:this.radius,fill:b.fill}))},renderArea(){return new ka(new C(this.anchor?0:-this.radius),2*this.radius,2*this.radius)},inspect(){return`radius: ${Math.ceil(this.radius)}`}}}function Kd(...a){return{id:"color",color:R(...a),inspect(){return`color: ${this.color.toString()}`}}}function gg(a){return{add(){this.canvas=a}}}function hg(a=
1){let b,c=0,d=!1;return{require:["opacity"],add(){b=this.opacity;this.opacity=0},update(){d||(c+=qa(),this.opacity=Oa(c,0,a,0,b),c>=a&&(this.opacity=b,d=!0))}}}function ig(a="intersect"){return{id:"mask",mask:a}}function Ld(a){return{id:"opacity",opacity:a??1,fadeIn(b=1,c=l.k.easings.linear){return l.game.root.tween(0,this.opacity,b,d=>this.opacity=d,c)},fadeOut(b=1,c=l.k.easings.linear){return l.game.root.tween(this.opacity,0,b,d=>this.opacity=d,c)},inspect(){return`opacity: ${rc(this.opacity,1)}`}}}
function jg(a=1,b=R(0,0,0),c=1,d="miter",e=10,g="butt"){return{id:"outline",outline:{width:a,color:b,opacity:c,join:d,miterLimit:e,cap:g},inspect(){return`outline: ${this.outline.width}px, ${this.outline.color}`}}}function kg(a,b){function c(w=0){for(;w<a.max;){if(e[w].gc)return w;w++}return null}let d=b.lifetime,e=[],g=a.colors||[Y.WHITE],h=a.opacities||[1],m=a.quads||[new la(0,0,1,1)],k=a.scales||[1],p=a.lifeTime,r=b.direction,B=b.spread,n=a.speed||[0,0],v=a.angle||[0,0],u=a.angularVelocity||[0,
0],z=a.acceleration||[y(0),y(0)],D=a.damping||[0,0],I=[],J=Array(a.max),N=0,H=0;for(let w=0;w<a.max;w++){I[6*w]=4*w;I[6*w+1]=4*w+1;I[6*w+2]=4*w+3;I[6*w+3]=4*w+1;I[6*w+4]=4*w+2;I[6*w+5]=4*w+3;for(let E=0;4>E;E++)J[4*w+E]={pos:new C(0,0),uv:new C(0,0),color:R(255,255,255),opacity:1};e[w]=new lg}let x=new ua;return f(c,"nextFree"),{id:"particles",emit(w){let E=0;for(let Q=0;Q<w;Q++){if(E=c(E),null==E)return;var G=pa(r-B,r+B);G=C.fromAngle(G).scale(pa(n[0],n[1]));let L=pa(v[0],v[1]),K=pa(u[0],u[1]),W=
y(pa(z[0].x,z[1].x),pa(z[0].y,z[1].y)),fa=pa(D[0],D[1]),ra=p?pa(p[0],p[1]):null,va=b.shape?b.shape.random():y(),oa=e[E];oa.lt=ra;oa.pos=va;oa.vel=G;oa.acc=W;oa.angle=L;oa.angularVelocity=K;oa.damping=fa;oa.angularVelocity=K;oa.gc=!1}N+=w},update(){if(!(void 0!==d&&0>=d)){var w=qa();for(let E of e)E.gc||((E.t+=w,E.lt&&E.t>=E.lt)?(E.gc=!0,N--):(E.vel=E.vel.add(E.acc.scale(w)).scale(1-E.damping*w),E.pos=E.pos.add(E.vel.scale(w)),E.angle+=E.angularVelocity*w));void 0!==d&&(d-=w,0>=d&&x.trigger());for(H+=
w;N<a.max&&b.rate&&H>b.rate;)this.emit(1),N++,H-=b.rate}},draw(){if(!(void 0!==d&&0>=d)){for(let Q=0;Q<e.length;Q++){let L=e[Q];if(L.gc)continue;var w=L.progress,E=Math.floor(L.progress*g.length);E=E<g.length-1?wa(g[E],g[E+1],Oa(w,E/g.length,(E+1)/g.length,0,1)):g[E];var G=Math.floor(L.progress*h.length);w=G<h.length-1?wa(h[G],h[G+1],Oa(w,G/h.length,(G+1)/h.length,0,1)):h[G];G=m[Math.floor(L.progress*m.length)];let K=k[Math.floor(L.progress*k.length)],W=Math.cos(L.angle*Math.PI/180),fa=Math.sin(L.angle*
Math.PI/180),ra=(a.texture?a.texture.width:10)*G.w/2,va=(a.texture?a.texture.height:10)*G.h/2,oa=4*Q,T=J[oa];T.pos.x=L.pos.x+-ra*K*W- -va*K*fa;T.pos.y=L.pos.y+-ra*K*fa+-va*K*W;T.uv.x=G.x;T.uv.y=G.y;T.color.r=E.r;T.color.g=E.g;T.color.b=E.b;T.opacity=w;T=J[oa+1];T.pos.x=L.pos.x+ra*K*W- -va*K*fa;T.pos.y=L.pos.y+ra*K*fa+-va*K*W;T.uv.x=G.x+G.w;T.uv.y=G.y;T.color.r=E.r;T.color.g=E.g;T.color.b=E.b;T.opacity=w;T=J[oa+2];T.pos.x=L.pos.x+ra*K*W-va*K*fa;T.pos.y=L.pos.y+ra*K*fa+va*K*W;T.uv.x=G.x+G.w;T.uv.y=
G.y+G.h;T.color.r=E.r;T.color.g=E.g;T.color.b=E.b;T.opacity=w;T=J[oa+3];T.pos.x=L.pos.x+-ra*K*W-va*K*fa;T.pos.y=L.pos.y+-ra*K*fa+va*K*W;T.uv.x=G.x;T.uv.y=G.y+G.h;T.color.r=E.r;T.color.g=E.g;T.color.b=E.b;T.opacity=w}Xa(J,I,this.fixed,a.texture,this.shader,this.uniform)}},onEnd(w){return x.add(w)},inspect(){return`count: ${N}/${a.max}`}}}function mg(a,b={}){if(3>a.length)throw Error(`Polygon's need more than two points, ${a.length} points provided`);return{id:"polygon",pts:a,colors:b.colors,uv:b.uv,
tex:b.tex,radius:b.radius,draw(){Ya(Object.assign(jb(this),{pts:this.pts,colors:this.colors,uv:this.uv,tex:this.tex,radius:this.radius,fill:b.fill,triangulate:b.triangulate}))},renderArea(){return new xa(this.pts)},inspect(){return`polygon: ${this.pts.map(c=>`[${c.x},${c.y}]`).join(",")}`}}}function Md(a,b,c){let d;return l.game.root.get("area").forEach(e=>{if(!c||!c.some(h=>e.is(h))){var g=e.worldArea().raycast(a,b);g&&(d?g.fraction<d.fraction&&(d=g,d.object=e):(d=g,d.object=e))}}),d}function Nd(a,
b,c={}){return{id:"rect",width:a,height:b,radius:c.radius||0,draw(){Ha(Object.assign(jb(this),{width:this.width,height:this.height,radius:this.radius,fill:c.fill}))},renderArea(){return new ka(y(0),this.width,this.height)},inspect(){return`rect: (${Math.ceil(this.width)}w, ${Math.ceil(this.height)}h)`}}}function ng(a,b){return{id:"shader",shader:a,...("function"==typeof b?{uniform:b(),update(){this.uniform=b()}}:{uniform:b}),inspect(){return`shader: ${a}`}}}function og(a,b){if(!b.tileWidth||!b.tileHeight)throw Error("Must provide tileWidth and tileHeight.");
let c=l.game.root.add([Xb(b.pos??y(0))]),d=a.length,e=0,g=null,h=null,m=null,k=null,p=f(x=>x.x+x.y*e,"tile2Hash"),r=f(x=>y(Math.floor(x%e),Math.floor(x/e)),"hash2Tile"),B=f(()=>{g=[];for(let x of c.children)n(x)},"createSpatialMap"),n=f(x=>{let w=p(x.tilePos);g[w]?g[w].push(x):g[w]=[x]},"insertIntoSpatialMap"),v=f(x=>{let w=p(x.tilePos);g[w]&&(x=g[w].indexOf(x),0<=x&&g[w].splice(x,1))},"removeFromSpatialMap"),u=f(()=>{let x=!1;for(let w of c.children){let E=c.pos2Tile(w.pos);w.tilePos.x==E.x&&w.tilePos.y==
E.y||(x=!0,v(w),w.tilePos.x=E.x,w.tilePos.y=E.y,n(w))}x&&c.trigger("spatialMapChanged")},"updateSpatialMap"),z=f(()=>{let x=c.getSpatialMap();var w=c.numRows()*c.numColumns();h?h.length=w:h=Array(w);h.fill(1,0,w);for(w=0;w<x.length;w++){let E=x[w];if(E){let G=0;for(let Q of E)if(Q.isObstacle){G=1/0;break}else G+=Q.cost;h[w]=G||1}}},"createCostMap"),D=f(()=>{let x=c.getSpatialMap();var w=c.numRows()*c.numColumns();m?m.length=w:m=Array(w);m.fill(15,0,w);for(w=0;w<x.length;w++){let E=x[w];if(E){let G=
E.length,Q=15;for(let L=0;L<G;L++)Q|=E[L].edgeMask;m[w]=Q}}},"createEdgeMap"),I=f(()=>{var x=c.numRows()*c.numColumns();let w=f((E,G)=>{let Q=[];for(Q.push(E);0<Q.length;)E=Q.pop(),H(E).forEach(L=>{0>k[L]&&(k[L]=G,Q.push(L))})},"traverse");k?k.length=x:k=Array(x);k.fill(-1,0,x);x=0;for(let E=0;E<h.length;E++)0<=k[E]||w(E,x),x++},"createConnectivityMap"),J=f((x,w)=>h[w],"getCost"),N=f((x,w)=>{x=r(x);w=r(w);return x.dist(w)},"getHeuristic"),H=f((x,w)=>{let E=[];var G=Math.floor(x%e);let Q=0<G&&m[x]&
1&&h[x-1]!==1/0,L=x>=e&&m[x]&2&&h[x-e]!==1/0;G=G<e-1&&m[x]&4&&h[x+1]!==1/0;let K=x<e*d-e-1&&m[x]&8&&h[x+e]!==1/0;return w?(Q&&(L&&E.push(x-e-1),E.push(x-1),K&&E.push(x+e-1)),L&&E.push(x-e),G&&(L&&E.push(x-e+1),E.push(x+1),K&&E.push(x+e+1)),K&&E.push(x+e)):(Q&&E.push(x-1),L&&E.push(x-e),G&&E.push(x+1),K&&E.push(x+e)),E},"getNeighbours");return c.use({id:"level",tileWidth(){return b.tileWidth},tileHeight(){return b.tileHeight},spawn(x,...w){let E=y(...w),G=(()=>{if("string"==typeof x){if(b.tiles[x]){if("function"!=
typeof b.tiles[x])throw Error("Level symbol def must be a function returning a component list");return b.tiles[x](E)}if(b.wildcardTile)return b.wildcardTile(x,E)}else{if(Array.isArray(x))return x;throw Error("Expected a symbol or a component list");}})();if(!G)return null;let Q=w=!1;for(var L of G)"tile"===L.id&&(Q=!0),"pos"===L.id&&(w=!0);w||G.push(Xb(this.tile2Pos(E)));Q||G.push(Od());L=c.add(G);return w&&(L.tilePosOffset=L.pos.clone()),L.tilePos=E,L.transform=xb(L),g&&(n(L),this.trigger("spatialMapChanged"),
this.trigger("navigationMapInvalid")),L},numColumns(){return e},numRows(){return d},levelWidth(){return e*this.tileWidth()},levelHeight(){return d*this.tileHeight()},tile2Pos(...x){return y(...x).scale(this.tileWidth(),this.tileHeight())},pos2Tile(...x){x=y(...x);return y(Math.floor(x.x/this.tileWidth()),Math.floor(x.y/this.tileHeight()))},getSpatialMap(){return g||B(),g},removeFromSpatialMap:v,insertIntoSpatialMap:n,onSpatialMapChanged(x){return this.on("spatialMapChanged",x)},onNavigationMapInvalid(x){return this.on("navigationMapInvalid",
x)},getAt(x){g||B();x=p(x);return g[x]||[]},raycast(x,w){let E=this.toWorld(x),G=this.toWorld(x.add(w)).sub(E),Q=1/this.tileWidth();x=x.scale(Q);w=Fe(x,w,L=>{var K=this.getAt(L);if(K.some(W=>W.isObstacle))return!0;L=null;for(let W of K)W.has("area")&&(K=W.worldArea().raycast(E,G))&&(L?K.fraction<L.fraction&&(L=K,L.object=W):(L=K,L.object=W));return L&&(L.point=this.fromWorld(L.point).scale(Q)),L||!1},64);return w&&(w.point=w.point.scale(this.tileWidth())),w},update(){g&&u()},invalidateNavigationMap(){k=
m=h=null},onNavigationMapChanged(x){return this.on("navigationMapChanged",x)},getTilePath(x,w,E={}){if(h||z(),m||D(),k||I(),0>x.x||x.x>=e||0>x.y||x.y>=d||0>w.x||w.x>=e||0>w.y||w.y>=d)return null;x=p(x);var G=p(w);if(h[G]===1/0)return null;if(x===G)return[];if(-1!=k[x]&&k[x]!==k[G])return null;let Q=new nd((fa,ra)=>fa.cost<ra.cost);Q.insert({cost:0,node:x});w=new Map;w.set(x,x);let L=new Map;for(L.set(x,0);0!==Q.length;){let fa=Q.remove()?.node;if(fa===G)break;var K=H(fa,E.allowDiagonals);for(var W of K)K=
(L.get(fa)||0)+J(fa,W)+N(W,G),(!L.has(W)||K<L.get(W))&&(L.set(W,K),Q.insert({cost:K,node:W}),w.set(W,fa))}E=[];W=G;G=r(W);for(E.push(G);W!==x;){W=w.get(W);if(void 0===W)throw Error("Bug in pathfinding algorithm");G=r(W);E.push(G)}return E.reverse()},getPath(x,w,E={}){let G=this.tileWidth(),Q=this.tileHeight();return(E=this.getTilePath(this.pos2Tile(x),this.pos2Tile(w),E))?[x,...E.slice(1,-1).map(L=>L.scale(G,Q).add(G/2,Q/2)),w]:null}}),c.onNavigationMapInvalid(()=>{c.invalidateNavigationMap();c.trigger("navigationMapChanged")}),
a.forEach((x,w)=>{x=x.split("");e=Math.max(x.length,e);x.forEach((E,G)=>{c.spawn(E,y(G,w))})}),c}function za(a,b,c){return l.game.objEvents.registers[a]||(l.game.objEvents.registers[a]=new Pd),l.game.objEvents.on(a,(d,...e)=>{d.is(b)&&c(d,...e)})}function pg(a,b,c){return za("collide",a,(d,e,g)=>e.is(b)&&c(d,e,g))}function qg(a,b,c){return za("collideUpdate",a,(d,e,g)=>e.is(b)&&c(d,e,g))}function rg(a,b,c){return za("collideEnd",a,(d,e,g)=>e.is(b)&&c(d,e,g))}function Yb(a,b){l.game.root.get(a,{recursive:!0}).forEach(b);
sg(a,b);tg((c,d)=>{d===a&&b(c)})}function ug(a,b){let c=[];return Yb(a,d=>{if(!d.area)throw Error("onHover() requires the object to have area() component");c.push(d.onHover(()=>b(d)))}),ob.join(c)}function vg(a,b){let c=[];return Yb(a,d=>{if(!d.area)throw Error("onHoverUpdate() requires the object to have area() component");c.push(d.onHoverUpdate(()=>b(d)))}),ob.join(c)}function wg(a,b){let c=[];return Yb(a,d=>{if(!d.area)throw Error("onHoverEnd() requires the object to have area() component");c.push(d.onHoverEnd(()=>
b(d)))}),ob.join(c)}function xg(a){l.game.events.on("loading",a)}function yg(a){l.app.onResize(a)}function zg(a){l.game.events.on("error",a)}function Bc(a){l.assets.loaded?a():l.game.events.on("load",a)}function Ag(a){if(l.assets.loaded)qd().forEach(b=>a(...b));else return l.game.events.on("loadError",a)}function Qd(...a){l.game.cam.pos=y(...a)}function Rd(){return l.game.cam.pos?l.game.cam.pos.clone():Qb()}function Sd(...a){l.game.cam.scale=y(...a)}function Td(){return l.game.cam.scale.clone()}function Ud(a){l.game.cam.angle=
a}function Vd(){return l.game.cam.angle}function Bg(){return l.game.cam.transform.clone()}function Wd(a=R(255,255,255),b=1){let c=l.game.root.add([Nd(sa(),ta()),Kd(a),Ld(1),Xd()]);a=c.fadeOut(b);return a.onEnd(()=>Yd(c)),a}function Cg(){return l.game.cam.transform.clone()}function Dg(a=12){l.game.cam.shake+=a}function Cc(a){return l.game.cam.transform.multVec2(a)}function Zd(a){return l.game.cam.transform.invert().multVec2(a)}function Eg(...a){return kb("camPos","setCamPos / getCamPos"),0<a.length&&
Qd(...a),Rd()}function Fg(...a){return kb("camScale","setCamScale / getCamScale"),0<a.length&&Sd(...a),Td()}function Gg(a){return kb("camRot","setCamRot / getCamRot"),void 0!==a&&Ud(a),Vd()}function Hg(a=R(255,255,255),b=1){return kb("camFlash","flash"),Wd(a,b)}function Dc(a=[]){let b=new Map,c=[],d={},e=new Db,g=[],h=new Set("*"),m=l.globalOpt.tagsAsComponents,k=null,p=!1,r={id:ei(),hidden:!1,transform:new Sa,children:[],parent:null,set paused(n){if(n!==p){p=n;for(let v of g)v.paused=n}},get paused(){return p},
get tags(){return Array.from(h)},add(n){n=Array.isArray(n)?Dc(n):n;if(n.parent)throw Error("Cannot add a game obj that already has a parent.");return n.parent=this,n.transform=xb(n),this.children.push(n),n.trigger("add",n),l.game.events.trigger("add",n),n},readd(n){let v=this.children.indexOf(n);return-1!==v&&(this.children.splice(v,1),this.children.push(n)),n},remove(n){let v=this.children.indexOf(n);if(-1!==v){n.parent=null;this.children.splice(v,1);let u=f(z=>{z.trigger("destroy");l.game.events.trigger("destroy",
z);z.children.forEach(D=>u(D))},"trigger");u(n)}},removeAll(n){if(n)this.get(n).forEach(v=>this.remove(v));else for(let v of[...this.children])this.remove(v)},fixedUpdate(){this.paused||(this.children.forEach(n=>n.fixedUpdate()),this.trigger("fixedUpdate"))},update(){this.paused||(this.children.forEach(n=>n.update()),this.trigger("update"))},draw(){if(!this.hidden){this.canvas&&(Fa(),this.canvas.bind());var n=l.gfx.fixed;this.fixed&&(l.gfx.fixed=!0);Ea();ma(this.pos);zb(this.scale);mb(this.angle);
var v=this.children.sort((u,z)=>(u.layerIndex??l.game.defaultLayerIndex)-(z.layerIndex??l.game.defaultLayerIndex)||(u.z??0)-(z.z??0));if(this.mask){let u={intersect:l.k.drawMasked,subtract:l.k.drawSubtracted}[this.mask];if(!u)throw Error(`Invalid mask func: "${this.mask}"`);u(()=>{v.forEach(z=>z.draw())},()=>{this.trigger("draw")})}else this.trigger("draw"),v.forEach(u=>u.draw());ya();l.gfx.fixed=n;this.canvas&&(Fa(),this.canvas.unbind())}},drawInspect(){this.hidden||(Ea(),ma(this.pos),zb(this.scale),
mb(this.angle),this.children.forEach(n=>n.drawInspect()),this.trigger("drawInspect"),ya())},use(n){if("string"==typeof n)return h.add(n);if(!n||"object"!=typeof n)throw Error(`You can only pass a component or a string to .use(), you passed a "${typeof n}"`);let v=[];n.id?(this.unuse(n.id),d[n.id]=[],v=d[n.id],b.set(n.id,n),m&&h.add(n.id)):c.push(n);for(let z in n)if(!fi.has(z)){var u=Object.getOwnPropertyDescriptor(n,z);if(u)if("function"==typeof u.value&&(n[z]=n[z].bind(this)),u.set&&Object.defineProperty(n,
z,{set:u.set.bind(this)}),u.get&&Object.defineProperty(n,z,{get:u.get.bind(this)}),gi.has(z))v.push(this.on(z,"add"===z?()=>{k=f(D=>v.push(D),"onCurCompCleanup");n[z]?.();k=null}:n[z]).cancel);else if(void 0===this[z])Object.defineProperty(this,z,{get:f(()=>n[z],"get"),set:f(D=>n[z]=D,"set"),configurable:!0,enumerable:!0}),v.push(()=>delete this[z]);else throw u=b.values().find(D=>void 0!==D[z])?.id,Error(`Duplicate component property: "${z}" while adding component "${n.id}"`+(u?` (originally added by "${u}")`:
""));}u=f(()=>{if(n.require)for(let z of n.require)if(!this.c(z))throw Error(`Component "${n.id}" requires component "${z}"`);},"checkDeps");n.destroy&&v.push(n.destroy.bind(this));this.exists()?(u(),n.add&&(k=f(z=>v.push(z),"onCurCompCleanup"),n.add.call(this),k=null),n.id&&(this.trigger("use",n.id),l.game.events.trigger("use",this,n.id))):n.require&&v.push(this.on("add",u).cancel)},unuse(n){if(b.has(n)){for(let v of b.values())if(v.require&&v.require.includes(n))throw Error(`Can't unuse. Component "${v.id}" requires component "${n}"`);
b.delete(n);this.trigger("unuse",n);l.game.events.trigger("unuse",this,n)}else m&&h.has(n)&&h.delete(n);d[n]&&(d[n].forEach(v=>v()),delete d[n])},c(n){return b.get(n)??null},get(n,v={}){let u=f((D,I)=>"comps"===v.only?D.has(I):"tags"===v.only?D.is(I):D.is(I)||D.has(I),"checkTagsOrComps"),z=v.recursive?this.children.flatMap(f(function J(I){return[I,...I.children.flatMap(J)]},"recurse")):this.children;if(z=z.filter(I=>n?u(I,n):!0),v.liveUpdate){let I=f(N=>v.recursive?this.isAncestorOf(N):N.parent===
this,"isChild"),J=[];J.push(l.k.onAdd(N=>{I(N)&&u(N,n)&&z.push(N)}));J.push(l.k.onDestroy(N=>{if(I(N)&&u(N,n)){let H=z.findIndex(x=>x.id===N.id);-1!==H&&z.splice(H,1)}}));this.onDestroy(()=>{for(let N of J)N.cancel()})}return z},query(n){let v=n.include,u=n.exclude,z=[];switch(n.hierarchy||"children"){case "children":z=this.children;break;case "siblings":z=this.parent?this.parent.children.filter(I=>I!==this):[];break;case "ancestors":let D=this.parent;for(;D;)z.push(D),D=D.parent;break;case "descendants":z=
this.children.flatMap(f(function N(J){return[J,...J.children.flatMap(N)]},"recurse"))}if(v&&("and"!==(n.includeOp||"and")&&Array.isArray(n.include)?z=z.filter(D=>n.include.some(I=>D.is(I))):z=z.filter(D=>D.is(v))),u&&("and"!==(n.includeOp||"and")&&Array.isArray(n.include)?z=z.filter(D=>!n.exclude.some(I=>D.is(I))):z=z.filter(D=>!D.is(u))),!0===n.visible&&(z=z.filter(D=>D.visible)),n.distance){if(!this.pos)throw Error("Can't do a distance query from an object without pos");let D=n.distance*n.distance;
"near"===(n.distanceOp||"near")?z=z.filter(I=>I.pos&&this.pos.sdist(I.pos)<=D):z=z.filter(I=>I.pos&&this.pos.sdist(I.pos)>D)}return n.name&&(z=z.filter(D=>D.name===n.name)),z},isAncestorOf(n){return n.parent?n.parent===this||this.isAncestorOf(n.parent):!1},exists(){return l.game.root.isAncestorOf(this)},is(n,v="and"){return Array.isArray(n)?"and"===v?n.every(u=>h.has(u)):n.some(u=>h.has(u)):h.has(n)},tag(n){if(Array.isArray(n))for(let v of n)h.add(v),this.trigger("tag",v),l.game.events.trigger("tag",
this,v);else h.add(n),this.trigger("tag",n),l.game.events.trigger("tag",this,n)},untag(n){if(Array.isArray(n))for(let v of n)h.delete(v),this.trigger("untag",v),l.game.events.trigger("untag",this,v);else h.delete(n),this.trigger("untag",n),l.game.events.trigger("untag",this,n)},has(n,v="and"){return Array.isArray(n)?"and"===v?n.every(u=>b.has(u)):n.some(u=>b.has(u)):b.has(n)},on(n,v){let u=e.on(n,v.bind(this));return k&&k(()=>u.cancel()),u},trigger(n,...v){e.trigger(n,...v);l.game.objEvents.trigger(n,
this,...v)},destroy(){this.parent&&this.parent.remove(this)},inspect(){let n={};for(let [v,u]of b)n[v]=u.inspect?.()??null;for(let [v,u]of c.entries())if(u.inspect)n[v]=u.inspect();else for(let [z,D]of Object.entries(u))"function"!=typeof D&&(n[z]=`${z}: ${D}`);return n},onAdd(n){return this.on("add",n)},onFixedUpdate(n){return this.on("fixedUpdate",n)},onUpdate(n){return this.on("update",n)},onDraw(n){return this.on("draw",n)},onDestroy(n){return this.on("destroy",n)},onUse(n){return this.on("use",
n)},onUnuse(n){return this.on("unuse",n)},clearEvents(){e.clear()}},B="onKeyPress onKeyPressRepeat onKeyDown onKeyRelease onMousePress onMouseDown onMouseRelease onMouseMove onCharInput onMouseMove onTouchStart onTouchMove onTouchEnd onScroll onGamepadButtonPress onGamepadButtonDown onGamepadButtonRelease onGamepadStick onButtonPress onButtonDown onButtonRelease".split(" ");for(let n of B)r[n]=(...v)=>{let u=l.app[n]?.(...v);return g.push(u),r.onDestroy(()=>u.cancel()),r.on("sceneEnter",()=>{g.splice(g.indexOf(u),
1);let z=l.app[n]?.(...v);ob.replace(u,z);g.push(u)}),u};for(let n of a)r.use(n);return r}function Ig(a){l.game.gravity=a?(l.game.gravity||y(0,1)).unit().scale(a):null}function Jg(){return l.game.gravity?l.game.gravity.len():0}function Kg(a){l.game.gravity=a.unit().scale(l.game.gravity?l.game.gravity.len():1)}function Eb(){return l.game.gravity?l.game.gravity.unit():y(0,1)}function Lg(a,b={}){function c(){l.debug.paused||l.app.isHidden()&&!l.globalOpt.backgroundAudio||l.audio.ctx.resume()}function d(){c();
g.play()}let e=new ua,g=new Audio(a);g.crossOrigin="anonymous";g.loop=!!b.loop;l.audio.ctx.createMediaElementSource(g).connect(l.audio.masterNode);f(c,"resumeAudioCtx");return f(d,"play"),b.paused||d(),g.onended=()=>e.trigger(),{play(){d()},seek(h){g.currentTime=h},stop(){g.pause();this.seek(0)},set loop(h){g.loop=h},get loop(){return g.loop},set paused(h){h?g.pause():d()},get paused(){return g.paused},time(){return g.currentTime},duration(){return g.duration},set volume(h){g.volume=Na(h,0,1)},get volume(){return g.volume},
set speed(h){g.playbackRate=Math.max(h,0)},get speed(){return g.playbackRate},set detune(h){},get detune(){return 0},onEnd(h){return e.add(h)},then(h){return this.onEnd(h)}}}function Mg(a,b={}){if("string"==typeof a&&l.assets.music[a])return Lg(l.assets.music[a],b);let c=l.audio.ctx,d=b.paused??!1,e=c.createBufferSource(),g=new ua,h=c.createGain(),m=c.createStereoPanner(),k=b.seek??0,p=0,r=0,B=!1;e.loop=!!b.loop;e.detune.value=b.detune??0;e.playbackRate.value=b.speed??1;e.connect(m);e.onended=()=>
{n()>=(e.buffer?.duration??Number.POSITIVE_INFINITY)&&g.trigger()};m.pan.value=b.pan??0;m.connect(h);h.connect(l.audio.masterNode);h.gain.value=b.volume??1;b=f(u=>{e.buffer=u.buf;d||(p=c.currentTime,e.start(0,k),B=!0)},"start");a=Sf(a);a instanceof La&&a.onLoad(b);let n=f(()=>{if(!e.buffer)return 0;let u=d?r-p:c.currentTime-p,z=e.buffer.duration;return e.loop?u%z:Math.min(u,z)},"getTime"),v=f(u=>{let z=c.createBufferSource();return z.buffer=u.buffer,z.loop=u.loop,z.playbackRate.value=u.playbackRate.value,
z.detune.value=u.detune.value,z.onended=u.onended,z.connect(m),z},"cloneNode");return{stop(){this.paused=!0;this.seek(0)},set paused(u){d!==u&&((d=u,u)?(B&&(e.stop(),B=!1),r=c.currentTime):(e=v(e),u=r-p,e.start(0,u),B=!0,p=c.currentTime-u,r=0))},get paused(){return d},play(u=0){this.seek(u);this.paused=!1},seek(u){e.buffer?.duration&&(u>e.buffer.duration||(d?(e=v(e),p=r-u):(e.stop(),e=v(e),p=c.currentTime-u,e.start(0,u),B=!0,r=0)))},set speed(u){e.playbackRate.value=u},get speed(){return e.playbackRate.value},
set detune(u){e.detune.value=u},get detune(){return e.detune.value},set volume(u){h.gain.value=Math.max(u,0)},get volume(){return h.gain.value},set pan(u){m.pan.value=u},get pan(){return m.pan.value},set loop(u){e.loop=u},get loop(){return e.loop},duration(){return e.buffer?.duration??0},time(){return n()%this.duration()},onEnd(u){return g.add(u)},then(u){return this.onEnd(u)}}}function $d(a){return l.k.play(l.audio.burpSnd,a)}function ae(a){l.audio.masterNode.gain.value=a}function be(){return l.audio.masterNode.gain.value}
function Ng(a){return kb("volume","setVolume / getVolume"),void 0!==a&&ae(a),be()}function ce(){l.app.onHide(()=>{l.globalOpt.backgroundAudio||l.audio.ctx.suspend()});l.app.onShow(()=>{l.globalOpt.backgroundAudio||l.debug.paused||l.audio.ctx.resume()});l.app.onResize(()=>{if(!l.app.isFullscreen()){var a=l.globalOpt.width&&l.globalOpt.height;a&&!l.globalOpt.stretch&&!l.globalOpt.letterbox||(l.canvas.width=l.canvas.offsetWidth*l.pixelDensity,l.canvas.height=l.canvas.offsetHeight*l.pixelDensity,Jd(),
a||(l.gfx.frameBuffer.free(),l.gfx.frameBuffer=new Zb(l.gfx.ggl,l.gfx.ggl.gl.drawingBufferWidth,l.gfx.ggl.gl.drawingBufferHeight),l.gfx.width=l.gfx.ggl.gl.drawingBufferWidth/l.pixelDensity/l.gscale,l.gfx.height=l.gfx.ggl.gl.drawingBufferHeight/l.pixelDensity/l.gscale))}});!1!==l.globalOpt.debug&&(l.app.onKeyPress(l.globalOpt.debugKey??"f1",()=>l.debug.inspect=!l.debug.inspect),l.app.onKeyPress("f2",()=>l.debug.clearLog()),l.app.onKeyPress("f8",()=>l.debug.paused=!l.debug.paused),l.app.onKeyPress("f7",
()=>{l.debug.timeScale=rc(Na(l.debug.timeScale-.2,0,2),1)}),l.app.onKeyPress("f9",()=>{l.debug.timeScale=rc(Na(l.debug.timeScale+.2,0,2),1)}),l.app.onKeyPress("f10",()=>l.debug.stepFrame()));l.globalOpt.burp&&l.app.onKeyPress("b",()=>$d())}function Og(a,b={}){let c=l.game.root.add([Xb(a),de()]),d=5*(b.speed||1),e=b.scale||1;c.add([Ec(l.boomSprite),$b(0),Fc("center"),ee(d,e),...(b.comps??[])]);let g=c.add([Ec(l.kaSprite),$b(0),Fc("center"),Gc(),...(b.comps??[])]);return g.wait(.4/d,()=>g.use(ee(d,
e))),g.onDestroy(()=>c.destroy()),c}function fe(a,b){if(l.game.layers)throw Error("Layers can only be assigned once.");b=a.indexOf(b);if(-1==b)throw Error("The default layer name should be present in the layers list.");l.game.layers=a;l.game.defaultLayerIndex=b}function Pg(){return l.game.layers}function Qg(){return l.game.layers?.[l.game.defaultLayerIndex]??null}function Rg(a,b){kb("layers","setLayers");fe(a,b)}function Yd(a){a.destroy()}function Sg(){return l.game.root}function Tg(a,b){l.game.scenes[a]=
b}function Ug(a,...b){if(!l.game.scenes[a])throw Error(`Scene not found: ${a}`);l.game.events.onOnce("frameEnd",()=>{l.game.events.trigger("sceneLeave",a);l.app.events.clear();l.game.events.clear();l.game.objEvents.clear();[...l.game.root.children].forEach(c=>{!c.stay||c.scenesToStay&&!c.scenesToStay.includes(a)?l.game.root.remove(c):c.trigger("sceneEnter",a)});l.game.root.clearEvents();ce();l.game.cam={pos:null,scale:y(1),angle:0,shake:0,transform:new Sa};l.game.scenes[a](...b)});l.game.currentScene=
a}function Vg(a){return l.game.events.on("sceneLeave",a)}function Wg(){return l.game.currentScene}function Ec(a,b={}){let c=null,d=null,e=null,g=new ua;if(!a)throw Error("Please pass the resource name or data to sprite()");let h=f((k,p,r,B)=>{let n=y(1,1);return r&&B?(n.x=r/(k.width*p.w),n.y=B/(k.height*p.h)):r?(n.x=r/(k.width*p.w),n.y=n.x):B&&(n.y=B/(k.height*p.h),n.x=n.y),n},"calcTexScale"),m=f((k,p)=>{if(p){var r=p.frames[0].clone();b.quad&&(r=r.scale(b.quad));var B=h(p.tex,r,b.width,b.height);
k.width=p.tex.width*r.w*B.x;k.height=p.tex.height*r.h*B.y;b.anim&&k.play(b.anim);c=p;g.trigger(c)}},"setSpriteData");return{id:"sprite",width:0,height:0,frame:b.frame||0,quad:b.quad||new la(0,0,1,1),animSpeed:b.animSpeed??1,flipX:b.flipX??!1,flipY:b.flipY??!1,get sprite(){return a.toString()},set sprite(k){(k=Tb(k))&&k.onLoad(p=>m(this,p))},get animFrame(){if(!c||!d||null===e)return this.frame;let k=c.anims[d.name];return"number"==typeof k?k:this.frame-Math.min(k.from,k.to)},draw(){if(c){var k=c.frames[this.frame??
0];if(!k)throw Error(`Frame not found: ${this.frame??0}`);if(c.slice9){let {left:u,right:z,top:D,bottom:I}=c.slice9;var p=c.tex.width*k.w,r=c.tex.height*k.h,B=this.width-u-z,n=this.height-D-I,v=u/p;p=z/p;let J=1-v-p,N=D/r;r=I/r;let H=1-N-r;B=[na(0,0,v,N),na(v,0,J,N),na(v+J,0,p,N),na(0,N,v,H),na(v,N,J,H),na(v+J,N,p,H),na(0,N+H,v,r),na(v,N+H,J,r),na(v+J,N+H,p,r),na(0,0,u,D),na(u,0,B,D),na(u+B,0,z,D),na(0,D,u,n),na(u,D,B,n),na(u+B,D,z,n),na(0,D+n,u,I),na(u,D+n,B,I),na(u+B,D+n,z,I)];for(n=0;9>n;n++)v=
B[n],p=B[n+9],Wb(Object.assign(jb(this),{pos:p.pos(),tex:c.tex,quad:k.scale(v),flipX:this.flipX,flipY:this.flipY,tiled:b.tiled,width:p.w,height:p.h}))}else Wb(Object.assign(jb(this),{tex:c.tex,quad:k.scale(this.quad??new la(0,0,1,1)),flipX:this.flipX,flipY:this.flipY,tiled:b.tiled,width:this.width,height:this.height}))}},add(){let k=Tb(a);k?k.onLoad(p=>m(this,p)):Bc(()=>m(this,Tb(a).data))},update(){if(c&&d&&null!==e){var k=c.anims[d.name];if("number"==typeof k)this.frame=k;else{if(0===k.speed)throw Error("Sprite anim speed cannot be 0");
d.timer+=qa()*this.animSpeed;d.timer>=1/d.speed&&(d.timer=0,this.frame+=e,(this.frame<Math.min(k.from,k.to)||this.frame>Math.max(k.from,k.to))&&(d.loop?d.pingpong?(this.frame-=e,e*=-1,this.frame+=e):this.frame=k.from:d.pingpong?e===Math.sign(k.to-k.from)?(this.frame=k.to,e*=-1,this.frame+=e):(this.frame=k.from,d.onEnd(),this.stop()):(this.frame=k.to,d.onEnd(),this.stop())))}}},play(k,p={}){if(c){var r=c.anims[k];if(void 0===r)throw Error(`Anim not found: ${k}`);d&&this.stop();d="number"==typeof r?
{name:k,timer:0,loop:!1,pingpong:!1,speed:0,onEnd:f(()=>{},"onEnd")}:{name:k,timer:0,loop:p.loop??r.loop??!1,pingpong:p.pingpong??r.pingpong??!1,speed:p.speed??r.speed??10,onEnd:p.onEnd??(()=>{})};e="number"==typeof r?null:r.from<r.to?1:-1;this.frame="number"==typeof r?r:r.from;this.trigger("animStart",k)}else g.add(()=>this.play(k,p))},stop(){if(d){var k=d.name;d=null;this.trigger("animEnd",k)}},numFrames(){return c?.frames.length??0},getCurAnim(){return d},curAnim(){return d?.name},getAnim(k){return c?.anims[k]??
null},hasAnim(k){return!!this.getAnim(k)},onAnimEnd(k){return this.on("animEnd",k)},onAnimStart(k){return this.on("animStart",k)},renderArea(){return new ka(y(0),this.width,this.height)},inspect(){return"string"==typeof a?`sprite: "${a}"`:null}}}function Xg(a,b={}){function c(e){let g=gb(Object.assign(jb(e),{text:e.text+"",size:e.textSize,font:e.font,width:b.width&&e.width,align:e.align,letterSpacing:e.letterSpacing,lineSpacing:e.lineSpacing,transform:e.textTransform,styles:e.textStyles,indentAll:b.indentAll}));
return b.width||(e.width=g.width/(e.scale?.x||1)),e.height=g.height/(e.scale?.y||1),g}f(c,"update");let d={id:"text",set text(e){a=e;c(this);this.renderedText=zc(a).text},get text(){return a},textSize:b.size??36,font:b.font,width:b.width??0,height:0,align:b.align,lineSpacing:b.lineSpacing,letterSpacing:b.letterSpacing,textTransform:b.transform,textStyles:b.styles,renderedText:a?zc(a).text:"",add(){Bc(()=>c(this))},draw(){hb(c(this))},renderArea(){return new ka(y(0),this.width,this.height)}};return c(d),
d}function Yg(a,b){return{id:"rect",width:a,height:b,draw(){Cb(Object.assign(jb(this),{width:this.width,height:this.height}))},renderArea(){return new ka(y(0),this.width,this.height)},inspect(){return`uvquad: (${Math.ceil(this.width)}w, ${Math.ceil(this.height)})h`}}}function Zg(a={}){let b=null,c=null,d=null,e=null;return{id:"agent",require:["pos","tile"],agentSpeed:a.speed??100,allowDiagonals:a.allowDiagonals??!0,getDistanceToTarget(){return b?this.pos.dist(b):0},getNextLocation(){return c&&d?c[d]:
null},getPath(){return c?c.slice():null},getTarget(){return b},isNavigationFinished(){return c?null===d:!0},isTargetReachable(){return null!==c},isTargetReached(){return b?this.pos.eq(b):!0},setTarget(g){b=g;d=(c=this.getLevel().getPath(this.pos,b,{allowDiagonals:this.allowDiagonals}))?0:null;c&&null!==d?(e||(e=this.getLevel().onNavigationMapChanged(()=>{b&&c&&null!==d&&(c=this.getLevel().getPath(this.pos,b,{allowDiagonals:this.allowDiagonals}),c?(d=0,this.trigger("navigationNext",this,c[d])):(d=
null,this.trigger("navigationEnded",this)))}),this.onDestroy(()=>e?.cancel())),this.trigger("navigationStarted",this),this.trigger("navigationNext",this,c[d])):this.trigger("navigationEnded",this)},update(){if(b&&c&&null!==d){if(2>this.pos.sdist(c[d])){if(d===c.length-1){this.pos=b.clone();d=null;this.trigger("navigationEnded",this);this.trigger("targetReached",this);return}d++;this.trigger("navigationNext",this,c[d])}this.moveTo(c[d],this.agentSpeed)}},onNavigationStarted(g){return this.on("navigationStarted",
g)},onNavigationNext(g){return this.on("navigationNext",g)},onNavigationEnded(g){return this.on("navigationEnded",g)},onTargetReached(g){return this.on("targetReached",g)},inspect(){return"agent: "+JSON.stringify({target:JSON.stringify(b),path:JSON.stringify(c)})}}}function $g(a){let b=a.graph;return{id:"pathfinder",require:["pos"],navigateTo(c){return this.graph?.getWaypointPath(this.pos,c,a.navigationOpt)},get graph(){if(b)return b;let c=this.parent;for(;c;){if(c.has("pathfinderMap"))return c.graph;
c=c.parent}},set graph(c){b=c}}}function ah(a={}){let b=a.waypoints,c=a.speed||100,d=a.endBehavior||"stop",e=0,g=null!=b;return{id:"patrol",require:["pos"],get patrolSpeed(){return c},set patrolSpeed(h){c=h},get waypoints(){return b},set waypoints(h){b=h;e=0;g=!1},get nextLocation(){return b?b[e]:void 0},update(){let h=this.nextLocation;if(b&&h&&!g&&(this.moveTo(h,c),9>this.pos.sdist(h)))switch(d){case "loop":e=(e+1)%b.length;break;case "ping-pong":e+=1;e==b.length&&(b.reverse(),e=0);break;case "stop":e=
Math.min(e+1,b.length-1),e==b.length-1&&(g=!0,this.trigger("patrolFinished"))}},onPatrolFinished(h){return this.on("patrolFinished",h)}}}function bh(a,b={}){let c="function"==typeof a?a:()=>l.game.root.query(a),d=b.checkFrequency||1,e="number"==typeof b.direction?C.fromAngle(b.direction):b.direction,g=0;return{id:"sentry",require:["pos"],direction:"number"==typeof b.direction?C.fromAngle(b.direction):b.direction,spotted:[],set directionAngle(h){this.direction=void 0!==h?C.fromAngle(h):void 0},get directionAngle(){return this.direction?
this.direction.angle():void 0},fieldOfView:b.fieldOfView||200,isWithinFieldOfView(h,m,k){m=("number"==typeof m?C.fromAngle(m):m)||e;k=k||b.fieldOfView;if(!m||!k||360<=k)return!0;k/=2;return h.pos&&m.angleBetween(h.pos.sub(this.pos))<=k},hasLineOfSight(h){let m=Md(this.pos,h.pos.sub(this.pos),b.raycastExclude);return null!=m&&m.object===h},update(){if(g+=qa(),g>d){g-=d;let h=c();if(h.length&&e&&this.fieldOfView&&360>this.fieldOfView){let m=this.fieldOfView/2;h=h.filter(k=>k.pos&&e.angleBetween(k.pos.sub(this.pos))<=
m)}h.length&&b.lineOfSight&&(h=h.filter(m=>m.pos&&this.hasLineOfSight(m)));0<h.length&&(this.spotted=h,this.trigger("objectSpotted",h))}},onObjectsSpotted(h){return this.on("objectSpotted",h)}}}function Od(a={}){let b=y(0),c=a.isObstacle??!1,d=a.cost??0,e=a.edges??[],g=f(()=>{let m={left:1,top:2,right:4,bottom:8};return e.map(k=>m[k]||0).reduce((k,p)=>k|p,0)},"getEdgeMask"),h=g();return{id:"tile",tilePosOffset:a.offset??y(0),set tilePos(m){let k=this.getLevel();b=m.clone();this.pos=y(this.tilePos.x*
k.tileWidth(),this.tilePos.y*k.tileHeight()).add(this.tilePosOffset)},get tilePos(){return b},set isObstacle(m){c!==m&&(c=m,this.getLevel().invalidateNavigationMap())},get isObstacle(){return c},set cost(m){d!==m&&(d=m,this.getLevel().invalidateNavigationMap())},get cost(){return d},set edges(m){e=m;h=g();this.getLevel().invalidateNavigationMap()},get edges(){return e},get edgeMask(){return h},getLevel(){return this.parent},tileMove(m){let k=this.getLevel();k.removeFromSpatialMap(this);this.tilePos=
this.tilePos.add(m);k.insertIntoSpatialMap(this);k.trigger("spatialMapChanged")},moveLeft(){this.tileMove(y(-1,0))},moveRight(){this.tileMove(y(1,0))},moveUp(){this.tileMove(y(0,-1))},moveDown(){this.tileMove(y(0,1))}}}function ge(a,b){return b.add(b.sub(a))}function ch(a={}){let b=[],c=0,d=!1;return{id:"animate",require:a.followMotion?["rotate"]:void 0,base:{pos:y(0,0),angle:0,scale:y(1,1),opacity:1},animation:{paused:!1,seek(e){c=Na(e,0,this.duration);b.forEach(g=>{g.isFinished=!1});d=!1},get duration(){return b.reduce((e,
g)=>Math.max(g.duration,e),0)}},add(){a.relative&&(this.has("pos")&&(this.base.pos=this.pos.clone()),this.has("rotate")&&(this.base.angle=this.angle),this.has("scale")&&(this.base.scale=this.scale),this.has("opacity")&&(this.base.opacity=this.opacity))},update(){if(!this.animation.paused){var e=!0,g;c+=qa();for(let h of b)(g=h.update(this,c))&&!h.isFinished&&(h.isFinished=!0,this.trigger("animateChannelFinished",h.name)),e&&(e=g);e&&!d&&(d=!0,this.trigger("animateFinished"))}},animate(e,g,h){d=!1;
this.unanimate(e);"number"==typeof g[0]?b.push(new dh(e,g,h,a.relative||!1)):g[0]instanceof C?b.push(new eh(e,g,h,a.relative||!1,"pos"===e&&(a.followMotion||!1))):g[0]instanceof Y&&b.push(new fh(e,g,h,a.relative||!1))},unanimate(e){let g=b.findIndex(h=>h.name===e);0<=g&&b.splice(g,1)},unanimateAll(){b.splice(0,b.length)},onAnimateFinished(e){return this.on("animateFinished",e)},onAnimateChannelFinished(e){return this.on("animateChannelFinished",e)},serializeAnimationChannels(){return b.reduce((e,
g)=>(e[g.name]=g.serialize(),e),{})},serializeAnimationOptions(){let e={};return a.followMotion&&(e.followMotion=!0),a.relative&&(e.relative=!0),e}}}function he(a,b){b={name:a.name};return a.has("animate")&&(b.channels=a.serializeAnimationChannels(),Object.assign(b,a.serializeAnimationOptions())),0<a.children.length&&(b.children=a.children.filter(c=>c.has("named")).map(c=>he(c,c.name))),b}function ee(a=2,b=1){let c=0;return{require:["scale"],update(){let d=Math.sin(c*a)*b;0>d&&this.destroy();this.scale=
y(d);c+=qa()}}}function gh(a,b){if(null==a)throw Error("health() requires the initial amount of hp");return{id:"health",hurt(c=1){this.setHP(a-c);this.trigger("hurt",c)},heal(c=1){let d=a;this.setHP(a+c);this.trigger("heal",a-d)},hp(){return a},maxHP(){return b??null},setMaxHP(c){b=c},setHP(c){a=b?Math.min(b,c):c;0>=a&&this.trigger("death")},onHurt(c){return this.on("hurt",c)},onHeal(c){return this.on("heal",c)},onDeath(c){return this.on("death",c)},inspect(){return`health: ${a}`}}}function hh(a,
b={}){if(null==a)throw Error("lifespan() requires time");let c=b.fade??0;return{id:"lifespan",require:["opacity"],add(){l.game.root.wait(a,()=>{this.opacity=this.opacity??1;0<c?l.game.root.tween(this.opacity,0,c,d=>this.opacity=d,ac.linear).onEnd(()=>{this.destroy()}):this.destroy()})}}}function ih(a){return{id:"named",name:a}}function jh(a,b,c){function d(k){h[k]||(h[k]={enter:new ua,end:new ua,update:new ua,draw:new ua})}function e(k,p,r){return d(p),h[p][k].add(r)}function g(k,p,...r){d(p);h[p][k].trigger(...r)}
if(!a)throw Error("state() requires an initial state");let h={};f(d,"initStateEvents");f(e,"on");f(g,"trigger");let m=!1;return{id:"state",state:a,enterState(k,...p){if(m=!0,b&&!b.includes(k))throw Error(`State not found: ${k}`);let r=this.state;if(c){if(!c?.[r])return;let B="string"==typeof c[r]?[c[r]]:c[r];if(!B.includes(k))throw Error(`Cannot transition state from "${r}" to "${k}". Available transitions: ${B.map(n=>`"${n}"`).join(", ")}`);}g("end",r,...p);this.state=k;g("enter",k,...p);g("enter",
`${r} -> ${k}`,...p)},onStateTransition(k,p,r){return e("enter",`${k} -> ${p}`,r)},onStateEnter(k,p){return e("enter",k,p)},onStateUpdate(k,p){return e("update",k,p)},onStateDraw(k,p){return e("draw",k,p)},onStateEnd(k,p){return e("end",k,p)},update(){m||(g("enter",a),m=!0);g("update",this.state)},draw(){g("draw",this.state)},inspect(){return`state: ${this.state}`}}}function de(a){return{id:"stay",stay:!0,scenesToStay:a}}function kh(a=!0,b){let c,d;return{id:"textInput",hasFocus:a,require:["text"],
typedText:"",add(){let e=f(()=>{this.text=this.typedText.replace(/([\[\\])/g,"\\$1")},"flip");c=l.k.onCharInput(g=>{this.hasFocus&&(!b||this.typedText.length<b)&&(l.k.isKeyDown("shift")?this.typedText+=g.toUpperCase():this.typedText+=g,e())});d=l.k.onKeyPressRepeat("backspace",()=>{this.hasFocus&&(this.typedText=this.typedText.slice(0,-1));e()})},destroy(){c.cancel();d.cancel()}}}function Gc(a=1E3){return{id:"timer",maxLoopsPerFrame:a,loop(b,c,d=-1,e=!1){let g=e?0:b,h=new ua,m=this.onUpdate(()=>{g+=
l.app.state.dt;for(let k=0;g>=b&&k<this.maxLoopsPerFrame;k++){if(-1!=d&&(d--,0>d)){m.cancel();h.trigger();break}c();g-=b}});return{get paused(){return m.paused},set paused(k){m.paused=k},cancel:m.cancel,onEnd:h.add,then(k){return h.add(k),this}}},wait(b,c){return this.loop(b,c??(()=>{}),1,!0)},tween(b,c,d,e,g=ac.linear){let h=0,m=[],k=this.onUpdate(()=>{h+=l.app.state.dt;let p=Math.min(h/d,1);e(wa(b,c,g(p)));1===p&&(k.cancel(),e(c),m.forEach(r=>r()))});return{get paused(){return k.paused},set paused(p){k.paused=
p},onEnd(p){m.push(p)},then(p){return this.onEnd(p),this},cancel(){k.cancel()},finish(){k.cancel();e(c);m.forEach(p=>p())}}}}}function lh(a={}){let b={},c=new Set,d=[];return{id:"area",collisionIgnore:a.collisionIgnore??[],add(){Hc++;this.area.cursor&&d.push(this.onHover(()=>l.app.setCursor(this.area.cursor)));d.push(this.onCollideUpdate((e,g)=>{if(!e.id)throw Error("area() requires the object to have an id");b[e.id]||this.trigger("collide",e,g);g&&(b[e.id]=g,c.add(e.id))}))},destroy(){Hc--;for(let e of d)e.cancel()},
fixedUpdate(){for(let e in b)c.has(Number(e))||(this.trigger("collideEnd",b[e].target),delete b[e]);c.clear()},drawInspect(){let e=this.localArea();Ea();ma(this.area.offset);let g={outline:{width:4/od(),color:R(0,0,255)},anchor:this.anchor,fill:!1,fixed:ib(this)};e instanceof ka?Ha({...g,pos:e.pos,width:e.width*this.area.scale.x,height:e.height*this.area.scale.y}):e instanceof xa?Ya({...g,pts:e.pts,scale:this.area.scale}):e instanceof Da&&nb({...g,pos:e.center,radius:e.radius});ya()},area:{shape:a.shape??
null,scale:a.scale?y(a.scale):y(1),offset:a.offset??y(0),cursor:a.cursor??null},isClicked(){return l.app.isMousePressed()&&this.isHovering()},isHovering(){let e=ib(this)?l.k.mousePos():l.k.toWorld(l.k.mousePos());return this.hasPoint(e)},checkCollision(e){if(!e.id)throw Error("checkCollision() requires the object to have an id");return b[e.id]??null},getCollisions(){return Object.values(b)},isColliding(e){if(!e.id)throw Error("isColliding() requires the object to have an id");return!!b[e.id]},isOverlapping(e){if(!e.id)throw Error("isOverlapping() requires the object to have an id");
return(e=b[e.id])&&e.hasOverlap()},onClick(e,g="left"){g=l.app.onMousePress(g,()=>{this.isHovering()&&e()});return d.push(g),g},onHover(e){let g=!1;return this.onUpdate(()=>{g?g=this.isHovering():this.isHovering()&&(g=!0,e())})},onHoverUpdate(e){return this.onUpdate(()=>{this.isHovering()&&e()})},onHoverEnd(e){let g=!1;return this.onUpdate(()=>{g?this.isHovering()||(g=!1,e()):g=this.isHovering()})},onCollide(e,g){if("function"==typeof e&&void 0===g)return this.on("collide",e);if("string"==typeof e)return this.onCollide((h,
m)=>{h.is(e)&&g?.(h,m)});throw Error("onCollide() requires either a function or a tag");},onCollideUpdate(e,g){if("function"==typeof e&&void 0===g)return this.on("collideUpdate",e);if("string"==typeof e)return this.on("collideUpdate",(h,m)=>h.is(e)&&g?.(h,m));throw Error("onCollideUpdate() requires either a function or a tag");},onCollideEnd(e,g){if("function"==typeof e&&void 0===g)return this.on("collideEnd",e);if("string"==typeof e)return this.on("collideEnd",h=>h.is(e)&&g?.(h));throw Error("onCollideEnd() requires either a function or a tag");
},hasPoint(e){return Va(this.worldArea(),e)},resolveCollision(e){(e=this.checkCollision(e))&&!e.resolved&&(this.pos=this.pos.add(e.displacement),e.resolved=!0)},localArea(){return this.area.shape?this.area.shape:this.renderArea()},worldArea(){let e=this.localArea();if(!(e instanceof xa||e instanceof ka))throw Error("Only support polygon and rect shapes for now");let g=this.transform.clone().translate(this.area.offset).scale(y(this.area.scale??1));if(e instanceof ka){let h=lb(this.anchor||"topleft").add(1,
1).scale(-.5).scale(e.width,e.height);g.translate(h)}return e.transform(g)},screenArea(){let e=this.worldArea();return ib(this)?e:e.transform(l.game.cam.transform)},inspect(){return this.area.scale?.x==this.area.scale?.y?`area: ${this.area.scale?.x?.toFixed(1)}x`:`area: (${this.area.scale?.x?.toFixed(1)}x, ${this.area.scale.y?.toFixed(1)}y)`}}}function mh(a={}){let b=null,c=null,d=!1,e=y(0),g=null,h=null,m;return{id:"body",require:["pos"],vel:y(0),drag:a.drag??0,jumpForce:a.jumpForce??640,gravityScale:a.gravityScale??
1,isStatic:a.isStatic??!1,mass:a.mass??1,add(){if(g=this.pos.clone(),h=this.pos.clone(),m=this.pos.clone(),0===this.mass)throw Error("Can't set body mass to 0");this.has("area")&&(this.onCollideUpdate((k,p)=>{if(p&&k.has("body")&&!p.resolved){this.trigger("beforePhysicsResolve",p);var r=p.reverse();(k.trigger("beforePhysicsResolve",r),p.resolved||r.resolved||this.isStatic&&k.isStatic)||(this.isStatic||k.isStatic?(r=!this.isStatic&&k.isStatic?p:p.reverse(),r.source.pos=r.source.pos.add(r.displacement),
r.source.transform=xb(r.source)):(r=this.mass+k.mass,this.pos=this.pos.add(p.displacement.scale(k.mass/r)),k.pos=k.pos.add(p.displacement.scale(-this.mass/r)),this.transform=xb(this),k.transform=xb(k)),p.resolved=!0,this.trigger("physicsResolve",p),k.trigger("physicsResolve",p.reverse()))}}),this.onPhysicsResolve(k=>{if(l.game.gravity)if(k.isBottom()&&this.isFalling()){this.vel=this.vel.reject(l.game.gravity.unit());let p=b;b=k.target;p!=b&&(c=k.target.pos);d?d=!1:p||(this.trigger("ground",b),k.target.trigger("land",
this))}else k.isTop()&&this.isJumping()&&(this.vel=this.vel.reject(l.game.gravity.unit()),this.trigger("headbutt",k.target),k.target.trigger("headbutted",this))}))},update(){b&&this.isColliding(b)&&b.exists()&&b.has("body")&&(c&&!b.pos.eq(c)&&!1!==a.stickToPlatform&&this.moveBy(b.pos.sub(c)),c=b.pos);let k=uc();k&&(this.pos.x==m.x&&(this.pos.x=wa(g.x,h.x,k/tc()),m.x=this.pos.x),this.pos.y==m.y&&(this.pos.y=wa(g.y,h.y,k/tc()),m.y=this.pos.y))},fixedUpdate(){if(g&&(this.pos.x==m.x&&(this.pos.x=g.x),
this.pos.y==m.y&&(this.pos.y=g.y),g=null),l.game.gravity&&!this.isStatic){d&&(b=null,c=null,this.trigger("fallOff"),d=!1);!b||this.isColliding(b)&&b.exists()&&b.has("body")||(d=!0);var k=this.vel.clone();this.vel=this.vel.add(l.game.gravity.scale(this.gravityScale*qa()));let p=a.maxVelocity??65536;this.vel.slen()>p*p&&(this.vel=this.vel.unit().scale(p));0>k.dot(l.game.gravity)&&0<=this.vel.dot(l.game.gravity)&&this.trigger("fall")}if(this.vel.x+=e.x*qa(),this.vel.y+=e.y*qa(),this.vel.x*=1-this.drag*
qa(),this.vel.y*=1-this.drag*qa(),this.move(this.vel),uc())g=this.pos.clone(),k=this.vel.add(e.scale(qa())),h=this.pos.add(k.scale(qa())),m=this.pos.clone();e.x=0;e.y=0},onPhysicsResolve(k){return this.on("physicsResolve",k)},onBeforePhysicsResolve(k){return this.on("beforePhysicsResolve",k)},curPlatform(){return b},isGrounded(){return null!==b},isFalling(){return 0<this.vel.dot(Eb())},isJumping(){return 0>this.vel.dot(Eb())},applyImpulse(k){this.isStatic||(this.vel=this.vel.add(k))},addForce(k){this.isStatic||
(e.x+=k.x/this.mass,e.y+=k.y/this.mass)},jump(k){this.isStatic||(b=null,c=null,this.vel=Eb().scale(-k||-this.jumpForce))},onGround(k){return this.on("ground",k)},onFall(k){return this.on("fall",k)},onFallOff(k){return this.on("fallOff",k)},onHeadbutt(k){return this.on("headbutt",k)},onLand(k){return this.on("land",k)},onHeadbutted(k){return this.on("headbutted",k)},inspect(){return`gravityScale: ${this.gravityScale}x`}}}function nh(a=2){let b=a;return{id:"doubleJump",require:["body"],numJumps:a,add(){this.onGround(()=>
{b=this.numJumps})},doubleJump(c){0>=b||(b<this.numJumps&&this.trigger("doubleJump"),b--,this.jump(c))},onDoubleJump(c){return this.on("doubleJump",c)},inspect(){return`jumpsLeft: ${b}`}}}function oh(a){return{id:"surfaceEffector",require:["area"],speed:a.speed,speedVariation:a.speedVariation??0,forceScale:a.speedVariation??.9,add(){this.onCollideUpdate("body",(b,c)=>{c=c?.normal.normal();let d=b.vel.project(c);c=c?.scale(this.speed)?.sub(d);b.addForce(c?.scale(b.mass*this.forceScale))})}}}function ph(a){return{id:"areaEffector",
require:["area"],useGlobalAngle:a.useGlobalAngle||!1,forceAngle:a.forceAngle,forceMagnitude:a.forceMagnitude,forceVariation:a.forceVariation??0,linearDrag:a.linearDrag??0,add(){this.onCollideUpdate("body",(b,c)=>{b.has("body")&&(c=C.fromAngle(this.forceAngle).scale(this.forceMagnitude),b.addForce(c),this.linearDrag&&b.addForce(b.vel.scale(-this.linearDrag)))})}}}function qh(a){return{id:"pointEffector",require:["area","pos"],forceMagnitude:a.forceMagnitude,forceVariation:a.forceVariation??0,distanceScale:a.distanceScale??
1,forceMode:a.forceMode||"inverseLinear",linearDrag:a.linearDrag??0,add(){this.onCollideUpdate("body",(b,c)=>{c=this.pos.sub(b.pos);let d=c.len(),e=d*this.distanceScale/10;c=c.scale(this.forceMagnitude*("constant"===this.forceMode?1:"inverseLinear"===this.forceMode?1/e:1/e**2)/d);b.addForce(c);this.linearDrag&&b.addForce(b.vel.scale(-this.linearDrag))})}}}function rh(a){return{id:"constantForce",require:["body"],force:a.force,update(){this.force&&this.addForce(this.force)}}}function sh(a){return{id:"platformEffector",
require:["area","body"],surfaceArc:a.surfaceArc??180,useOneWay:a.useOneWay??!1,add(){this.onBeforePhysicsResolve(b=>{var c=b.target.vel;c=Eb().scale(-1).angleBetween(c);Math.abs(c)>this.surfaceArc/2&&b.preventResolution()})}}}function th(a){return{id:"buoyancyEffector",require:["area"],surfaceLevel:a.surfaceLevel,density:a.density??1,linearDrag:a.linearDrag??1,angularDrag:a.angularDrag??.2,flowAngle:a.flowAngle??0,flowMagnitude:a.flowMagnitude??0,flowVariation:a.flowVariation??0,add(){this.onCollideUpdate("body",
(b,c)=>{c=b.worldArea();[c]=c.cut(y(-100,this.surfaceLevel),y(100,this.surfaceLevel));c&&(this.applyBuoyancy(b,c),this.applyDrag(b,c));this.flowMagnitude&&b.addForce(C.fromAngle(this.flowAngle).scale(this.flowMagnitude))})},applyBuoyancy(b,c){c=this.density*c.area();c=y(0,1).scale(-c);b.addForce(c)},applyDrag(b,c){c=b.vel.scale(-(this.density*this.linearDrag));b.addForce(c)}}}function Fc(a){if(!a)throw Error("Please define an anchor");return{id:"anchor",anchor:a,inspect(){return"string"==typeof this.anchor?
"anchor: "+this.anchor:"anchor: "+this.anchor.toString()}}}function Xd(){return{id:"fixed",fixed:!0}}function uh(a,b){return{id:"follow",require:["pos"],follow:{obj:a,offset:b??y(0)},add(){a.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))},update(){a.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))}}}function vh(a){let b=l.game.layers?.indexOf(a);return{id:"layer",get layerIndex(){return b??null},get layer(){return b?l.game.layers?.[b]??null:null},set layer(c){if(b=
l.game.layers?.indexOf(c),-1==b)throw Error("Invalid layer name");},inspect(){return`layer: ${this.layer}`}}}function wh(a,b){let c="number"==typeof a?C.fromAngle(a):a.unit();return{id:"move",require:["pos"],update(){this.move(c.scale(b))}}}function xh(a={}){let b=a.distance??200,c=!1;return{id:"offscreen",require:["pos"],isOffScreen(){let d=this.screenPos();if(!d)return!1;let e=new ka(y(0),sa(),ta());return!Kb(e,d)&&e.sdistToPoint(d)>b*b},onExitScreen(d){return this.on("exitView",d)},onEnterScreen(d){return this.on("enterView",
d)},update(){this.isOffScreen()?(c||(this.trigger("exitView"),c=!0),a.hide&&(this.hidden=!0),a.pause&&(this.paused=!0),a.destroy&&this.destroy()):(c&&(this.trigger("enterView"),c=!1),a.hide&&(this.hidden=!1),a.pause&&(this.paused=!1))}}}function Xb(...a){return{id:"pos",pos:y(...a),moveBy(...b){this.pos=this.pos.add(y(...b))},move(...b){this.moveBy(y(...b).scale(qa()))},moveTo(...b){if("number"==typeof b[0]&&"number"==typeof b[1])return this.moveTo(y(b[0],b[1]),b[2]);let c=b[0];b=b[1];if(void 0===
b)this.pos=y(c);else{var d=c.sub(this.pos);d.len()<=b*qa()?this.pos=y(c):this.move(d.unit().scale(b))}},worldPos(b=null){return b?(this.pos=this.pos.add(this.fromWorld(b)),null):this.parent?this.parent.transform.multVec2(this.pos):this.pos},toWorld(b){return this.parent?this.parent.transform.multVec2(this.pos.add(b)):this.pos.add(b)},fromWorld(b){return this.parent?this.parent.transform.invert().multVec2(b).sub(this.pos):b.sub(this.pos)},screenPos(b=null){return b?(this.pos=this.pos.add(this.fromScreen(b)),
null):(b=this.worldPos())?ib(this)?b:Cc(b):null},toScreen(b){b=this.toWorld(b);return ib(this)?b:Cc(b)},fromScreen(b){return ib(this)?this.fromWorld(b):this.fromWorld(Zd(b))},toOther(b,c){return b.fromWorld(this.toWorld(c))},fromOther(b,c){return b.toOther(this,c)},inspect(){return`pos: (${Math.round(this.pos.x)}x, ${Math.round(this.pos.y)}y)`},drawInspect(){nb({color:R(255,0,0),radius:4/od()})}}}function yh(a){return{id:"rotate",angle:a??0,rotateBy(b){this.angle+=b},rotateTo(b){this.angle=b},inspect(){return`angle: ${Math.round(this.angle)}`}}}
function $b(...a){if(0===a.length)return $b(1);let b=y(...a);return{id:"scale",set scale(c){if(!(c instanceof C))throw Error("The scale property on scale is a vector. Use scaleTo or scaleBy to set the scale with a number.");b=y(c)},get scale(){return b},scaleTo(...c){b=y(...c)},scaleBy(...c){b=b.scale(y(...c))},inspect(){return b.x==b.y?`scale: ${b.x.toFixed(1)}x`:`scale: (${b.x.toFixed(1)}x, ${b.y.toFixed(1)}y)`}}}function zh(a){return{id:"z",z:a,inspect(){return`z: ${this.z}`}}}var Ic=Object.defineProperty,
hi=Object.getOwnPropertyDescriptor,ii=Object.getOwnPropertyNames,ji=Object.prototype.hasOwnProperty,f=(a,b)=>Ic(a,"name",{value:b,configurable:!0}),ki=(a,b,c,d)=>{if(b&&"object"==typeof b||"function"==typeof b)for(let e of ii(b))!ji.call(a,e)&&e!==c&&Ic(a,e,{get:()=>b[e],enumerable:!(d=hi(b,e))||d.enumerable});return a},li=(()=>{for(var a=new Uint8Array(128),b=0;64>b;b++)a[26>b?b+65:52>b?b+71:62>b?b-4:4*b-205]=b;return c=>{for(var d=c.length,e=new Uint8Array(3*(d-("\x3d"==c[d-1])-("\x3d"==c[d-2]))/
4|0),g=0,h=0;g<d;){var m=a[c.charCodeAt(g++)],k=a[c.charCodeAt(g++)],p=a[c.charCodeAt(g++)],r=a[c.charCodeAt(g++)];e[h++]=m<<2|k>>4;e[h++]=k<<4|p>>2;e[h++]=p<<6|r}return e}})(),Ah={};((a,b)=>{for(var c in b)Ic(a,c,{get:b[c],enumerable:!0})})(Ah,{default:()=>mi});V.exports=(a=>ki(Ic({},"__esModule",{value:!0}),a))(Ah);const Z=class{static $jscomp$static$block$510831985$0(){f(this,"Color")}constructor(a,b,c){this.b=this.g=this.r=255;this.r=Na(a,0,255);this.g=Na(b,0,255);this.b=Na(c,0,255)}static fromArray(a){return new Z(a[0],
a[1],a[2])}static fromHex(a){if("number"==typeof a)return new Z(a>>16&255,a>>8&255,a>>0&255);if("string"==typeof a){a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);if(!a)throw Error("Invalid hex color format");return new Z(parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16))}throw Error("Invalid hex color format");}static fromHSL(a,b,c){if(0==b)return new Z(255*c,255*c,255*c);let d=f((h,m,k)=>(0>k&&(k+=1),1<k&&--k,k<1/6?h+6*(m-h)*k:.5>k?m:k<2/3?h+(m-h)*(2/3-k)*6:h),"hue2rgb");b=.5>c?c*(1+
b):c+b-c*b;let e=2*c-b;c=d(e,b,a+1/3);let g=d(e,b,a);a=d(e,b,a-1/3);return new Z(Math.round(255*c),Math.round(255*g),Math.round(255*a))}static $jscomp$static$init$510831985$1$RED(){return new Z(255,0,0)}static $jscomp$static$init$510831985$2$GREEN(){return new Z(0,255,0)}static $jscomp$static$init$510831985$3$BLUE(){return new Z(0,0,255)}static $jscomp$static$init$510831985$4$YELLOW(){return new Z(255,255,0)}static $jscomp$static$init$510831985$5$MAGENTA(){return new Z(255,0,255)}static $jscomp$static$init$510831985$6$CYAN(){return new Z(0,
255,255)}static $jscomp$static$init$510831985$7$WHITE(){return new Z(255,255,255)}static $jscomp$static$init$510831985$8$BLACK(){return new Z(0,0,0)}clone(){return new Z(this.r,this.g,this.b)}lighten(a){return new Z(this.r+a,this.g+a,this.b+a)}darken(a){return this.lighten(-a)}invert(){return new Z(255-this.r,255-this.g,255-this.b)}mult(a){return new Z(this.r*a.r/255,this.g*a.g/255,this.b*a.b/255)}lerp(a,b){return new Z(wa(this.r,a.r,b),wa(this.g,a.g,b),wa(this.b,a.b,b))}toHSL(){let a=this.r/255,
b=this.g/255,c=this.b/255,d=Math.max(a,b,c);var e=Math.min(a,b,c);let g=(d+e)/2,h=g;if(d==e)g=e=0;else{let m=d-e;switch(e=.5<h?m/(2-d-e):m/(d+e),d){case a:g=(b-c)/m+(b<c?6:0);break;case b:g=(c-a)/m+2;break;case c:g=(a-b)/m+4}g/=6}return[g,e,h]}eq(a){return this.r===a.r&&this.g===a.g&&this.b===a.b}toString(){return`rgb(${this.r}, ${this.g}, ${this.b})`}toHex(){return"#"+(16777216+(this.r<<16)+(this.g<<8)+this.b).toString(16).slice(1)}toArray(){return[this.r,this.g,this.b]}};Z.$jscomp$static$block$510831985$0();
Z.RED=Z.$jscomp$static$init$510831985$1$RED();Z.GREEN=Z.$jscomp$static$init$510831985$2$GREEN();Z.BLUE=Z.$jscomp$static$init$510831985$3$BLUE();Z.YELLOW=Z.$jscomp$static$init$510831985$4$YELLOW();Z.MAGENTA=Z.$jscomp$static$init$510831985$5$MAGENTA();Z.CYAN=Z.$jscomp$static$init$510831985$6$CYAN();Z.WHITE=Z.$jscomp$static$init$510831985$7$WHITE();Z.BLACK=Z.$jscomp$static$init$510831985$8$BLACK();var Y=Z;f(R,"rgb");var ni=f((a,b,c)=>Y.fromHSL(a,b,c),"hsl2rgb");f(ca,"deg2rad");f(Ba,"rad2deg");f(Na,"clamp");
f(wa,"lerp");f(Oa,"map");f(ne,"mapc");const ba=class{static $jscomp$static$block$510831985$9(){f(this,"Vec2")}constructor(a=0,b=a){this.y=this.x=0;this.x=a;this.y=b}static fromAngle(a){a=ca(a);return new ba(Math.cos(a),Math.sin(a))}static fromArray(a){return new ba(a[0],a[1])}static $jscomp$static$init$510831985$10$ZERO(){return new ba(0,0)}static $jscomp$static$init$510831985$11$ONE(){return new ba(1,1)}static $jscomp$static$init$510831985$12$LEFT(){return new ba(-1,0)}static $jscomp$static$init$510831985$13$RIGHT(){return new ba(1,
0)}static $jscomp$static$init$510831985$14$UP(){return new ba(0,-1)}static $jscomp$static$init$510831985$15$DOWN(){return new ba(0,1)}clone(){return new ba(this.x,this.y)}add(...a){a=y(...a);return new ba(this.x+a.x,this.y+a.y)}sub(...a){a=y(...a);return new ba(this.x-a.x,this.y-a.y)}scale(...a){a=y(...a);return new ba(this.x*a.x,this.y*a.y)}dist(...a){a=y(...a);return this.sub(a).len()}sdist(...a){a=y(...a);return this.sub(a).slen()}static sdist(a,b){let c=a.x-b.x;a=a.y-b.y;return c*c+a*a}len(){return Math.sqrt(this.dot(this))}slen(){return this.dot(this)}unit(){let a=
this.len();return 0===a?new ba(0):this.scale(1/a)}normal(){return new ba(this.y,-this.x)}reflect(a){return this.sub(a.scale(2*this.dot(a)))}project(a){return a.scale(a.dot(this)/a.len())}reject(a){return this.sub(this.project(a))}dot(a){return this.x*a.x+this.y*a.y}static dot(a,b){return a.x*a.x+a.y*a.y}cross(a){return this.x*a.y-this.y*a.x}static cross(a,b){return a.x*b.y-a.y*b.x}angle(...a){a=y(...a);return Ba(Math.atan2(this.y-a.y,this.x-a.x))}angleBetween(...a){a=y(...a);return Ba(Math.atan2(this.cross(a),
this.dot(a)))}lerp(a,b){return new ba(wa(this.x,a.x,b),wa(this.y,a.y,b))}slerp(a,b){var c=this.dot(a);let d=this.cross(a);c=Math.atan2(d,c);return this.scale(Math.sin((1-b)*c)).add(a.scale(Math.sin(b*c))).scale(1/d)}isZero(){return 0===this.x&&0===this.y}toFixed(a){return new ba(Number(this.x.toFixed(a)),Number(this.y.toFixed(a)))}transform(a){return a.multVec2(this)}eq(a){return this.x===a.x&&this.y===a.y}bbox(){return new ka(this,0,0)}toString(){return`vec2(${this.x.toFixed(2)}, ${this.y.toFixed(2)})`}toArray(){return[this.x,
this.y]}};ba.$jscomp$static$block$510831985$9();ba.ZERO=ba.$jscomp$static$init$510831985$10$ZERO();ba.ONE=ba.$jscomp$static$init$510831985$11$ONE();ba.LEFT=ba.$jscomp$static$init$510831985$12$LEFT();ba.RIGHT=ba.$jscomp$static$init$510831985$13$RIGHT();ba.UP=ba.$jscomp$static$init$510831985$14$UP();ba.DOWN=ba.$jscomp$static$init$510831985$15$DOWN();var C=ba;f(y,"vec2");const Jc=class{static $jscomp$static$block$510831985$16(){f(this,"Quad")}constructor(a,b,c,d){this.y=this.x=0;this.h=this.w=1;this.x=
a;this.y=b;this.w=c;this.h=d}scale(a){return new Jc(this.x+this.w*a.x,this.y+this.h*a.y,this.w*a.w,this.h*a.h)}pos(){return new C(this.x,this.y)}clone(){return new Jc(this.x,this.y,this.w,this.h)}eq(a){return this.x===a.x&&this.y===a.y&&this.w===a.w&&this.h===a.h}toString(){return`quad(${this.x}, ${this.y}, ${this.w}, ${this.h})`}};Jc.$jscomp$static$block$510831985$16();var la=Jc;f(na,"quad");const pb=class{static $jscomp$static$block$510831985$17(){f(this,"Mat2")}constructor(a,b,c,d){this.a=a;this.b=
b;this.c=c;this.d=d}mul(a){return new pb(this.a*a.a+this.b*a.c,this.a*a.b+this.b*a.d,this.c*a.a+this.d*a.c,this.c*a.b+this.d*a.d)}transform(a){return y(this.a*a.x+this.b*a.y,this.c*a.x+this.d*a.y)}get inverse(){let a=this.det;return new pb(this.d/a,-this.b/a,-this.c/a,this.a/a)}get transpose(){return new pb(this.a,this.c,this.b,this.d)}get eigenvalues(){let a=this.trace/2,b=this.det;return[a+Math.sqrt(a*a-b),a-Math.sqrt(a*a-b)]}eigenvectors(a,b){return 0!=this.c?[[a-this.d,this.c],[b-this.d,this.c]]:
0!=this.b?[[this.b,a-this.a],[this.b,b-this.a]]:Math.abs(this.transform(y(1,0)).x-a)<Number.EPSILON?[[1,0],[0,1]]:[[0,1],[1,0]]}get det(){return this.a*this.d-this.b*this.c}get trace(){return this.a+this.d}static rotation(a){let b=Math.cos(a);a=Math.sin(a);return new pb(b,a,-a,b)}static scale(a,b){return new pb(a,0,0,b)}};pb.$jscomp$static$block$510831985$17();var lc=pb;const Fb=class{static $jscomp$static$block$510831985$18(){f(this,"Mat3")}constructor(a,b,c,d,e,g,h,m,k){this.m11=a;this.m12=b;this.m13=
c;this.m21=d;this.m22=e;this.m23=g;this.m31=h;this.m32=m;this.m33=k}static fromMat2(a){return new Fb(a.a,a.b,0,a.c,a.d,0,0,0,1)}toMat2(){return new lc(this.m11,this.m12,this.m21,this.m22)}mul(a){return new Fb(this.m11*a.m11+this.m12*a.m21+this.m13*a.m31,this.m11*a.m12+this.m12*a.m22+this.m13*a.m32,this.m11*a.m13+this.m12*a.m23+this.m13*a.m33,this.m21*a.m11+this.m22*a.m21+this.m23*a.m31,this.m21*a.m12+this.m22*a.m22+this.m23*a.m32,this.m21*a.m13+this.m22*a.m23+this.m23*a.m33,this.m31*a.m11+this.m32*
a.m21+this.m33*a.m31,this.m31*a.m12+this.m32*a.m22+this.m33*a.m32,this.m31*a.m13+this.m32*a.m23+this.m33*a.m33)}get det(){return this.m11*this.m22*this.m33+this.m12*this.m23*this.m31+this.m13*this.m21*this.m32-this.m13*this.m22*this.m31-this.m12*this.m21*this.m33-this.m11*this.m23*this.m32}rotate(a){let b=Math.cos(a);a=Math.sin(a);let c=this.m11,d=this.m12;return this.m11=b*this.m11+a*this.m21,this.m12=b*this.m12+a*this.m22,this.m21=b*this.m21-a*c,this.m22=b*this.m22-a*d,this}scale(a,b){return this.m11*=
a,this.m12*=a,this.m21*=b,this.m22*=b,this}get inverse(){let a=this.det;return new Fb((this.m22*this.m33-this.m23*this.m32)/a,(this.m13*this.m32-this.m12*this.m33)/a,(this.m12*this.m23-this.m13*this.m22)/a,(this.m23*this.m31-this.m21*this.m33)/a,(this.m11*this.m33-this.m13*this.m31)/a,(this.m13*this.m21-this.m11*this.m23)/a,(this.m21*this.m32-this.m22*this.m31)/a,(this.m12*this.m31-this.m11*this.m32)/a,(this.m11*this.m22-this.m12*this.m21)/a)}get transpose(){return new Fb(this.m11,this.m21,this.m31,
this.m12,this.m22,this.m32,this.m13,this.m23,this.m33)}};Fb.$jscomp$static$block$510831985$18();var Ob=Fb,Sa=(()=>{const a=class{static $jscomp$static$block$510831985$19(){f(this,"Mat4")}constructor(b){this.m=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];b&&(this.m=b)}static translate(b){return new a([1,0,0,0,0,1,0,0,0,0,1,0,b.x,b.y,0,1])}static scale(b){return new a([b.x,0,0,0,0,b.y,0,0,0,0,1,0,0,0,0,1])}static rotateX(b){b=ca(-b);let c=Math.cos(b);b=Math.sin(b);return new a([1,0,0,0,0,c,-b,0,0,b,c,0,0,0,0,
1])}static rotateY(b){b=ca(-b);let c=Math.cos(b);b=Math.sin(b);return new a([c,0,b,0,0,1,0,0,-b,0,c,0,0,0,0,1])}static rotateZ(b){b=ca(-b);let c=Math.cos(b);b=Math.sin(b);return new a([c,-b,0,0,b,c,0,0,0,0,1,0,0,0,0,1])}translate(b){return this.m[12]+=this.m[0]*b.x+this.m[4]*b.y,this.m[13]+=this.m[1]*b.x+this.m[5]*b.y,this.m[14]+=this.m[2]*b.x+this.m[6]*b.y,this.m[15]+=this.m[3]*b.x+this.m[7]*b.y,this}scale(b){return this.m[0]*=b.x,this.m[4]*=b.y,this.m[1]*=b.x,this.m[5]*=b.y,this.m[2]*=b.x,this.m[6]*=
b.y,this.m[3]*=b.x,this.m[7]*=b.y,this}rotate(b){b=ca(-b);let c=Math.cos(b);b=Math.sin(b);let d=this.m[0],e=this.m[1],g=this.m[4],h=this.m[5];return this.m[0]=d*c+e*b,this.m[1]=-d*b+e*c,this.m[4]=g*c+h*b,this.m[5]=-g*b+h*c,this}mult(b){let c=[];for(let d=0;4>d;d++)for(let e=0;4>e;e++)c[4*d+e]=this.m[0+e]*b.m[4*d]+this.m[4+e]*b.m[4*d+1]+this.m[8+e]*b.m[4*d+2]+this.m[12+e]*b.m[4*d+3];return new a(c)}multVec2(b){return new C(b.x*this.m[0]+b.y*this.m[4]+this.m[12],b.x*this.m[1]+b.y*this.m[5]+this.m[13])}getTranslation(){return new C(this.m[12],
this.m[13])}getScale(){if(0!=this.m[0]||0!=this.m[1]){var b=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return new C(b,(this.m[0]*this.m[5]-this.m[1]*this.m[4])/b)}return 0!=this.m[4]||0!=this.m[5]?(b=Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]),new C((this.m[0]*this.m[5]-this.m[1]*this.m[4])/b,b)):new C(0,0)}getRotation(){if(0!=this.m[0]||0!=this.m[1]){var b=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return Ba(0<this.m[1]?Math.acos(this.m[0]/b):-Math.acos(this.m[0]/b))}return 0!=
this.m[4]||0!=this.m[5]?(b=Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]),Ba(Math.PI/2-(0<this.m[5]?Math.acos(-this.m[4]/b):-Math.acos(this.m[4]/b)))):0}getSkew(){if(0!=this.m[0]||0!=this.m[1]){var b=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return new C(Math.atan(this.m[0]*this.m[4]+this.m[1]*this.m[5])/(b*b),0)}return 0!=this.m[4]||0!=this.m[5]?(b=Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]),new C(0,Math.atan(this.m[0]*this.m[4]+this.m[1]*this.m[5])/(b*b))):new C(0,0)}invert(){let b=
[];var c=this.m[10]*this.m[15]-this.m[14]*this.m[11],d=this.m[9]*this.m[15]-this.m[13]*this.m[11],e=this.m[9]*this.m[14]-this.m[13]*this.m[10];let g=this.m[8]*this.m[15]-this.m[12]*this.m[11],h=this.m[8]*this.m[14]-this.m[12]*this.m[10],m=this.m[8]*this.m[13]-this.m[12]*this.m[9],k=this.m[6]*this.m[15]-this.m[14]*this.m[7],p=this.m[5]*this.m[15]-this.m[13]*this.m[7],r=this.m[5]*this.m[14]-this.m[13]*this.m[6],B=this.m[4]*this.m[15]-this.m[12]*this.m[7],n=this.m[4]*this.m[14]-this.m[12]*this.m[6],
v=this.m[5]*this.m[15]-this.m[13]*this.m[7],u=this.m[4]*this.m[13]-this.m[12]*this.m[5],z=this.m[6]*this.m[11]-this.m[10]*this.m[7],D=this.m[5]*this.m[11]-this.m[9]*this.m[7],I=this.m[5]*this.m[10]-this.m[9]*this.m[6],J=this.m[4]*this.m[11]-this.m[8]*this.m[7],N=this.m[4]*this.m[10]-this.m[8]*this.m[6],H=this.m[4]*this.m[9]-this.m[8]*this.m[5];b[0]=this.m[5]*c-this.m[6]*d+this.m[7]*e;b[4]=-(this.m[4]*c-this.m[6]*g+this.m[7]*h);b[8]=this.m[4]*d-this.m[5]*g+this.m[7]*m;b[12]=-(this.m[4]*e-this.m[5]*
h+this.m[6]*m);b[1]=-(this.m[1]*c-this.m[2]*d+this.m[3]*e);b[5]=this.m[0]*c-this.m[2]*g+this.m[3]*h;b[9]=-(this.m[0]*d-this.m[1]*g+this.m[3]*m);b[13]=this.m[0]*e-this.m[1]*h+this.m[2]*m;b[2]=this.m[1]*k-this.m[2]*p+this.m[3]*r;b[6]=-(this.m[0]*k-this.m[2]*B+this.m[3]*n);b[10]=this.m[0]*v-this.m[1]*B+this.m[3]*u;b[14]=-(this.m[0]*r-this.m[1]*n+this.m[2]*u);b[3]=-(this.m[1]*z-this.m[2]*D+this.m[3]*I);b[7]=this.m[0]*z-this.m[2]*J+this.m[3]*N;b[11]=-(this.m[0]*D-this.m[1]*J+this.m[3]*H);b[15]=this.m[0]*
I-this.m[1]*N+this.m[2]*H;c=this.m[0]*b[0]+this.m[1]*b[4]+this.m[2]*b[8]+this.m[3]*b[12];for(d=0;4>d;d++)for(e=0;4>e;e++)b[4*d+e]*=1/c;return new a(b)}clone(){return new a([...this.m])}toString(){return this.m.toString()}};a.$jscomp$static$block$510831985$19();return a})();f(Vc,"wave");var ie=class{static $jscomp$static$block$510831985$20(){f(this,"RNG")}constructor(a){this.seed=a}gen(){return this.seed=(1103515245*this.seed+12345)%2147483648,this.seed/2147483648}genNumber(a,b){return a+this.gen()*
(b-a)}genVec2(a,b){return new C(this.genNumber(a.x,b.x),this.genNumber(a.y,b.y))}genColor(a,b){return new Y(this.genNumber(a.r,b.r),this.genNumber(a.g,b.g),this.genNumber(a.b,b.b))}genAny(...a){if(0===a.length)return this.gen();if(1===a.length){if("number"==typeof a[0])return this.genNumber(0,a[0]);if(a[0]instanceof C)return this.genVec2(y(0,0),a[0]);if(a[0]instanceof Y)return this.genColor(R(0,0,0),a[0])}else if(2===a.length){if("number"==typeof a[0]&&"number"==typeof a[1])return this.genNumber(a[0],
a[1]);if(a[0]instanceof C&&a[1]instanceof C)return this.genVec2(a[0],a[1]);if(a[0]instanceof Y&&a[1]instanceof Y)return this.genColor(a[0],a[1])}throw Error("More than 2 arguments not supported");}},Wc=new ie(Date.now());ie.$jscomp$static$block$510831985$20();f(oe,"randSeed");f(pa,"rand");f(Xc,"randi");f(pe,"chance");f(Yc,"shuffle");f(qe,"chooseMultiple");f(re,"choose");f(Zc,"testRectRect");f(se,"testLineLineT");f(fc,"testLineLine");f(gc,"testRectLine");f(Kb,"testRectPoint");f($c,"testRectCircle");
f(ad,"testRectPolygon");f(hc,"testLinePoint");f(tb,"testLineCircle");f(ic,"testLinePolygon");f(Lb,"testCirclePoint");f(te,"testCircleCircle");f(Mb,"testCirclePolygon");f(bd,"testPolygonPolygon");f(Va,"testPolygonPoint");f(jc,"testEllipsePoint");f(Nb,"testEllipseCircle");f(cd,"testEllipseLine");f(ue,"testEllipseEllipse");f(dd,"testEllipseRect");f(kc,"testEllipsePolygon");f(ve,"testPointPoint");f(we,"testPointShape");f(xe,"testLineShape");f(ye,"testCircleShape");f(ze,"testRectShape");f(Ae,"testPolygonShape");
f(Be,"testEllipseShape");f(ed,"raycastLine");f(Ce,"raycastRect");f(fd,"raycastCircle");f(De,"raycastPolygon");f(Ee,"raycastEllipse");f(Fe,"raycastGrid");const Kc=class{static $jscomp$static$block$510831985$21(){f(this,"Point")}constructor(a){this.pt=a.clone()}transform(a){return new Kc(a.multVec2(this.pt))}bbox(){return new ka(this.pt,0,0)}area(){return 0}clone(){return new Kc(this.pt)}collides(a){return we(this,a)}contains(a){return this.pt.eq(a)}raycast(a,b){return null}random(){return this.pt.clone()}};
Kc.$jscomp$static$block$510831985$21();var oi=Kc,Ca=(()=>{const a=class{static $jscomp$static$block$510831985$22(){f(this,"Line")}constructor(b,c){this.p1=b.clone();this.p2=c.clone()}transform(b){return new a(b.multVec2(this.p1),b.multVec2(this.p2))}bbox(){return ka.fromPoints(this.p1,this.p2)}area(){return this.p1.dist(this.p2)}clone(){return new a(this.p1,this.p2)}collides(b){return xe(this,b)}contains(b){return this.collides(b)}raycast(b,c){return ed(b,c,this)}random(){return this.p1.add(this.p2.sub(this.p1).scale(pa(1)))}};
a.$jscomp$static$block$510831985$22();return a})(),ka=(()=>{const a=class{static $jscomp$static$block$510831985$23(){f(this,"Rect")}constructor(b,c,d){this.pos=b.clone();this.width=c;this.height=d}static fromPoints(b,c){return new a(b.clone(),c.x-b.x,c.y-b.y)}center(){return new C(this.pos.x+this.width/2,this.pos.y+this.height/2)}points(){return[this.pos,this.pos.add(this.width,0),this.pos.add(this.width,this.height),this.pos.add(0,this.height)]}transform(b){return new xa(this.points().map(c=>b.multVec2(c)))}bbox(){return this.clone()}area(){return this.width*
this.height}clone(){return new a(this.pos.clone(),this.width,this.height)}distToPoint(b){return Math.sqrt(this.sdistToPoint(b))}sdistToPoint(b){let c=this.pos,d=this.pos.add(this.width,this.height),e=Math.max(c.x-b.x,0,b.x-d.x);b=Math.max(c.y-b.y,0,b.y-d.y);return e*e+b*b}collides(b){return ze(this,b)}contains(b){return this.collides(b)}raycast(b,c){return Ce(b,c,this)}random(){return this.pos.add(pa(this.width),pa(this.height))}};a.$jscomp$static$block$510831985$23();return a})(),Da=(()=>{const a=
class{static $jscomp$static$block$510831985$24(){f(this,"Circle")}constructor(b,c){this.center=b.clone();this.radius=c}transform(b){return(new Wa(this.center,this.radius,this.radius)).transform(b)}bbox(){return ka.fromPoints(this.center.sub(y(this.radius)),this.center.add(y(this.radius)))}area(){return this.radius*this.radius*Math.PI}clone(){return new a(this.center,this.radius)}collides(b){return ye(this,b)}contains(b){return this.collides(b)}raycast(b,c){return fd(b,c,this)}random(){return this.center.add(C.fromAngle(pa(360)).scale(pa(this.radius)))}};
a.$jscomp$static$block$510831985$24();return a})(),Wa=(()=>{const a=class{static $jscomp$static$block$510831985$25(){f(this,"Ellipse")}constructor(b,c,d,e=0){this.center=b.clone();this.radiusX=c;this.radiusY=d;this.angle=e}static fromMat2(b){b=b.inverse;b=b.transpose.mul(b);let [c,d]=b.eigenvalues,[e,g]=b.eigenvectors(c,d),[h,m]=[1/Math.sqrt(c),1/Math.sqrt(d)];return h>m?new a(y(),h,m,Ba(Math.atan2(-e[1],e[0]))):new a(y(),m,h,Ba(Math.atan2(-g[1],g[0])))}toMat2(){var b=ca(this.angle);let c=Math.cos(b);
b=Math.sin(b);return new lc(c*this.radiusX,-b*this.radiusY,b*this.radiusX,c*this.radiusY)}transform(b){if(0==this.angle&&0==b.getRotation())return new a(b.multVec2(this.center),b.m[0]*this.radiusX,b.m[5]*this.radiusY);var c=this.toMat2();let d=b.getRotation(),e=b.getScale();c=Ob.fromMat2(c).scale(e.x,e.y).rotate(d).toMat2();c=a.fromMat2(c);return c.center=b.multVec2(this.center),c}bbox(){if(0==this.angle)return ka.fromPoints(this.center.sub(y(this.radiusX,this.radiusY)),this.center.add(y(this.radiusX,
this.radiusY)));var b=ca(this.angle),c=Math.cos(b),d=Math.sin(b),e=this.radiusX*c;b=this.radiusX*d;d*=this.radiusY;c*=this.radiusY;e=Math.sqrt(e*e+d*d);b=Math.sqrt(b*b+c*c);return ka.fromPoints(this.center.sub(y(e,b)),this.center.add(y(e,b)))}area(){return this.radiusX*this.radiusY*Math.PI}clone(){return new a(this.center,this.radiusX,this.radiusY,this.angle)}collides(b){return Be(this,b)}contains(b){b=b.sub(this.center);var c=ca(this.angle);let d=Math.cos(c),e=Math.sin(c);c=b.x*d+b.y*e;b=-b.x*e+
b.y*d;return 1>c*c/(this.radiusX*this.radiusX)+b*b/(this.radiusY*this.radiusY)}raycast(b,c){return Ee(b,c,this)}random(){return this.center}};a.$jscomp$static$block$510831985$25();return a})();f(Ge,"segmentLineIntersection");const Gb=class{static $jscomp$static$block$510831985$26(){f(this,"Polygon")}constructor(a){if(3>a.length)throw Error("Polygons should have at least 3 vertices");this.pts=a}transform(a){return new Gb(this.pts.map(b=>a.multVec2(b)))}bbox(){let a=y(Number.MAX_VALUE),b=y(-Number.MAX_VALUE);
for(let c of this.pts)a.x=Math.min(a.x,c.x),b.x=Math.max(b.x,c.x),a.y=Math.min(a.y,c.y),b.y=Math.max(b.y,c.y);return ka.fromPoints(a,b)}area(){let a=0,b=this.pts.length;for(let c=0;c<b;c++){let d=this.pts[c],e=this.pts[(c+1)%b];a+=d.x*e.y*.5;a-=e.x*d.y*.5}return Math.abs(a)}clone(){return new Gb(this.pts.map(a=>a.clone()))}collides(a){return Ae(this,a)}contains(a){return this.collides(a)}raycast(a,b){return De(a,b,this)}random(){return y()}cut(a,b){new Ca(a,b);let c=[],d=[],e=b.sub(a),g=this.pts[this.pts.length-
1],h=g.sub(a),m=0<e.cross(h);return this.pts.forEach(k=>{h=k.sub(a);let p=0<e.cross(h);if(m!=p){let r=Ge(g,k,a,b);c.push(r);d.push(r);m=p}(p?c:d).push(k);g=k}),[c.length?new Gb(c):null,d.length?new Gb(d):null]}};Gb.$jscomp$static$block$510831985$26();var xa=Gb;f(He,"evaluateQuadratic");f(Ie,"evaluateQuadraticFirstDerivative");f(Je,"evaluateQuadraticSecondDerivative");f(mc,"evaluateBezier");f(Ke,"evaluateBezierFirstDerivative");f(Le,"evaluateBezierSecondDerivative");f(Me,"evaluateCatmullRom");f(Ne,
"evaluateCatmullRomFirstDerivative");f(Oe,"normalizedCurve");f(gd,"curveLengthApproximation");f(ub,"hermite");f(hd,"cardinal");f(Pb,"catmullRom");f(Pe,"bezier");f(Qe,"kochanekBartels");f(Re,"hermiteFirstDerivative");f(vb,"inZeroOneDomain");f(nc,"approximately");f(wb,"cubeRoot");f(Se,"getCubicRoots");f(Te,"cubicBezierYforX");f(Ue,"easingLinear");f(Ve,"easingCubicBezier");f(We,"easingSteps");f(Xe,"sat");f(id,"isOrientedCcw");f(Ye,"isOrientedCcwPolygon");f(oc,"onSameSide");f(Ze,"pointInTriangle");f($e,
"someInTriangle");f(af,"isEar");f(jd,"triangulate");f(bf,"isConvex");var xd=[{name:"a_pos",size:2},{name:"a_uv",size:2},{name:"a_color",size:4}],pi=8192*xd.reduce((a,b)=>a+b.size,0),fi=new Set(["id","require"]),gi=new Set("add fixedUpdate update draw destroy inspect drawInspect".split(" ")),Bh=Symbol.for("kaplay.cancel"),Pd=class extends Map{constructor(){super(...arguments);this.lastID=0}static $jscomp$static$block$510831985$27(){f(this,"Registry")}push(a){let b=this.lastID;return this.set(b,a),
this.lastID++,b}pushd(a){let b=this.push(a);return()=>this.delete(b)}},ob=(()=>{const a=class{static $jscomp$static$block$510831985$28(){f(this,"KEventController")}constructor(b){this.paused=!1;this.cancel=b}static join(b){let c=new a(()=>b.forEach(d=>d.cancel()));return Object.defineProperty(c,"paused",{get:f(()=>b[0].paused,"get"),set:f(d=>b.forEach(e=>e.paused=d),"set")}),c.paused=!1,c}static replace(b,c){return b.cancel=()=>c.cancel(),c.paused=b.paused,Object.defineProperty(b,"paused",{get:f(()=>
c.paused,"get"),set:f(d=>c.paused=d,"set")}),b}};a.$jscomp$static$block$510831985$28();return a})(),ua=class{constructor(){this.cancellers=new WeakMap;this.handlers=new Pd}static $jscomp$static$block$510831985$29(){f(this,"KEvent")}add(a){function b(...e){if(!d.paused)return a(...e)}f(b,"handler");let c=this.handlers.pushd(b),d=new ob(c);return this.cancellers.set(b,c),d}addOnce(a){let b=this.add((...c)=>{b.cancel();a(...c)});return b}next(){return new Promise(a=>this.addOnce(a))}trigger(...a){this.handlers.forEach(b=>
{let c;b(...a)===Bh&&(c=this.cancellers.get(b))&&c()})}numListeners(){return this.handlers.size}clear(){this.handlers.clear()}},Db=class{constructor(){this.handlers={};this.registers={}}static $jscomp$static$block$510831985$30(){f(this,"KEventHandler")}on(a,b){return this.handlers[a]||(this.handlers[a]=new ua),this.handlers[a].add(b)}onOnce(a,b){let c=this.on(a,(...d)=>{c.cancel();b(...d)});return c}next(a){return new Promise(b=>{this.onOnce(a,(...c)=>b(c[0]))})}trigger(a,...b){this.handlers[a]&&
this.handlers[a].trigger(...b)}remove(a){delete this.handlers[a]}clear(){this.handlers={}}numListeners(a){return this.handlers[a]?.numListeners()??0}};Db.$jscomp$static$block$510831985$30();ua.$jscomp$static$block$510831985$29();Pd.$jscomp$static$block$510831985$27();var qi=f(a=>a[0]instanceof Y,"arrayIsColor"),ri=f(a=>a[0]instanceof C,"arrayIsVec2"),si=f(a=>"number"==typeof a[0],"arrayIsNumber"),nd=class{static $jscomp$static$block$510831985$31(){f(this,"BinaryHeap")}constructor(a=(b,c)=>b<c){this._compareFn=
a;this._items=[]}insert(a){this._items.push(a);this.moveUp(this._items.length-1)}remove(){if(0===this._items.length)return null;let a=this._items[0],b=this._items.pop();return 0!==this._items.length&&(this._items[0]=b,this.moveDown(0)),a}clear(){this._items.splice(0,this._items.length)}moveUp(a){for(;0<a;){let b=Math.floor((a-1)/2);if(!this._compareFn(this._items[a],this._items[b])&&this._items[a]>=this._items[b])break;this.swap(a,b);a=b}}moveDown(a){for(;a<Math.floor(this._items.length/2);){let b=
2*a+1;if(b<this._items.length-1&&!this._compareFn(this._items[b],this._items[b+1])&&++b,this._compareFn(this._items[a],this._items[b]))break;this.swap(a,b);a=b}}swap(a,b){[this._items[a],this._items[b]]=[this._items[b],this._items[a]]}get length(){return this._items.length}};nd.$jscomp$static$block$510831985$31();f(cf,"base64ToArrayBuffer");f(df,"dataURLToArrayBuffer");f(pc,"download");f(kd,"downloadText");f(ef,"downloadJSON");f(ld,"downloadBlob");var Cf=f(a=>a.match(/^data:\w+\/\w+;base64,.+/),"isDataURL"),
ci=f(a=>a.split(".").slice(0,-1).join("."),"getFileName");f(qc,"deepEq");var gf=new Set,di=f(a=>a instanceof Error?a.message:String(a),"getErrorMessage");f(ff,"warn");f(kb,"deprecateMsg");f(rc,"toFixed");f(ja,"overload2");var Th=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);f(hf,"runes");f(jf,"nextUnits");f(of,"isFirstOfSurrogatePair");f(md,"isRegionalIndicator");f(pf,"isSubdivisionFlag");f(rf,"isFitzpatrickModifier");f(lf,"isVariationSelector");f(mf,"isDiacriticalMark");
f(qf,"isSupplementarySpecialpurposePlane");f(kf,"isGrapheme");f(nf,"isZeroWidthJoiner");f(sc,"codePointFromSurrogatePair");f(bb,"betweenInclusive");var Ma=f((a,b)=>Array.isArray(a)?a?.includes(b):a===b,"isEqOrIncludes"),Ta=f((a,b)=>Array.isArray(b)?b.some(c=>a.has(c)):a.has(b),"setHasOrIncludes"),Lc=f((a,b,c)=>{a.has(b)?a.get(b)?.push(c):a.set(b,[c])},"mapAddOrPush"),ei=(()=>{let a=0;return()=>a++})(),ti=f(()=>qb.lastInputDevice,"getLastInputDeviceType"),ui=f(()=>{let a=qb.buttons;for(let b in a){let c=
a[b].keyboard&&[a[b].keyboard].flat(),d=a[b].keyboardCode&&[a[b].keyboardCode].flat(),e=a[b].gamepad&&[a[b].gamepad].flat(),g=a[b].mouse&&[a[b].mouse].flat();c&&c.forEach(h=>{Lc(qb.buttonsByKey,h,b)});d&&d.forEach(h=>{Lc(qb.buttonsByKeyCode,h,b)});e&&e.forEach(h=>{Lc(qb.buttonsByGamepad,h,b)});g&&g.forEach(h=>{Lc(qb.buttonsByMouse,h,b)})}},"parseButtonBindings"),Hb=class{constructor(){this.pressed=new Set([]);this.pressedRepeat=new Set([]);this.released=new Set([]);this.down=new Set([])}static $jscomp$static$block$510831985$32(){f(this,
"ButtonState")}update(){this.pressed.clear();this.released.clear();this.pressedRepeat.clear()}press(a){this.pressed.add(a);this.pressedRepeat.add(a);this.down.add(a)}pressRepeat(a){this.pressedRepeat.add(a)}release(a){this.down.delete(a);this.pressed.delete(a);this.released.add(a)}},Ch=class{constructor(){this.buttonState=new Hb;this.stickState=new Map}static $jscomp$static$block$510831985$33(){f(this,"GamepadState")}},Dh=class{constructor(){this.dts=[];this.fps=this.timer=0}static $jscomp$static$block$510831985$34(){f(this,
"FPSCounter")}tick(a){this.dts.push(a);this.timer+=a;1<=this.timer&&(this.timer=0,this.fps=Math.round(1/(this.dts.reduce((b,c)=>b+c)/this.dts.length)),this.dts=[])}},qb,Eh={"Joy-Con L+R (STANDARD GAMEPAD Vendor: 057e Product: 200e)":{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",6:"ltrigger",7:"rtrigger",8:"select",9:"start",10:"lstick",11:"rstick",12:"dpad-up",13:"dpad-down",14:"dpad-left",15:"dpad-right",16:"home",17:"capture"},sticks:{left:{x:0,y:1},right:{x:2,y:3}}},
"Joy-Con (L) (STANDARD GAMEPAD Vendor: 057e Product: 2006)":{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",9:"select",10:"lstick",16:"start"},sticks:{left:{x:0,y:1}}},"Joy-Con (R) (STANDARD GAMEPAD Vendor: 057e Product: 2007)":{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",9:"start",10:"lstick",16:"select"},sticks:{left:{x:0,y:1}}},"Pro Controller (STANDARD GAMEPAD Vendor: 057e Product: 2009)":{buttons:{0:"south",1:"east",2:"west",3:"north",
4:"lshoulder",5:"rshoulder",6:"ltrigger",7:"rtrigger",8:"select",9:"start",10:"lstick",11:"rstick",12:"dpad-up",13:"dpad-down",14:"dpad-left",15:"dpad-right",16:"home",17:"capture"},sticks:{left:{x:0,y:1},right:{x:2,y:3}}},default:{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",6:"ltrigger",7:"rtrigger",8:"select",9:"start",10:"lstick",11:"rstick",12:"dpad-up",13:"dpad-down",14:"dpad-left",15:"dpad-right",16:"home"},sticks:{left:{x:0,y:1},right:{x:2,y:3}}}},vi=f(a=>({canvas:a.canvas,
buttons:a.buttons??{},buttonsByKey:new Map,buttonsByMouse:new Map,buttonsByGamepad:new Map,buttonsByKeyCode:new Map,loopID:null,stopped:!1,dt:0,fixedDt:.02,restDt:0,time:0,realTime:0,fpsCounter:new Dh,timeScale:1,skipTime:!1,isHidden:!1,numFrames:0,mousePos:new C(0),mouseDeltaPos:new C(0),keyState:new Hb,mouseState:new Hb,mergedGamepadState:new Ch,gamepadStates:new Map,lastInputDevice:null,buttonState:new Hb,gamepads:[],charInputted:[],isMouseMoved:!1,lastWidth:a.canvas.offsetWidth,lastHeight:a.canvas.offsetHeight,
events:new Db}),"initAppState"),Ki=f(a=>{function b(){return q.dt*q.timeScale}function c(){return q.fixedDt*q.timeScale}function d(){return q.restDt*q.timeScale}function e(){return q.isHidden}function g(){return q.time}function h(){return q.fpsCounter.fps}function m(){return q.numFrames}function k(){return q.canvas.toDataURL()}function p(t){q.canvas.style.cursor=t}function r(){return q.canvas.style.cursor}function B(t){if(t)try{let A=q.canvas.requestPointerLock();A.catch&&A.catch(F=>console.error(F))}catch(A){console.error(A)}else document.exitPointerLock()}
function n(){return!!document.pointerLockElement}function v(t){t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}function u(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullScreen&&document.webkitExitFullScreen()}function z(t=!0){t?v(q.canvas):u()}function D(){return document.fullscreenElement===q.canvas||document.webkitFullscreenElement===q.canvas}function I(){q.stopped=!0;let t=Object.entries(Ia),A=Object.entries(je),F=Object.entries(Mc);
for(let [M,ia]of t)q.canvas.removeEventListener(M,ia);for(let [M,ia]of A)document.removeEventListener(M,ia);for(let [M,ia]of F)window.removeEventListener(M,ia);Fh.disconnect()}function J(t,A){null!==q.loopID&&cancelAnimationFrame(q.loopID);let F=0,M=0,ia=f(da=>{if(!q.stopped){if("visible"===document.visibilityState){da/=1E3;var Pa=Math.min(da-q.realTime,.25),Nc=a.maxFPS?1/a.maxFPS:0;if(q.realTime=da,M+=Pa,M>Nc){if(!q.skipTime){F+=M;q.dt=q.fixedDt;for(q.restDt=0;F>q.fixedDt;)F-=q.fixedDt,F<q.fixedDt&&
(q.restDt=F),t();q.restDt=F;q.dt=M;q.time+=b();q.fpsCounter.tick(q.dt)}M=0;q.skipTime=!1;q.numFrames++;A($a,Gh)}}q.loopID=requestAnimationFrame(ia)}},"frame");ia(0)}function N(){return"ontouchstart"in window||0<navigator.maxTouchPoints}function H(){return q.mousePos.clone()}function x(){return q.mouseDeltaPos.clone()}function w(t="left"){return q.mouseState.pressed.has(t)}function E(t="left"){return q.mouseState.down.has(t)}function G(t="left"){return q.mouseState.released.has(t)}function Q(){return q.isMouseMoved}
function L(t){return void 0===t?0<q.keyState.pressed.size:Ta(q.keyState.pressed,t)}function K(t){return void 0===t?0<q.keyState.pressedRepeat.size:Ta(q.keyState.pressedRepeat,t)}function W(t){return void 0===t?0<q.keyState.down.size:Ta(q.keyState.down,t)}function fa(t){return void 0===t?0<q.keyState.released.size:Ta(q.keyState.released,t)}function ra(t){return void 0===t?0<q.mergedGamepadState.buttonState.pressed.size:Ta(q.mergedGamepadState.buttonState.pressed,t)}function va(t){return void 0===t?
0<q.mergedGamepadState.buttonState.down.size:Ta(q.mergedGamepadState.buttonState.down,t)}function oa(t){return void 0===t?0<q.mergedGamepadState.buttonState.released.size:Ta(q.mergedGamepadState.buttonState.released,t)}function T(t){return void 0===t?0<q.buttonState.pressed.size:Ta(q.buttonState.pressed,t)}function Oc(t){return void 0===t?0<q.buttonState.down.size:Ta(q.buttonState.down,t)}function Pc(t){return void 0===t?0<q.buttonState.released.size:Ta(q.buttonState.released,t)}function Qc(t){return q.buttons?.[t]}
function Ib(t,A){q.buttons[t]={...q.buttons[t],...A}}function rb(t){q.buttonState.press(t);q.events.trigger("buttonPress",t)}function Qa(t){q.buttonState.release(t);q.events.trigger("buttonRelease",t)}function O(t){return q.events.on("resize",t)}function S(t){return q.events.on("mouseMove",()=>t(H(),x()))}function U(t){return q.events.on("charInput",t)}function ea(t){return q.events.on("touchStart",t)}function Ja(t){return q.events.on("touchMove",t)}function aa(t){return q.events.on("touchEnd",t)}
function Ka(t){return q.events.on("scroll",t)}function Ra(t){return q.events.on("hide",t)}function Ua(t){return q.events.on("show",t)}function Rc(t,A){return q.events.on("gamepadStick",(F,M,ia)=>F===t&&A(M,ia))}function Sc(t){q.events.on("gamepadConnect",t)}function bc(t){q.events.on("gamepadDisconnect",t)}function ab(t){return q.mergedGamepadState.stickState.get(t)||new C(0)}function cc(){return[...q.charInputted]}function Aa(){return[...q.gamepads]}function $a(){q.events.trigger("input");q.keyState.down.forEach(t=>
q.events.trigger("keyDown",t));q.mouseState.down.forEach(t=>q.events.trigger("mouseDown",t));q.buttonState.down.forEach(t=>{q.events.trigger("buttonDown",t)});Hh()}function Gh(){q.keyState.update();q.mouseState.update();q.buttonState.update();q.mergedGamepadState.buttonState.update();q.mergedGamepadState.stickState.forEach((t,A)=>{q.mergedGamepadState.stickState.set(A,new C(0))});q.charInputted=[];q.isMouseMoved=!1;q.mouseDeltaPos=new C(0);q.gamepadStates.forEach(t=>{t.buttonState.update();t.stickState.forEach((A,
F)=>{t.stickState.set(F,new C(0))})})}function ke(t){let A={index:t.index,isPressed:f(F=>q.gamepadStates.get(t.index)?.buttonState.pressed.has(F)||!1,"isPressed"),isDown:f(F=>q.gamepadStates.get(t.index)?.buttonState.down.has(F)||!1,"isDown"),isReleased:f(F=>q.gamepadStates.get(t.index)?.buttonState.released.has(F)||!1,"isReleased"),getStick:f(F=>q.gamepadStates.get(t.index)?.stickState.get(F)||y(),"getStick")};return q.gamepads.push(A),q.gamepadStates.set(t.index,{buttonState:new Hb,stickState:new Map([["left",
new C(0)],["right",new C(0)]])}),A}function Ih(t){q.gamepads=q.gamepads.filter(A=>A.index!==t.index);q.gamepadStates.delete(t.index)}function Hh(){for(var t of navigator.getGamepads())t&&!q.gamepadStates.has(t.index)&&ke(t);for(let F of q.gamepads){t=navigator.getGamepads()[F.index];if(!t)continue;let M=(a.gamepads??{})[t.id]||Eh[t.id]||Eh.default,ia=q.gamepadStates.get(F.index);if(ia){for(var A=0;A<t.buttons.length;A++){let da=M.buttons[A],Pa=t.buttons[A],Nc=q.buttonsByGamepad.has(da);Pa.pressed?
ia.buttonState.down.has(da)?q.events.trigger("gamepadButtonDown",da,F):(q.lastInputDevice="gamepad",Nc&&q.buttonsByGamepad.get(da)?.forEach(dc=>{q.buttonState.press(dc);q.events.trigger("buttonPress",dc)}),q.mergedGamepadState.buttonState.press(da),ia.buttonState.press(da),q.events.trigger("gamepadButtonPress",da,F)):ia.buttonState.down.has(da)&&(Nc&&q.buttonsByGamepad.get(da)?.forEach(dc=>{q.buttonState.release(dc);q.events.trigger("buttonRelease",dc)}),q.mergedGamepadState.buttonState.release(da),
ia.buttonState.release(da),q.events.trigger("gamepadButtonRelease",da,F))}for(let da in M.sticks)if(A=M.sticks[da])A=new C(t.axes[A.x],t.axes[A.y]),ia.stickState.set(da,A),q.mergedGamepadState.stickState.set(da,A),q.events.trigger("gamepadStick",da,A,F)}}}if(!a.canvas)throw Error("Please provide a canvas");let q=vi(a);qb=q;ui();f(b,"dt");f(c,"fixedDt");f(d,"restDt");f(e,"isHidden");f(g,"time");f(h,"fps");f(m,"numFrames");f(k,"screenshot");f(p,"setCursor");f(r,"getCursor");f(B,"setCursorLocked");f(n,
"isCursorLocked");f(v,"enterFullscreen");f(u,"exitFullscreen");f(z,"setFullscreen");f(D,"isFullscreen");f(I,"quit");f(J,"run");f(N,"isTouchscreen");f(H,"mousePos");f(x,"mouseDeltaPos");f(w,"isMousePressed");f(E,"isMouseDown");f(G,"isMouseReleased");f(Q,"isMouseMoved");f(L,"isKeyPressed");f(K,"isKeyPressedRepeat");f(W,"isKeyDown");f(fa,"isKeyReleased");f(ra,"isGamepadButtonPressed");f(va,"isGamepadButtonDown");f(oa,"isGamepadButtonReleased");f(T,"isButtonPressed");f(Oc,"isButtonDown");f(Pc,"isButtonReleased");
f(Qc,"getButton");f(Ib,"setButton");f(rb,"pressButton");f(Qa,"releaseButton");f(O,"onResize");let wi=ja(t=>q.events.on("keyDown",t),(t,A)=>q.events.on("keyDown",F=>Ma(t,F)&&A(F))),xi=ja(t=>q.events.on("keyPress",A=>t(A)),(t,A)=>q.events.on("keyPress",F=>Ma(t,F)&&A(F))),yi=ja(t=>q.events.on("keyPressRepeat",t),(t,A)=>q.events.on("keyPressRepeat",F=>Ma(t,F)&&A(F))),zi=ja(t=>q.events.on("keyRelease",t),(t,A)=>q.events.on("keyRelease",F=>Ma(t,F)&&A(F))),Ai=ja(t=>q.events.on("mouseDown",A=>t(A)),(t,A)=>
q.events.on("mouseDown",F=>Ma(t,F)&&A(F))),Bi=ja(t=>q.events.on("mousePress",A=>t(A)),(t,A)=>q.events.on("mousePress",F=>Ma(t,F)&&A(F))),Ci=ja(t=>q.events.on("mouseRelease",A=>t(A)),(t,A)=>q.events.on("mouseRelease",F=>F===t&&A(F)));f(S,"onMouseMove");f(U,"onCharInput");f(ea,"onTouchStart");f(Ja,"onTouchMove");f(aa,"onTouchEnd");f(Ka,"onScroll");f(Ra,"onHide");f(Ua,"onShow");let Di=ja(t=>q.events.on("gamepadButtonPress",(A,F)=>t(A,F)),(t,A)=>q.events.on("gamepadButtonPress",(F,M)=>Ma(t,F)&&A(F,M))),
Ei=ja(t=>q.events.on("gamepadButtonDown",(A,F)=>t(A,F)),(t,A)=>q.events.on("gamepadButtonDown",(F,M)=>Ma(t,F)&&A(F,M))),Fi=ja(t=>q.events.on("gamepadButtonRelease",(A,F)=>t(A,F)),(t,A)=>q.events.on("gamepadButtonRelease",(F,M)=>Ma(t,F)&&A(F,M)));f(Rc,"onGamepadStick");f(Sc,"onGamepadConnect");f(bc,"onGamepadDisconnect");f(ab,"getGamepadStick");f(cc,"charInputted");f(Aa,"getGamepads");let Gi=ja(t=>q.events.on("buttonPress",A=>t(A)),(t,A)=>q.events.on("buttonPress",F=>Ma(t,F)&&A(F))),Hi=ja(t=>q.events.on("buttonDown",
A=>t(A)),(t,A)=>q.events.on("buttonDown",F=>Ma(t,F)&&A(F))),Ii=ja(t=>q.events.on("buttonRelease",A=>t(A)),(t,A)=>q.events.on("buttonRelease",F=>Ma(t,F)&&A(F)));f($a,"processInput");f(Gh,"resetInput");f(ke,"registerGamepad");f(Ih,"removeGamepad");f(Hh,"processGamepad");let Ia={},je={},Mc={},Jh=a.pixelDensity||1;Ia.mousemove=t=>{let A=new C(t.offsetX,t.offsetY),F=new C(t.movementX,t.movementY);if(D()){let da=q.canvas.width/Jh,Pa=q.canvas.height/Jh;var M=window.innerWidth,ia=window.innerHeight;M/ia>
da/Pa?(ia/=Pa,A.x=Oa(t.offsetX-(M-da*ia)/2,0,da*ia,0,da),A.y=Oa(t.offsetY,0,Pa*ia,0,Pa)):(M/=da,ia=(ia-Pa*M)/2,A.x=Oa(t.offsetX,0,da*M,0,da),A.y=Oa(t.offsetY-ia,0,Pa*M,0,Pa))}q.events.onOnce("input",()=>{q.isMouseMoved=!0;q.mousePos=A;q.mouseDeltaPos=F;q.events.trigger("mouseMove")})};let Kh=["left","middle","right","back","forward"];Ia.mousedown=t=>{q.events.onOnce("input",()=>{let A=Kh[t.button];A&&(q.lastInputDevice="mouse",q.buttonsByMouse.has(A)&&q.buttonsByMouse.get(A)?.forEach(F=>{q.buttonState.press(F);
q.events.trigger("buttonPress",F)}),q.mouseState.press(A),q.events.trigger("mousePress",A))})};Ia.mouseup=t=>{q.events.onOnce("input",()=>{let A=Kh[t.button];A&&(q.buttonsByMouse.has(A)&&q.buttonsByMouse.get(A)?.forEach(F=>{q.buttonState.release(F);q.events.trigger("buttonRelease",F)}),q.mouseState.release(A),q.events.trigger("mouseRelease",A))})};let Ji=new Set(" ;ArrowLeft;ArrowRight;ArrowUp;ArrowDown;Tab".split(";")),Lh={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down"," ":"space"};
Ia.keydown=t=>{Ji.has(t.key)&&t.preventDefault();q.events.onOnce("input",()=>{let A=Lh[t.key]||t.key.toLowerCase(),F=t.code;if(void 0===A)throw Error(`Unknown key: ${t.key}`);1===A.length?(q.events.trigger("charInput",A),q.charInputted.push(A)):"space"===A&&(q.events.trigger("charInput"," "),q.charInputted.push(" "));t.repeat?(q.keyState.pressRepeat(A),q.events.trigger("keyPressRepeat",A)):(q.lastInputDevice="keyboard",q.buttonsByKey.has(A)&&q.buttonsByKey.get(A)?.forEach(M=>{q.buttonState.press(M);
q.events.trigger("buttonPress",M)}),q.buttonsByKeyCode.has(F)&&q.buttonsByKeyCode.get(F)?.forEach(M=>{q.buttonState.press(M);q.events.trigger("buttonPress",M)}),q.keyState.press(A),q.events.trigger("keyPressRepeat",A),q.events.trigger("keyPress",A))})};Ia.keyup=t=>{q.events.onOnce("input",()=>{let A=Lh[t.key]||t.key.toLowerCase(),F=t.code;q.buttonsByKey.has(A)&&q.buttonsByKey.get(A)?.forEach(M=>{q.buttonState.release(M);q.events.trigger("buttonRelease",M)});q.buttonsByKeyCode.has(F)&&q.buttonsByKeyCode.get(F)?.forEach(M=>
{q.buttonState.release(M);q.events.trigger("buttonRelease",M)});q.keyState.release(A);q.events.trigger("keyRelease",A)})};Ia.touchstart=t=>{t.preventDefault();q.events.onOnce("input",()=>{let A=[...t.changedTouches],F=q.canvas.getBoundingClientRect();!1!==a.touchToMouse&&(q.mousePos=new C(A[0].clientX-F.x,A[0].clientY-F.y),q.lastInputDevice="mouse",q.buttonsByMouse.has("left")&&q.buttonsByMouse.get("left")?.forEach(M=>{q.buttonState.press(M);q.events.trigger("buttonPress",M)}),q.mouseState.press("left"),
q.events.trigger("mousePress","left"));A.forEach(M=>{q.events.trigger("touchStart",new C(M.clientX-F.x,M.clientY-F.y),M)})})};Ia.touchmove=t=>{t.preventDefault();q.events.onOnce("input",()=>{let A=[...t.changedTouches],F=q.canvas.getBoundingClientRect();if(!1!==a.touchToMouse){let M=q.mousePos;q.mousePos=new C(A[0].clientX-F.x,A[0].clientY-F.y);q.mouseDeltaPos=q.mousePos.sub(M);q.events.trigger("mouseMove")}A.forEach(M=>{q.events.trigger("touchMove",new C(M.clientX-F.x,M.clientY-F.y),M)})})};Ia.touchend=
t=>{q.events.onOnce("input",()=>{let A=[...t.changedTouches],F=q.canvas.getBoundingClientRect();!1!==a.touchToMouse&&(q.mousePos=new C(A[0].clientX-F.x,A[0].clientY-F.y),q.mouseDeltaPos=new C(0,0),q.buttonsByMouse.has("left")&&q.buttonsByMouse.get("left")?.forEach(M=>{q.buttonState.release(M);q.events.trigger("buttonRelease",M)}),q.mouseState.release("left"),q.events.trigger("mouseRelease","left"));A.forEach(M=>{q.events.trigger("touchEnd",new C(M.clientX-F.x,M.clientY-F.y),M)})})};Ia.touchcancel=
t=>{q.events.onOnce("input",()=>{let A=[...t.changedTouches],F=q.canvas.getBoundingClientRect();!1!==a.touchToMouse&&(q.mousePos=new C(A[0].clientX-F.x,A[0].clientY-F.y),q.mouseState.release("left"),q.events.trigger("mouseRelease","left"));A.forEach(M=>{q.events.trigger("touchEnd",new C(M.clientX-F.x,M.clientY-F.y),M)})})};Ia.wheel=t=>{t.preventDefault();q.events.onOnce("input",()=>{q.events.trigger("scroll",new C(t.deltaX,t.deltaY))})};Ia.contextmenu=t=>t.preventDefault();je.visibilitychange=()=>
{"visible"===document.visibilityState?(q.skipTime=!0,q.isHidden=!1,q.events.trigger("show")):(q.isHidden=!0,q.events.trigger("hide"))};Mc.gamepadconnected=t=>{let A=ke(t.gamepad);q.events.onOnce("input",()=>{q.events.trigger("gamepadConnect",A)})};Mc.gamepaddisconnected=t=>{let A=Aa().filter(F=>F.index===t.gamepad.index)[0];Ih(t.gamepad);q.events.onOnce("input",()=>{q.events.trigger("gamepadDisconnect",A)})};for(let [t,A]of Object.entries(Ia))q.canvas.addEventListener(t,A);for(let [t,A]of Object.entries(je))document.addEventListener(t,
A);for(let [t,A]of Object.entries(Mc))window.addEventListener(t,A);let Fh=new ResizeObserver(t=>{for(let A of t)if(A.target===q.canvas){if(q.lastWidth===q.canvas.offsetWidth&&q.lastHeight===q.canvas.offsetHeight)break;q.lastWidth=q.canvas.offsetWidth;q.lastHeight=q.canvas.offsetHeight;q.events.onOnce("input",()=>{q.events.trigger("resize")})}});return Fh.observe(q.canvas),{state:q,dt:b,fixedDt:c,restDt:d,time:g,run:J,canvas:q.canvas,fps:h,numFrames:m,quit:I,isHidden:e,setFullscreen:z,isFullscreen:D,
setCursor:p,screenshot:k,getGamepads:Aa,getCursor:r,setCursorLocked:B,isCursorLocked:n,isTouchscreen:N,mousePos:H,mouseDeltaPos:x,isKeyDown:W,isKeyPressed:L,isKeyPressedRepeat:K,isKeyReleased:fa,isMouseDown:E,isMousePressed:w,isMouseReleased:G,isMouseMoved:Q,isGamepadButtonPressed:ra,isGamepadButtonDown:va,isGamepadButtonReleased:oa,getGamepadStick:ab,isButtonPressed:T,isButtonDown:Oc,isButtonReleased:Pc,setButton:Ib,getButton:Qc,pressButton:rb,releaseButton:Qa,charInputted:cc,onResize:O,onKeyDown:wi,
onKeyPress:xi,onKeyPressRepeat:yi,onKeyRelease:zi,onMouseDown:Ai,onMousePress:Bi,onMouseRelease:Ci,onMouseMove:S,onCharInput:U,onTouchStart:ea,onTouchMove:Ja,onTouchEnd:aa,onScroll:Ka,onHide:Ra,onShow:Ua,onGamepadButtonDown:Ei,onGamepadButtonPress:Di,onGamepadButtonRelease:Fi,onGamepadStick:Rc,onGamepadConnect:Sc,onGamepadDisconnect:bc,onButtonPress:Gi,onButtonDown:Hi,onButtonRelease:Ii,getLastInputDeviceType:ti,events:q.events}},"initApp");Dh.$jscomp$static$block$510831985$34();Ch.$jscomp$static$block$510831985$33();
Hb.$jscomp$static$block$510831985$32();f(qa,"dt");f(tc,"fixedDt");f(uc,"restDt");var Uh=new C(-1,-1),Vh=new C(0,-1),Wh=new C(1,-1),Xh=new C(-1,0),Yh=new C(0,0),Zh=new C(1,0),$h=new C(-1,1),ai=new C(0,1),bi=new C(1,1);f(lb,"anchorPt");f(sf,"alignPt");f(tf,"createEmptyAudioBuffer");var Mh=2*Math.PI/3,Nh=2*Math.PI/4.5,Tc={linear:f(a=>a,"linear"),easeInSine:f(a=>1-Math.cos(a*Math.PI/2),"easeInSine"),easeOutSine:f(a=>Math.sin(a*Math.PI/2),"easeOutSine"),easeInOutSine:f(a=>-(Math.cos(Math.PI*a)-1)/2,"easeInOutSine"),
easeInQuad:f(a=>a*a,"easeInQuad"),easeOutQuad:f(a=>1-(1-a)*(1-a),"easeOutQuad"),easeInOutQuad:f(a=>.5>a?2*a*a:1-Math.pow(-2*a+2,2)/2,"easeInOutQuad"),easeInCubic:f(a=>a*a*a,"easeInCubic"),easeOutCubic:f(a=>1-Math.pow(1-a,3),"easeOutCubic"),easeInOutCubic:f(a=>.5>a?4*a*a*a:1-Math.pow(-2*a+2,3)/2,"easeInOutCubic"),easeInQuart:f(a=>a*a*a*a,"easeInQuart"),easeOutQuart:f(a=>1-Math.pow(1-a,4),"easeOutQuart"),easeInOutQuart:f(a=>.5>a?8*a*a*a*a:1-Math.pow(-2*a+2,4)/2,"easeInOutQuart"),easeInQuint:f(a=>a*
a*a*a*a,"easeInQuint"),easeOutQuint:f(a=>1-Math.pow(1-a,5),"easeOutQuint"),easeInOutQuint:f(a=>.5>a?16*a*a*a*a*a:1-Math.pow(-2*a+2,5)/2,"easeInOutQuint"),easeInExpo:f(a=>0===a?0:Math.pow(2,10*a-10),"easeInExpo"),easeOutExpo:f(a=>1===a?1:1-Math.pow(2,-10*a),"easeOutExpo"),easeInOutExpo:f(a=>0===a?0:1===a?1:.5>a?Math.pow(2,20*a-10)/2:(2-Math.pow(2,-20*a+10))/2,"easeInOutExpo"),easeInCirc:f(a=>1-Math.sqrt(1-Math.pow(a,2)),"easeInCirc"),easeOutCirc:f(a=>Math.sqrt(1-Math.pow(a-1,2)),"easeOutCirc"),easeInOutCirc:f(a=>
.5>a?(1-Math.sqrt(1-Math.pow(2*a,2)))/2:(Math.sqrt(1-Math.pow(-2*a+2,2))+1)/2,"easeInOutCirc"),easeInBack:f(a=>2.70158*a*a*a-1.70158*a*a,"easeInBack"),easeOutBack:f(a=>1+2.70158*Math.pow(a-1,3)+1.70158*Math.pow(a-1,2),"easeOutBack"),easeInOutBack:f(a=>.5>a?Math.pow(2*a,2)*(7.189819*a-2.5949095)/2:(Math.pow(2*a-2,2)*(3.5949095*(2*a-2)+2.5949095)+2)/2,"easeInOutBack"),easeInElastic:f(a=>0===a?0:1===a?1:-Math.pow(2,10*a-10)*Math.sin((10*a-10.75)*Mh),"easeInElastic"),easeOutElastic:f(a=>0===a?0:1===a?
1:Math.pow(2,-10*a)*Math.sin((10*a-.75)*Mh)+1,"easeOutElastic"),easeInOutElastic:f(a=>0===a?0:1===a?1:.5>a?-(Math.pow(2,20*a-10)*Math.sin((20*a-11.125)*Nh))/2:Math.pow(2,-20*a+10)*Math.sin((20*a-11.125)*Nh)/2+1,"easeInOutElastic"),easeInBounce:f(a=>1-Tc.easeOutBounce(1-a),"easeInBounce"),easeOutBounce:f(a=>a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375,"easeOutBounce"),easeInOutBounce:f(a=>.5>a?(1-Tc.easeOutBounce(1-
2*a))/2:(1+Tc.easeOutBounce(2*a-1))/2,"easeInOutBounce")},ac=Tc;f(uf,"buildPath");f(vf,"aStarSearch");var Oh=class{static $jscomp$static$block$510831985$35(){f(this,"NavEdge")}constructor(a,b,c){this.a=a;this.b=b;this.polygon=new WeakRef(c)}isLeft(a,b){return(this.b.x-this.a.x)*(b-this.a.y)-(a-this.a.x)*(this.b.y-this.a.y)}get middle(){return this.a.add(this.b).scale(.5)}},Ph=class{static $jscomp$static$block$510831985$36(){f(this,"NavPolygon")}constructor(a){this._id=a}get id(){return this._id}set edges(a){this._edges=
a;let b=a=0,c=0;for(let d of this._edges){d.polygon=new WeakRef(this);let e=d.a.x*d.b.y-d.a.y*d.b.x;a+=(d.a.x+d.b.x)*e;b+=(d.a.y+d.b.y)*e;c+=e}c/=2;this._centroid=y(a/(6*c),b/(6*c))}get edges(){return this._edges}get centroid(){return this._centroid}contains(a){let b=!1;for(let c of this.edges)c.b.y>a.y!=c.a.y>a.y&&a.x<(c.a.x-c.b.x)*(a.y-c.b.y)/(c.a.y-c.b.y)+c.b.x&&(b=!b);return b}},Qh=class{static $jscomp$static$block$510831985$37(){f(this,"NavMesh")}constructor(){this._polygons=[];this._pointCache=
{};this._edgeCache={}}_addPoint(a){let b=this._pointCache[`${a.x}_${a.y}`];return b||(b=a.clone(),this._pointCache[`${a.x}_${a.y}`]=b,b)}_addEdge(a){return this._edgeCache[`${a.a.x}_${a.a.y}-${a.b.x}_${a.b.y}`]=a,a}_findEdge(a,b){return this._edgeCache[`${a.x}_${a.y}-${b.x}_${b.y}`]}_findCommonEdge(a,b){for(let c of a.edges)if((a=this._findEdge(c.b,c.a))&&a.polygon.deref().id===b.id)return a;return null}addPolygon(a){let b=new Ph(this._polygons.length),c=a.map((d,e)=>new Oh(d,a[(e+1)%a.length],b));
b.edges=c;this._polygons.push(b);for(let d of b.edges)this._addEdge(d);return b}addRect(a,b){let c=this._addPoint(a),d=this._addPoint(a.add(b.x,0)),e=this._addPoint(a.add(b));a=this._addPoint(a.add(0,b.y));return this.addPolygon([c,d,e,a])}_getLocation(a){for(let b of this._polygons)if(b.contains(a))return b;return null}getNeighbours(a){let b=[];for(let c of this._polygons[a].edges)(a=this._findEdge(c.b,c.a))&&(a=a.polygon.deref())&&b.push(a.id);return b}getCost(a,b){return 1}getHeuristic(a,b){a=
this._polygons[a];let c=this._polygons[b];b=a.centroid.x-c.centroid.x;a=a.centroid.y-c.centroid.y;return Math.sqrt(b*b+a*a)}getPath(a,b){return void 0===a||void 0===b?[]:a===b?[a,b]:vf(this,a,b)}getWaypointPath(a,b,c){var d=c?.type||"centroids";c=this._getLocation(a);var e=this._getLocation(b);if(void 0===c||void 0===e)return[];c=this.getPath(c.id,e.id);if(!c)return[];if("edges"===d){d=[];for(e=1;e<c.length;e++){let g=this._polygons[c[e]],h=this._findCommonEdge(this._polygons[c[e-1]],g);d.push(h.middle.add(g.centroid.sub(h.middle).unit().scale(4)))}return[a,
...d,b]}return[a,...c.slice(1,-1).map(g=>this._polygons[g].centroid),b]}};Qh.$jscomp$static$block$510831985$37();Ph.$jscomp$static$block$510831985$36();Oh.$jscomp$static$block$510831985$35();f(xb,"calcTransform");f(wf,"screen2ndc");f(yb,"getArcPts");f(xf,"setBackground");f(yf,"getBackground");f(ma,"pushTranslate");f(Ea,"pushTransform");f(zf,"pushMatrix");f(zb,"pushScale");f(mb,"pushRotate");f(ya,"popTransform");f(Fa,"flush");f(sa,"width");f(ta,"height");f(od,"getViewportScale");f(Af,"contentToView");
f(Bf,"windowToContent");f(pd,"mousePos");f(Qb,"center");var Rh=class{static $jscomp$static$block$510831985$38(){f(this,"TexPacker")}constructor(a,b,c,d){this.lastTextureId=0;this.textures=[];this.bigTextures=[];this.texturesPosition=new Map;this.curHeight=this.y=this.x=0;this.gfx=a;this.canvas=document.createElement("canvas");this.canvas.width=b;this.canvas.height=c;this.textures=[eb.fromImage(a,this.canvas)];this.bigTextures=[];this.padding=d;a=this.canvas.getContext("2d");if(!a)throw Error("Failed to get 2d context");
this.c2d=a}add(a){let b=a.width+2*this.padding,c=a.height+2*this.padding;if(b>this.canvas.width||c>this.canvas.height)return a=eb.fromImage(this.gfx,a),this.bigTextures.push(a),[a,new la(0,0,1,1),0];this.x+b>this.canvas.width&&(this.x=0,this.y+=this.curHeight,this.curHeight=0);this.y+c>this.canvas.height&&(this.c2d.clearRect(0,0,this.canvas.width,this.canvas.height),this.textures.push(eb.fromImage(this.gfx,this.canvas)),this.x=0,this.y=0,this.curHeight=0);let d=this.textures[this.textures.length-
1],e=new C(this.x+this.padding,this.y+this.padding);return this.x+=b,c>this.curHeight&&(this.curHeight=c),a instanceof ImageData?this.c2d.putImageData(a,e.x,e.y):this.c2d.drawImage(a,e.x,e.y),d.update(this.canvas),this.texturesPosition.set(this.lastTextureId,{position:e,size:new C(a.width,a.height),texture:d}),this.lastTextureId++,[d,new la(e.x/this.canvas.width,e.y/this.canvas.height,a.width/this.canvas.width,a.height/this.canvas.height),this.lastTextureId-1]}free(){for(let a of this.textures)a.free();
for(let a of this.bigTextures)a.free()}};Rh.$jscomp$static$block$510831985$38();f(Ga,"fixURL");const le=class{static $jscomp$static$block$510831985$39(){f(this,"Asset")}constructor(a){this.loaded=!1;this.error=this.data=null;this.onLoadEvents=new ua;this.onErrorEvents=new ua;this.onFinishEvents=new ua;a.then(b=>{this.loaded=!0;this.data=b;this.onLoadEvents.trigger(b)}).catch(b=>{if(this.error=b,0<this.onErrorEvents.numListeners())this.onErrorEvents.trigger(b);else throw b;}).finally(()=>{this.onFinishEvents.trigger();
this.loaded=!0})}static loaded(a){let b=new le(Promise.resolve(a));return b.data=a,b.loaded=!0,b}onLoad(a){return this.loaded&&this.data?a(this.data):this.onLoadEvents.add(a),this}onError(a){return this.loaded&&this.error?a(this.error):this.onErrorEvents.add(a),this}onFinish(a){return this.loaded?a():this.onFinishEvents.add(a),this}then(a){return this.onLoad(a)}catch(a){return this.onError(a)}finally(a){return this.onFinish(a)}};le.$jscomp$static$block$510831985$39();var La=le,sb=class{constructor(){this.assets=
new Map;this.lastUID=0}static $jscomp$static$block$510831985$40(){f(this,"AssetBucket")}add(a,b){a=a??this.lastUID++ +"";b=new La(b);return this.assets.set(a,b),b}addLoaded(a,b){a=a??this.lastUID++ +"";b=La.loaded(b);return this.assets.set(a,b),b}get(a){return this.assets.get(a)}progress(){if(0===this.assets.size)return 1;let a=0;return this.assets.forEach(b=>{b.loaded&&a++}),a/this.assets.size}getFailedAssets(){return Array.from(this.assets.keys()).filter(a=>null!==this.assets.get(a).error).map(a=>
[a,this.assets.get(a)])}};sb.$jscomp$static$block$510831985$40();f(vc,"fetchURL");f(Rb,"fetchJSON");f(Df,"fetchText");f(Ef,"fetchArrayBuffer");f(Ff,"loadRoot");f(Gf,"loadJSON");f(Sb,"loadImg");f(cb,"loadProgress");f(qd,"getFailedAssets");f(Hf,"getAsset");f(wc,"load");var Li=f((a,b)=>({urlPrefix:"",sprites:new sb,fonts:new sb,bitmapFonts:new sb,sounds:new sb,shaders:new sb,custom:new sb,music:{},packer:new Rh(a,2048,2048,b),loaded:!1}),"initAssets");const Jb=class{static $jscomp$static$block$510831985$41(){f(this,
"SpriteData")}constructor(a,b,c={},d=null){this.frames=[new la(0,0,1,1)];this.anims={};this.slice9=null;this.tex=a;b&&(this.frames=b);this.anims=c;this.slice9=d}get width(){return this.tex.width*this.frames[0].w}get height(){return this.tex.height*this.frames[0].h}static from(a,b={}){return"string"==typeof a?Jb.fromURL(a,b):Promise.resolve(Jb.fromImage(a,b))}static fromImage(a,b={}){let [c,d]=l.assets.packer.add(a);a=b.frames?b.frames.map(e=>new la(d.x+e.x*d.w,d.y+e.y*d.h,e.w*d.w,e.h*d.h)):td(b.sliceX||
1,b.sliceY||1,d.x,d.y,d.w,d.h);return new Jb(c,a,b.anims,b.slice9)}static fromURL(a,b={}){return Sb(a).then(c=>Jb.fromImage(c,b))}};Jb.$jscomp$static$block$510831985$41();var db=Jb;f(Tb,"resolveSprite");f(rd,"getSprite");f(Ab,"loadSprite");f(td,"slice");f(sd,"createSpriteSheet");f(If,"loadBean");f(Jf,"loadAseprite");var Ub=class{static $jscomp$static$block$510831985$42(){f(this,"FontData")}constructor(a,b={}){this.filter="linear";this.outline=null;this.size=64;if(this.fontface=a,this.filter=b.filter??
"linear",this.size=b.size??64,256<this.size)throw Error("Max font size: 256");b.outline&&(this.outline={width:1,color:R(0,0,0)},"number"==typeof b.outline?this.outline.width=b.outline:"object"==typeof b.outline&&(b.outline.width&&(this.outline.width=b.outline.width),b.outline.color&&(this.outline.color=b.outline.color)))}};Ub.$jscomp$static$block$510831985$42();f(ud,"resolveFont");f(wd,"getFont");f(Kf,"loadFont");f(Lf,"makeFont");f(vd,"getBitmapFont");f(Mf,"loadBitmapFont");f(Nf,"loadPedit");var Of=
class{static $jscomp$static$block$510831985$43(){f(this,"Shader")}constructor(a,b,c,d){this.ctx=a;a.onDestroy(()=>this.free());let e=a.gl;a=e.createShader(e.VERTEX_SHADER);let g=e.createShader(e.FRAGMENT_SHADER);if(!a||!g)throw Error("Failed to create shader");e.shaderSource(a,b);e.shaderSource(g,c);e.compileShader(a);e.compileShader(g);let h=e.createProgram();if(this.glProgram=h,e.attachShader(h,a),e.attachShader(h,g),d.forEach((m,k)=>e.bindAttribLocation(h,k,m)),e.linkProgram(h),!e.getProgramParameter(h,
e.LINK_STATUS)){if(b=e.getShaderInfoLog(a))throw Error("VERTEX SHADER "+b);if(b=e.getShaderInfoLog(g))throw Error("FRAGMENT SHADER "+b);}e.deleteShader(a);e.deleteShader(g)}bind(){this.ctx.pushProgram(this.glProgram)}unbind(){this.ctx.popProgram()}send(a){let b=this.ctx.gl;for(let c in a){let d=a[c],e=b.getUniformLocation(this.glProgram,c);if("number"==typeof d)b.uniform1f(e,d);else if(d instanceof Sa)b.uniformMatrix4fv(e,!1,new Float32Array(d.m));else if(d instanceof Y)b.uniform3f(e,d.r,d.g,d.b);
else if(d instanceof C)b.uniform2f(e,d.x,d.y);else if(Array.isArray(d))si(d)?b.uniform1fv(e,d):ri(d)?b.uniform2fv(e,d.map(g=>[g.x,g.y]).flat()):qi(d)&&b.uniform3fv(e,d.map(g=>[g.r,g.g,g.b]).flat());else throw Error("Unsupported uniform data type");}}free(){this.ctx.gl.deleteProgram(this.glProgram)}};Of.$jscomp$static$block$510831985$43();f(xc,"makeShader");f(Pf,"resolveShader");f(yd,"getShader");f(Qf,"loadShader");f(Rf,"loadShaderURL");const ec=class{static $jscomp$static$block$510831985$44(){f(this,
"SoundData")}constructor(a){this.buf=a}static fromArrayBuffer(a){return(new Promise((b,c)=>l.audio.ctx.decodeAudioData(a,b,c))).then(b=>new ec(b))}static fromURL(a){return Cf(a)?ec.fromArrayBuffer(df(a)):Ef(a).then(b=>ec.fromArrayBuffer(b))}};ec.$jscomp$static$block$510831985$44();var Vb=ec;f(Sf,"resolveSound");f(zd,"getSound");f(Tf,"loadSound");f(Uf,"loadMusic");f(Ad,"loadSpriteAtlas");f(Xa,"drawRaw");f(Ya,"drawPolygon");f(Bd,"drawEllipse");f(nb,"drawCircle");f(Bb,"drawLine");f(Vf,"_drawLinesBevel");
f(Wf,"_drawLinesRound");f(Xf,"_drawLinesMiter");f(yc,"drawLines");f(Cd,"drawCurve");f(Yf,"drawBezier");const me=class{static $jscomp$static$block$510831985$45(){f(this,"Texture")}constructor(a,b,c,d={}){this.src=null;this.ctx=a;let e=a.gl,g=a.gl.createTexture();if(!g)throw Error("Failed to create texture");this.glTex=g;a.onDestroy(()=>this.free());this.width=b;this.height=c;a={linear:e.LINEAR,nearest:e.NEAREST}[d.filter??a.opts.texFilter??"nearest"];d={repeat:e.REPEAT,clampToEdge:e.CLAMP_TO_EDGE}[d.wrap??
"clampToEdge"];this.bind();b&&c&&e.texImage2D(e.TEXTURE_2D,0,e.RGBA,b,c,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,a);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,a);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,d);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,d);e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);this.unbind()}static fromImage(a,b,c={}){a=new me(a,b.width,b.height,c);return a.update(b),a.src=b,a}update(a,b=0,c=0){let d=this.ctx.gl;this.bind();
d.texSubImage2D(d.TEXTURE_2D,0,b,c,d.RGBA,d.UNSIGNED_BYTE,a);this.unbind()}bind(){this.ctx.pushTexture2D(this.glTex)}unbind(){this.ctx.popTexture2D()}free(){this.ctx.gl.deleteTexture(this.glTex)}};me.$jscomp$static$block$510831985$45();var eb=me,Zb=class{static $jscomp$static$block$510831985$46(){f(this,"FrameBuffer")}constructor(a,b,c,d={}){this.ctx=a;let e=a.gl;a.onDestroy(()=>this.free());this.tex=new eb(a,b,c,d);a=e.createFramebuffer();d=e.createRenderbuffer();if(!a||!d)throw Error("Failed to create framebuffer");
this.glFramebuffer=a;this.glRenderbuffer=d;this.bind();e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,b,c);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.tex.glTex,0);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,this.glRenderbuffer);this.unbind()}get width(){return this.tex.width}get height(){return this.tex.height}toImageData(){var a=this.ctx.gl;let b=new Uint8ClampedArray(this.width*this.height*4);this.bind();a.readPixels(0,
0,this.width,this.height,a.RGBA,a.UNSIGNED_BYTE,b);this.unbind();a=4*this.width;let c=new Uint8Array(a);for(let d=0;d<(this.height/2|0);d++){let e=d*a,g=(this.height-d-1)*a;c.set(b.subarray(e,e+a));b.copyWithin(e,g,g+a);b.set(c,g)}return new ImageData(b,this.width,this.height)}toDataURL(){let a=document.createElement("canvas"),b=a.getContext("2d");if(a.width=this.width,a.height=this.height,!b)throw Error("Failed to get 2d context");return b.putImageData(this.toImageData(),0,0),a.toDataURL()}clear(){let a=
this.ctx.gl;a.clear(a.COLOR_BUFFER_BIT)}draw(a){this.bind();a();this.unbind()}bind(){this.ctx.pushFramebuffer(this.glFramebuffer);this.ctx.pushRenderbuffer(this.glRenderbuffer);this.ctx.pushViewport({x:0,y:0,w:this.width,h:this.height})}unbind(){this.ctx.popFramebuffer();this.ctx.popRenderbuffer();this.ctx.popViewport()}free(){let a=this.ctx.gl;a.deleteFramebuffer(this.glFramebuffer);a.deleteRenderbuffer(this.glRenderbuffer);this.tex.free()}},Sh=class{static $jscomp$static$block$510831985$47(){f(this,
"BatchRenderer")}constructor(a,b,c,d){this.vqueue=[];this.iqueue=[];this.numDraws=0;this.curShader=this.curTex=this.curPrimitive=null;this.curUniform={};let e=a.gl;this.vertexFormat=b;this.ctx=a;this.stride=b.reduce((g,h)=>g+h.size,0);this.maxVertices=c;this.maxIndices=d;b=e.createBuffer();if(!b)throw Error("Failed to create vertex buffer");this.glVBuf=b;a.pushArrayBuffer(this.glVBuf);e.bufferData(e.ARRAY_BUFFER,4*c,e.DYNAMIC_DRAW);a.popArrayBuffer();this.glIBuf=e.createBuffer();a.pushElementArrayBuffer(this.glIBuf);
e.bufferData(e.ELEMENT_ARRAY_BUFFER,4*d,e.DYNAMIC_DRAW);a.popElementArrayBuffer()}push(a,b,c,d,e=null,g={}){(a!==this.curPrimitive||e!==this.curTex||d!==this.curShader||!qc(this.curUniform,g)||this.vqueue.length+b.length*this.stride>this.maxVertices||this.iqueue.length+c.length>this.maxIndices)&&this.flush();let h=this.vqueue.length/this.stride;for(let m of b)this.vqueue.push(m);for(let m of c)this.iqueue.push(m+h);this.curPrimitive=a;this.curShader=d;this.curTex=e;this.curUniform=g}flush(){if(this.curPrimitive&&
this.curShader&&0!==this.vqueue.length&&0!==this.iqueue.length){var a=this.ctx.gl;this.ctx.pushArrayBuffer(this.glVBuf);a.bufferSubData(a.ARRAY_BUFFER,0,new Float32Array(this.vqueue));this.ctx.pushElementArrayBuffer(this.glIBuf);a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,new Uint16Array(this.iqueue));this.ctx.setVertexFormat(this.vertexFormat);this.curShader.bind();this.curShader.send(this.curUniform);this.curTex?.bind();a.drawElements(this.curPrimitive,this.iqueue.length,a.UNSIGNED_SHORT,0);this.curTex?.unbind();
this.curShader.unbind();this.ctx.popArrayBuffer();this.ctx.popElementArrayBuffer();this.vqueue=[];this.iqueue=[];this.numDraws++}}free(){let a=this.ctx.gl;a.deleteBuffer(this.glVBuf);a.deleteBuffer(this.glIBuf)}};Sh.$jscomp$static$block$510831985$47();Zb.$jscomp$static$block$510831985$46();f(fb,"genStack");f(Zf,"initGfx");var Ed={};f(Dd,"applyCharTransform");f(zc,"compileStyledText");f(gb,"formatText");f(Cb,"drawUVQuad");f(hb,"drawFormattedText");f(Ha,"drawRect");f(Za,"drawUnscaled");f(Fd,"drawInspectText");
f(Gd,"drawTriangle");f($f,"drawDebug");f(Ac,"prettyDebug");f(ag,"drawFrame");f(bg,"drawLoadScreen");f(Hd,"drawStenciled");f(cg,"drawMasked");f(Wb,"drawTexture");f(dg,"drawSprite");f(eg,"drawSubtracted");f(Id,"drawText");var Mi=f((a,b)=>{let c=xc(b,"\nvec4 vert(vec2 pos, vec2 uv, vec4 color) {\n\treturn def_vert();\n}\n","\nvec4 frag(vec2 pos, vec2 uv, vec4 color, sampler2D tex) {\n\treturn def_frag();\n}\n"),d=a.pixelDensity??1,e=a.scale??1,{gl:g}=b,h=eb.fromImage(b,new ImageData(new Uint8ClampedArray([255,
255,255,255]),1,1)),m=a.width&&a.height?new Zb(b,a.width*d*e,a.height*d*e):new Zb(b,g.drawingBufferWidth,g.drawingBufferHeight),k=null,p=1;a.background&&("string"==typeof a.background?k=R(a.background):(k=R(...a.background),p=a.background[3]??1),g.clearColor(k.r/255,k.g/255,k.b/255,p??1));g.enable(g.BLEND);g.blendFuncSeparate(g.ONE,g.ONE_MINUS_SRC_ALPHA,g.ONE,g.ONE_MINUS_SRC_ALPHA);let r=new Sh(b,xd,pi,12288),B=eb.fromImage(b,new ImageData(new Uint8ClampedArray([128,128,128,255,190,190,190,255,190,
190,190,255,128,128,128,255]),2,2),{wrap:"repeat",filter:"nearest"});return{lastDrawCalls:0,ggl:b,defShader:c,defTex:h,frameBuffer:m,postShader:null,postShaderUniform:null,renderer:r,transform:new Sa,transformStack:[],bgTex:B,bgColor:k,bgAlpha:p,width:a.width??g.drawingBufferWidth/d/e,height:a.height??g.drawingBufferHeight/d/e,viewport:{x:0,y:0,width:g.drawingBufferWidth,height:g.drawingBufferHeight},fixed:!1}},"initAppGfx");f(Jd,"updateViewport");f(ib,"isFixed");f(jb,"getRenderProps");f(fg,"circle");
f(Kd,"color");f(gg,"drawon");f(hg,"fadeIn");f(ig,"mask");f(Ld,"opacity");f(jg,"outline");var lg=class{static $jscomp$static$block$510831985$48(){f(this,"Particle")}constructor(){this.pos=y(0);this.vel=y(0);this.acc=y(0);this.damping=this.angularVelocity=this.angle=0;this.lt=null;this.t=0;this.gc=!0}get progress(){return this.lt?this.t/this.lt:this.t}};lg.$jscomp$static$block$510831985$48();f(kg,"particles");f(mg,"polygon");f(Md,"raycast");f(Nd,"rect");f(ng,"shader");f(og,"addLevel");f(za,"on");var Ni=
f((a,b,...c)=>{for(let d of l.game.root.children)d.is(b)&&d.trigger(a)},"trigger"),Oi=ja(a=>{let b=l.game.root.add([{fixedUpdate:a}]);return{get paused(){return b.paused},set paused(c){b.paused=c},cancel:f(()=>b.destroy(),"cancel")}},(a,b)=>za("fixedUpdate",a,b)),Pi=ja(a=>{let b=l.game.root.add([{update:a}]);return{get paused(){return b.paused},set paused(c){b.paused=c},cancel:f(()=>b.destroy(),"cancel")}},(a,b)=>za("update",a,b)),Qi=ja(a=>{let b=l.game.root.add([{draw:a}]);return{get paused(){return b.hidden},
set paused(c){b.hidden=c},cancel:f(()=>b.destroy(),"cancel")}},(a,b)=>za("draw",a,b)),sg=ja(a=>l.game.events.on("add",a),(a,b)=>za("add",a,b)),Ri=ja(a=>l.game.events.on("destroy",a),(a,b)=>za("destroy",a,b)),Si=ja(a=>l.game.events.on("use",a),(a,b)=>za("use",a,b)),Ti=ja(a=>l.game.events.on("unuse",a),(a,b)=>za("unuse",a,b)),tg=ja(a=>l.game.events.on("tag",a),(a,b)=>za("tag",a,b)),Ui=ja(a=>l.game.events.on("untag",a),(a,b)=>za("untag",a,b));f(pg,"onCollide");f(qg,"onCollideUpdate");f(rg,"onCollideEnd");
f(Yb,"forAllCurrentAndFuture");var Vi=ja(a=>l.app.onMousePress(a),(a,b)=>{let c=[];return Yb(a,d=>{if(!d.area)throw Error("onClick() requires the object to have area() component");c.push(d.onClick(()=>b(d)))}),ob.join(c)});f(ug,"onHover");f(vg,"onHoverUpdate");f(wg,"onHoverEnd");f(xg,"onLoading");f(yg,"onResize");f(zg,"onError");f(Bc,"onLoad");f(Ag,"onLoadError");f(Qd,"setCamPos");f(Rd,"getCamPos");f(Sd,"setCamScale");f(Td,"getCamScale");f(Ud,"setCamRot");f(Vd,"getCamRot");f(Bg,"getCamTransform");
f(Wd,"flash");f(Cg,"camTransform");f(Dg,"shake");f(Cc,"toScreen");f(Zd,"toWorld");f(Eg,"camPos");f(Fg,"camScale");f(Gg,"camRot");f(Hg,"camFlash");f(Dc,"make");var Wi=f(()=>({events:new Db,objEvents:new Db,root:Dc([]),gravity:null,scenes:{},currentScene:null,layers:null,defaultLayerIndex:0,logs:[],cam:{pos:null,scale:new C(1),angle:0,shake:0,transform:new Sa}}),"initGame");f(Ig,"setGravity");f(Jg,"getGravity");f(Kg,"setGravityDirection");f(Eb,"getGravityDirection");var Xi=li("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"),
Yi=f(()=>(()=>{let a=new (window.AudioContext||window.webkitAudioContext),b=a.createGain();b.connect(a.destination);let c=new Vb(tf(a));return a.decodeAudioData(Xi.buffer.slice(0)).then(d=>{c.buf=d}).catch(d=>{console.error("Failed to load burp: ",d)}),{ctx:a,masterNode:b,burpSnd:c}})(),"initAudio");f(Lg,"playMusic");f(Mg,"play");f($d,"burp");f(ae,"setVolume");f(be,"getVolume");f(Ng,"volume");f(ce,"initEvents");f(Og,"addKaboom");f(fe,"setLayers");f(Pg,"getLayers");f(Qg,"getDefaultLayer");f(Rg,"layers");
f(Yd,"destroy");f(Sg,"getTreeRoot");f(Tg,"scene");f(Ug,"go");f(Vg,"onSceneLeave");f(Wg,"getSceneName");f(Ec,"sprite");f(Xg,"text");f(Yg,"uvquad");f(Zg,"agent");f($g,"pathfinder");f(ah,"patrol");f(bh,"sentry");f(Od,"tile");var Uc=class{static $jscomp$static$block$510831985$49(){f(this,"AnimateChannel")}constructor(a,b,c){this.name=a;this.duration=b.duration;this.loops=b.loops||0;this.direction=b.direction||"forward";this.easing=b.easing||ac.linear;this.interpolation=b.interpolation||"linear";this.isFinished=
!1;this.timing=b.timing;this.easings=b.easings;this.relative=c}update(a,b){return!0}getLowerKeyIndexAndRelativeTime(a,b,c){let d=b-1;a/=this.duration;if(0!==this.loops&&a>=this.loops)return[d,0,!0];let e=Math.trunc(a);if(a-=e,("reverse"==this.direction||"ping-pong"==this.direction&&e&1)&&(a=1-a),c){for(b=0;void 0!==c[b+1]&&c[b+1]<a;)b++;return b>=d?[d,0,!0]:[b,(a-c[b])/(c[b+1]-c[b]),!1]}c=Math.floor((b-1)*a);return[c,(a-c/d)*d,!1]}setValue(a,b,c){if(this.relative)switch(b){case "pos":a.pos=a.base.pos.add(c);
break;case "angle":a.angle=a.base.angle+c;break;case "scale":a.scale=a.base.scale.scale(c);break;case "opacity":a.opacity=a.base.opacity*c;break;default:a[b]=c}else a[b]=c}serialize(){let a={duration:this.duration,keys:[]};return this.loops&&(a.loops=this.loops),"forward"!==this.direction&&(a.direction=this.direction),this.easing!=ac.linear&&(a.easing=this.easing.name),"linear"!==this.interpolation&&(a.interpolation=this.interpolation),this.timing&&(a.timing=this.timing),this.easings&&(a.easings=
this.easings.map(b=>this.easing.name)),a}};Uc.$jscomp$static$block$510831985$49();f(ge,"reflect");var dh=class extends Uc{static $jscomp$static$block$510831985$50(){f(this,"AnimateChannelNumber")}constructor(a,b,c,d){super(a,c,d);this.keys=b}update(a,b){let [c,d,e]=this.getLowerKeyIndexAndRelativeTime(b,this.keys.length,this.timing);0==d||"none"===this.interpolation?this.setValue(a,this.name,this.keys[c]):this.setValue(a,this.name,wa(this.keys[c],this.keys[c+1],(this.easings?this.easings[c]:this.easing)(d)));
return e}serialize(){return Object.assign(super.serialize(),{keys:this.keys})}},eh=class extends Uc{static $jscomp$static$block$510831985$51(){f(this,"AnimateChannelVec2")}constructor(a,b,c,d,e){if(super(a,c,d),this.keys=b,"spline"===this.interpolation)for(this.curves=[],e&&(this.dcurves=[]),a=0;a<this.keys.length-1;a++){b=this.keys[a];var g=a+1;c=this.keys[g];d=0<a?this.keys[a-1]:ge(c,b);g=g<this.keys.length-1?this.keys[g+1]:ge(b,c);this.curves.push(Pb(d,b,c,g));e&&this.dcurves?.push(Pb(d,b,c,g,
Re))}}update(a,b){let [c,d,e]=this.getLowerKeyIndexAndRelativeTime(b,this.keys.length,this.timing);if(0==d||"none"===this.interpolation)this.setValue(a,this.name,this.keys[c]);else switch(b=this.easings?this.easings[c]:this.easing,this.interpolation){case "linear":this.setValue(a,this.name,this.keys[c].lerp(this.keys[c+1],b(d)));break;case "slerp":this.setValue(a,this.name,this.keys[c].slerp(this.keys[c+1],b(d)));break;case "spline":this.curves&&(this.setValue(a,this.name,this.curves[c](b(d))),this.dcurves&&
this.setValue(a,"angle",this.dcurves[c](b(d)).angle()))}return e}serialize(){return Object.assign(super.serialize(),{keys:this.keys.map(a=>[a.x,a.y])})}},fh=class extends Uc{static $jscomp$static$block$510831985$52(){f(this,"AnimateChannelColor")}constructor(a,b,c,d){super(a,c,d);this.keys=b}update(a,b){let [c,d,e]=this.getLowerKeyIndexAndRelativeTime(b,this.keys.length,this.timing);0==d||"none"==this.interpolation?this.setValue(a,this.name,this.keys[c]):this.setValue(a,this.name,this.keys[c].lerp(this.keys[c+
1],(this.easings?this.easings[c]:this.easing)(d)));return e}serialize(){return Object.assign(super.serialize(),{keys:this.keys})}};fh.$jscomp$static$block$510831985$52();eh.$jscomp$static$block$510831985$51();dh.$jscomp$static$block$510831985$50();f(ch,"animate");f(he,"serializeAnimation");f(ee,"boom");f(gh,"health");f(hh,"lifespan");f(ih,"named");f(jh,"state");f(de,"stay");f(kh,"textInput");f(Gc,"timer");var Hc=0;f(function(){return 0<Hc},"usesArea");f(lh,"area");f(mh,"body");f(nh,"doubleJump");
f(oh,"surfaceEffector");f(ph,"areaEffector");f(qh,"pointEffector");f(rh,"constantForce");f(sh,"platformEffector");f(th,"buoyancyEffector");f(Fc,"anchor");f(Xd,"fixed");f(uh,"follow");f(vh,"layer");f(wh,"move");f(xh,"offscreen");f(Xb,"pos");f(yh,"rotate");f($b,"scale");f(zh,"z");var l={k:null,globalOpt:null,gfx:null,game:null,app:null,assets:null,fontCacheCanvas:null,fontCacheC2d:null,debug:null,audio:null,pixelDensity:null,canvas:null,gscale:null,kaSprite:null,boomSprite:null},mi=f((a={tagsAsComponents:!0})=>
{function b(O,S){let U=new Zb(E,O,S);return{clear:f(()=>U.clear(),"clear"),free:f(()=>U.free(),"free"),toDataURL:f(()=>U.toDataURL(),"toDataURL"),toImageData:f(()=>U.toImageData(),"toImageData"),width:U.width,height:U.height,draw:f(ea=>{Fa();U.bind();ea();Fa();U.unbind()},"draw"),get fb(){return U}}}function c(){w.clear(w.COLOR_BUFFER_BIT);G.frameBuffer.bind();w.clear(w.COLOR_BUFFER_BIT);G.bgColor||Za(()=>{Cb({width:sa(),height:ta(),quad:new la(0,0,sa()/64,ta()/64),tex:G.bgTex,fixed:!0})});G.renderer.numDraws=
0;G.fixed=!1;G.transformStack.length=0;G.transform=new Sa}function d(O,S){G.postShader=O;G.postShaderUniform=S??null}function e(){Fa();G.lastDrawCalls=G.renderer.numDraws;G.frameBuffer.unbind();w.viewport(0,0,w.drawingBufferWidth,w.drawingBufferHeight);let O=G.width,S=G.height;G.width=w.drawingBufferWidth/N;G.height=w.drawingBufferHeight/N;Wb({flipY:!0,tex:G.frameBuffer.tex,pos:new C(G.viewport.x,G.viewport.y),width:G.viewport.width,height:G.viewport.height,shader:G.postShader,uniform:"function"==
typeof G.postShaderUniform?G.postShaderUniform():G.postShaderUniform,fixed:!0});Fa();G.width=O;G.height=S}function g(O,S){try{return JSON.parse(window.localStorage[O])}catch{return S?(h(O,S),S):null}}function h(O,S){window.localStorage[O]=JSON.stringify(S)}function m(O,...S){O=O(Qa);let U;"function"==typeof O?U=O(...S)(Qa):U=O;for(let ea in U)Qa[ea]=U[ea],!1!==a.global&&(window[ea]=U[ea]);return Qa}function k(O){let S=H.canvas.captureStream(O),U=Q.ctx.createMediaStreamDestination();Q.masterNode.connect(U);
let ea=new MediaRecorder(S),Ja=[];return ea.ondataavailable=aa=>{0<aa.data.size&&Ja.push(aa.data)},ea.onerror=()=>{Q.masterNode.disconnect(U);S.getTracks().forEach(aa=>aa.stop())},ea.start(),{resume(){ea.resume()},pause(){ea.pause()},stop(){return ea.stop(),Q.masterNode.disconnect(U),S.getTracks().forEach(aa=>aa.stop()),new Promise(aa=>{ea.onstop=()=>{aa(new Blob(Ja,{type:"video/mp4"}))}})},download(aa="kaboom.mp4"){this.stop().then(Ka=>ld(aa,Ka))}}}function p(){return document.activeElement===H.canvas}
function r(){K.root.fixedUpdate()}function B(){K.root.update()}function n(){function O(aa){if(Ja.push(ea.clone()),aa.pos&&ea.translate(aa.pos),aa.scale&&ea.scale(aa.scale),aa.angle&&ea.rotate(aa.angle),aa.transform=ea.clone(),aa.c("area")&&!aa.paused){var Ka=aa.worldArea().bbox(),Ra=Math.floor(Ka.pos.x/U);let Rc=Math.floor(Ka.pos.y/U),Sc=Math.ceil((Ka.pos.x+Ka.width)/U);Ka=Math.ceil((Ka.pos.y+Ka.height)/U);let bc=new Set;for(;Ra<=Sc;Ra++)for(let ab=Rc;ab<=Ka;ab++)if(S[Ra])if(S[Ra][ab]){let cc=S[Ra][ab];
a:for(let Aa of cc)if(!Aa.paused&&Aa.exists()&&!bc.has(Aa.id)){for(let $a of aa.collisionIgnore)if(Aa.is($a))continue a;for(let $a of Aa.collisionIgnore)if(aa.is($a))continue a;var Ua=Xe(aa.worldArea(),Aa.worldArea());if(Ua){Ua=new Ib(aa,Aa,Ua.normal,Ua.distance);aa.trigger("collideUpdate",Aa,Ua);let $a=Ua.reverse();$a.resolved=Ua.resolved;Aa.trigger("collideUpdate",aa,$a)}bc.add(Aa.id)}cc.push(aa)}else S[Ra][ab]=[aa];else S[Ra]={},S[Ra][ab]=[aa]}aa.children.forEach(O);ea=Ja.pop()}if(0<Hc){var S=
{},U=a.hashGridSize||64,ea=new Sa,Ja=[];f(O,"checkObj");O(K.root)}}function v(O){console.error(O);Q.ctx.suspend();let S=O.message??String(O)??"Unknown error, check console for more info";H.run(()=>{},()=>{c();Za(()=>{var U=sa();let ea=ta(),Ja={size:36,width:U-64,letterSpacing:4,lineSpacing:4,font:"monospace",fixed:!0};Ha({width:U,height:ea,color:R(0,0,255),fixed:!0});U=gb({...Ja,text:"Error",pos:y(32),color:R(255,128,0),fixed:!0});hb(U);Id({...Ja,text:S,pos:y(32,32+U.height+16),fixed:!0});ya();K.events.trigger("error",
O)});e()})}function u(O){x.push(O)}function z(){K.events.onOnce("frameEnd",()=>{H.quit();w.clear(w.COLOR_BUFFER_BIT|w.DEPTH_BUFFER_BIT|w.STENCIL_BUFFER_BIT);let O=w.getParameter(w.MAX_TEXTURE_IMAGE_UNITS);for(let S=0;S<O;S++)w.activeTexture(w.TEXTURE0+S),w.bindTexture(w.TEXTURE_2D,null),w.bindTexture(w.TEXTURE_CUBE_MAP,null);w.bindBuffer(w.ARRAY_BUFFER,null);w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,null);w.bindRenderbuffer(w.RENDERBUFFER,null);w.bindFramebuffer(w.FRAMEBUFFER,null);E.destroy();x.forEach(S=>
S())})}l.k&&(console.warn("KAPLAY already initialized, you are calling kaplay() multiple times, it may lead bugs!"),l.k.quit());l.globalOpt=a;var D=a.root??document.body;D===document.body&&(document.body.style.width="100%",document.body.style.height="100%",document.body.style.margin="0px",document.documentElement.style.width="100%",document.documentElement.style.height="100%");D=a.canvas??D.appendChild(document.createElement("canvas"));l.canvas=D;var I=a.scale??1;l.gscale=I;var J=a.width&&a.height&&
!a.stretch&&!a.letterbox;J?(D.width=a.width*I,D.height=a.height*I):(D.width=D.parentElement.offsetWidth,D.height=D.parentElement.offsetHeight);I=["outline: none","cursor: default"];J?(J=D.height,I.push(`width: ${D.width}px`),I.push(`height: ${J}px`)):(I.push("width: 100%"),I.push("height: 100%"));a.crisp&&(I.push("image-rendering: pixelated"),I.push("image-rendering: crisp-edges"));D.style.cssText=I.join(";");let N=a.pixelDensity||1;l.pixelDensity=N;D.width*=N;D.height*=N;D.tabIndex=0;J=document.createElement("canvas");
J.width=256;J.height=256;l.fontCacheCanvas=J;J=J.getContext("2d",{willReadFrequently:!0});l.fontCacheC2d=J;let H=Ki({canvas:D,touchToMouse:a.touchToMouse,gamepads:a.gamepads,pixelDensity:a.pixelDensity,maxFPS:a.maxFPS,buttons:a.buttons});l.app=H;let x=[];D=H.canvas.getContext("webgl",{antialias:!0,depth:!0,stencil:!0,alpha:!0,preserveDrawingBuffer:!0});if(!D)throw Error("WebGL not supported");let w=D,E=Zf(w,{texFilter:a.texFilter}),G=Mi(a,E);l.gfx=G;let Q=Yi();l.audio=Q;let L=Li(E,a.spriteAtlasPadding??
0);l.assets=L;let K=Wi();l.game=K;K.root.use(Gc());f(b,"makeCanvas");f(c,"frameStart");f(d,"usePostEffect");f(e,"frameEnd");let W=!1,fa={inspect:!1,timeScale:1,showLog:!0,fps:f(()=>H.fps(),"fps"),numFrames:f(()=>H.numFrames(),"numFrames"),stepFrame:B,drawCalls:f(()=>G.lastDrawCalls,"drawCalls"),clearLog:f(()=>K.logs=[],"clearLog"),log:f((...O)=>{let S=a.logMax??8;O=1<O.length?O.concat(" ").join(" "):O[0];K.logs.unshift({msg:O,time:H.time()});K.logs.length>S&&(K.logs=K.logs.slice(0,S))},"log"),error:f(O=>
fa.log(Error(O.toString?O.toString():O)),"error"),curRecording:null,numObjects:f(()=>ra("*",{recursive:!0}).length,"numObjects"),get paused(){return W},set paused(O){(W=O)?Q.ctx.suspend():Q.ctx.resume()}};l.debug=fa;f(g,"getData");f(h,"setData");f(m,"plug");f(k,"record");f(p,"isFocused");D=K.root.add.bind(K.root);J=K.root.readd.bind(K.root);I=K.root.removeAll.bind(K.root);let ra=K.root.get.bind(K.root),va=K.root.wait.bind(K.root),oa=K.root.loop.bind(K.root),T=K.root.query.bind(K.root),Oc=K.root.tween.bind(K.root),
Pc=Ab(null,"data:image/png;base64,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\x3d"),
Qc=Ab(null,"data:image/png;base64,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\x3d");
l.kaSprite=Pc;l.boomSprite=Qc;f(r,"fixedUpdateFrame");f(B,"updateFrame");class Ib{static $jscomp$static$block$510831985$53(){f(this,"Collision")}constructor(O,S,U,ea,Ja=!1){this.resolved=!1;this.source=O;this.target=S;this.normal=U;this.distance=ea;this.resolved=Ja}get displacement(){return this.normal.scale(this.distance)}reverse(){return new Ib(this.target,this.source,this.normal.scale(-1),this.distance,this.resolved)}hasOverlap(){return!this.displacement.isZero()}isLeft(){return 0<this.displacement.cross(K.gravity||
y(0,1))}isRight(){return 0>this.displacement.cross(K.gravity||y(0,1))}isTop(){return 0<this.displacement.dot(K.gravity||y(0,1))}isBottom(){return 0>this.displacement.dot(K.gravity||y(0,1))}preventResolution(){this.resolved=!0}}Ib.$jscomp$static$block$510831985$53();f(n,"checkFrame");f(v,"handleErr");f(u,"onCleanup");f(z,"quit");let rb=!0;H.run(()=>{try{L.loaded&&(fa.paused||r(),n())}catch(O){v(O)}},(O,S)=>{try{O(),L.loaded||1===cb()&&!rb&&(L.loaded=!0,qd().forEach(U=>K.events.trigger("loadError",
...U)),K.events.trigger("load")),!L.loaded&&!1!==a.loadingScreen||rb?(c(),bg(),e()):(fa.paused||B(),n(),c(),ag(),!1!==a.debug&&$f(),e()),rb&&(rb=!1),K.events.trigger("frameEnd"),S()}catch(U){v(U)}});Jd();ce();let Qa={_k:l,VERSION:"3001.0.0",loadRoot:Ff,loadProgress:cb,loadSprite:Ab,loadSpriteAtlas:Ad,loadSound:Tf,loadMusic:Uf,loadBitmapFont:Mf,loadFont:Kf,loadShader:Qf,loadShaderURL:Rf,loadAseprite:Jf,loadPedit:Nf,loadBean:If,loadJSON:Gf,load:wc,getSound:zd,getFont:wd,getBitmapFont:vd,getSprite:rd,
getShader:yd,getAsset:Hf,Asset:La,SpriteData:db,SoundData:Vb,width:sa,height:ta,center:Qb,dt:qa,fixedDt:tc,restDt:uc,time:H.time,screenshot:H.screenshot,record:k,isFocused:p,setCursor:H.setCursor,getCursor:H.getCursor,setCursorLocked:H.setCursorLocked,isCursorLocked:H.isCursorLocked,setFullscreen:H.setFullscreen,isFullscreen:H.isFullscreen,isTouchscreen:H.isTouchscreen,onLoad:Bc,onLoadError:Ag,onLoading:xg,onResize:yg,onGamepadConnect:H.onGamepadConnect,onGamepadDisconnect:H.onGamepadDisconnect,onError:zg,
onCleanup:u,flash:Wd,setCamPos:Qd,getCamPos:Rd,setCamRot:Ud,getCamRot:Vd,setCamScale:Sd,getCamScale:Td,getCamTransform:Bg,camPos:Eg,camScale:Fg,camFlash:Hg,camRot:Gg,camTransform:Cg,shake:Dg,toScreen:Cc,toWorld:Zd,setGravity:Ig,getGravity:Jg,setGravityDirection:Kg,getGravityDirection:Eb,setBackground:xf,getBackground:yf,getGamepads:H.getGamepads,getTreeRoot:Sg,add:D,make:Dc,destroy:Yd,destroyAll:I,get:ra,query:T,readd:J,pos:Xb,scale:$b,rotate:yh,color:Kd,opacity:Ld,anchor:Fc,area:lh,sprite:Ec,text:Xg,
polygon:mg,rect:Nd,circle:fg,uvquad:Yg,outline:jg,particles:kg,body:mh,platformEffector:sh,surfaceEffector:oh,areaEffector:ph,pointEffector:qh,buoyancyEffector:th,constantForce:rh,doubleJump:nh,shader:ng,textInput:kh,timer:Gc,fixed:Xd,stay:de,health:gh,lifespan:hh,named:ih,state:jh,z:zh,layer:vh,move:wh,offscreen:xh,follow:uh,fadeIn:hg,mask:ig,drawon:gg,raycast:Md,tile:Od,animate:ch,serializeAnimation:he,agent:Zg,sentry:bh,patrol:ah,pathfinder:$g,trigger:Ni,on:za,onFixedUpdate:Oi,onUpdate:Pi,onDraw:Qi,
onAdd:sg,onDestroy:Ri,onTag:tg,onUntag:Ui,onUse:Si,onUnuse:Ti,onClick:Vi,onCollide:pg,onCollideUpdate:qg,onCollideEnd:rg,onHover:ug,onHoverUpdate:vg,onHoverEnd:wg,onKeyDown:H.onKeyDown,onKeyPress:H.onKeyPress,onKeyPressRepeat:H.onKeyPressRepeat,onKeyRelease:H.onKeyRelease,onMouseDown:H.onMouseDown,onMousePress:H.onMousePress,onMouseRelease:H.onMouseRelease,onMouseMove:H.onMouseMove,onCharInput:H.onCharInput,onTouchStart:H.onTouchStart,onTouchMove:H.onTouchMove,onTouchEnd:H.onTouchEnd,onScroll:H.onScroll,
onHide:H.onHide,onShow:H.onShow,onGamepadButtonDown:H.onGamepadButtonDown,onGamepadButtonPress:H.onGamepadButtonPress,onGamepadButtonRelease:H.onGamepadButtonRelease,onGamepadStick:H.onGamepadStick,onButtonPress:H.onButtonPress,onButtonDown:H.onButtonDown,onButtonRelease:H.onButtonRelease,mousePos:pd,mouseDeltaPos:H.mouseDeltaPos,isKeyDown:H.isKeyDown,isKeyPressed:H.isKeyPressed,isKeyPressedRepeat:H.isKeyPressedRepeat,isKeyReleased:H.isKeyReleased,isMouseDown:H.isMouseDown,isMousePressed:H.isMousePressed,
isMouseReleased:H.isMouseReleased,isMouseMoved:H.isMouseMoved,isGamepadButtonPressed:H.isGamepadButtonPressed,isGamepadButtonDown:H.isGamepadButtonDown,isGamepadButtonReleased:H.isGamepadButtonReleased,getGamepadStick:H.getGamepadStick,isButtonPressed:H.isButtonPressed,isButtonDown:H.isButtonDown,isButtonReleased:H.isButtonReleased,setButton:H.setButton,getButton:H.getButton,pressButton:H.pressButton,releaseButton:H.releaseButton,getLastInputDeviceType:H.getLastInputDeviceType,charInputted:H.charInputted,
loop:oa,wait:va,play:Mg,setVolume:ae,getVolume:be,volume:Ng,burp:$d,audioCtx:Q.ctx,Line:Ca,Rect:ka,Circle:Da,Ellipse:Wa,Point:oi,Polygon:xa,Vec2:C,Color:Y,Mat4:Sa,Quad:la,RNG:ie,rand:pa,randi:Xc,randSeed:oe,vec2:y,rgb:R,hsl2rgb:ni,quad:na,choose:re,chooseMultiple:qe,shuffle:Yc,chance:pe,lerp:wa,tween:Oc,easings:ac,map:Oa,mapc:ne,wave:Vc,deg2rad:ca,rad2deg:Ba,clamp:Na,evaluateQuadratic:He,evaluateQuadraticFirstDerivative:Ie,evaluateQuadraticSecondDerivative:Je,evaluateBezier:mc,evaluateBezierFirstDerivative:Ke,
evaluateBezierSecondDerivative:Le,evaluateCatmullRom:Me,evaluateCatmullRomFirstDerivative:Ne,curveLengthApproximation:gd,normalizedCurve:Oe,hermite:ub,cardinal:hd,catmullRom:Pb,bezier:Pe,kochanekBartels:Qe,easingSteps:We,easingLinear:Ue,easingCubicBezier:Ve,testLineLine:fc,testRectRect:Zc,testRectLine:gc,testRectPoint:Kb,testCirclePolygon:Mb,testLinePoint:hc,testLineCircle:tb,isConvex:bf,triangulate:jd,NavMesh:Qh,drawSprite:dg,drawText:Id,formatText:gb,drawRect:Ha,drawLine:Bb,drawLines:yc,drawTriangle:Gd,
drawCircle:nb,drawEllipse:Bd,drawUVQuad:Cb,drawPolygon:Ya,drawCurve:Cd,drawBezier:Yf,drawFormattedText:hb,drawMasked:cg,drawSubtracted:eg,pushTransform:Ea,popTransform:ya,pushTranslate:ma,pushScale:zb,pushRotate:mb,pushMatrix:zf,usePostEffect:d,makeCanvas:b,debug:fa,scene:Tg,getSceneName:Wg,go:Ug,onSceneLeave:Vg,layers:Rg,getLayers:Pg,setLayers:fe,getDefaultLayer:Qg,addLevel:og,getData:g,setData:h,download:pc,downloadJSON:ef,downloadText:kd,downloadBlob:ld,plug:m,ASCII_CHARS:" !\"#$%\x26'()*+,-./0123456789:;\x3c\x3d\x3e?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",
canvas:H.canvas,addKaboom:Og,LEFT:C.LEFT,RIGHT:C.RIGHT,UP:C.UP,DOWN:C.DOWN,RED:Y.RED,GREEN:Y.GREEN,BLUE:Y.BLUE,YELLOW:Y.YELLOW,MAGENTA:Y.MAGENTA,CYAN:Y.CYAN,WHITE:Y.WHITE,BLACK:Y.BLACK,quit:z,KEvent:ua,KEventHandler:Db,KEventController:ob,cancel:f(()=>Bh,"cancel")};l.k=Qa;D=a.plugins;if(D&&D.forEach(m),!1!==a.global)for(let O in Qa)window[O]=Qa[O];return!1!==a.focus&&H.canvas.focus(),Qa},"kaplay")};
'use strict';var g;/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/
var aa=this||self;function t(a){var b=typeof a;return"object"!=b?b:a?Array.isArray(a)?"array":b:"null"}var ba="closure_uid_"+(1E9*Math.random()>>>0),ca=0;function da(a){const b=[];let c=0;for(const d in a)b[c++]=d;return b};function ea(a,b){null!=a&&this.append.apply(this,arguments)}g=ea.prototype;g.Ea="";g.set=function(a){this.Ea=""+a};g.append=function(a,b,c){this.Ea+=String(a);if(null!=b)for(let d=1;d<arguments.length;d++)this.Ea+=arguments[d];return this};g.clear=function(){this.Ea=""};g.toString=function(){return this.Ea};var u={},ha=null;function ia(){return new v(null,5,[ja,!0,ka,!0,la,!1,ma,!1,na,null],null)}function w(a){return null!=a&&!1!==a}function oa(a){return a instanceof Array}function x(a,b){return a[t(null==b?null:b)]?!0:a._?!0:!1}function z(a,b){var c=null==b?null:b.constructor;return Error(["No protocol method ",a," defined for type ",w(w(c)?c.Pb:c)?c.rb:t(b),": ",b].join(""))}function pa(a){var b=a.rb;return w(b)?b:A.i(a)}var qa="undefined"!==typeof Symbol&&"function"===t(Symbol)?Symbol.iterator:"@@iterator";
function ra(a){for(var b=a.length,c=Array(b),d=0;;)if(d<b)c[d]=a[d],d+=1;else break;return c}function sa(){}function ta(a){if(null!=a&&null!=a.Y)a=a.Y(a);else{var b=ta[t(null==a?null:a)];if(null!=b)a=b.i?b.i(a):b.call(null,a);else if(b=ta._,null!=b)a=b.i?b.i(a):b.call(null,a);else throw z("ICounted.-count",a);}return a}function ua(){}
function va(a){if(null!=a&&null!=a.Z)a=a.Z(a);else{var b=va[t(null==a?null:a)];if(null!=b)a=b.i?b.i(a):b.call(null,a);else if(b=va._,null!=b)a=b.i?b.i(a):b.call(null,a);else throw z("IEmptyableCollection.-empty",a);}return a}function wa(){}function xa(a,b){if(null!=a&&null!=a.X)a=a.X(a,b);else{var c=xa[t(null==a?null:a)];if(null!=c)a=c.j?c.j(a,b):c.call(null,a,b);else if(c=xa._,null!=c)a=c.j?c.j(a,b):c.call(null,a,b);else throw z("ICollection.-conj",a);}return a}function za(){}
var Aa=function(){function a(d,e,f){var h=C[t(null==d?null:d)];if(null!=h)return h.s?h.s(d,e,f):h.call(null,d,e,f);h=C._;if(null!=h)return h.s?h.s(d,e,f):h.call(null,d,e,f);throw z("IIndexed.-nth",d);}function b(d,e){var f=C[t(null==d?null:d)];if(null!=f)return f.j?f.j(d,e):f.call(null,d,e);f=C._;if(null!=f)return f.j?f.j(d,e):f.call(null,d,e);throw z("IIndexed.-nth",d);}var c=null;c=function(d,e,f){switch(arguments.length){case 2:return b.call(this,d,e);case 3:return a.call(this,d,e,f)}throw Error("Invalid arity: "+
arguments.length);};c.j=b;c.s=a;return c}(),C=function C(a){switch(arguments.length){case 2:return C.j(arguments[0],arguments[1]);case 3:return C.s(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",A.i(arguments.length)].join(""));}};C.j=function(a,b){return null!=a&&null!=a.W?a.W(a,b):Aa(a,b)};C.s=function(a,b,c){return null!=a&&null!=a.oa?a.oa(a,b,c):Aa(a,b,c)};C.fa=3;
function D(a){if(null!=a&&null!=a.ea)a=a.ea(a);else{var b=D[t(null==a?null:a)];if(null!=b)a=b.i?b.i(a):b.call(null,a);else if(b=D._,null!=b)a=b.i?b.i(a):b.call(null,a);else throw z("ISeq.-first",a);}return a}function F(a){if(null!=a&&null!=a.ja)a=a.ja(a);else{var b=F[t(null==a?null:a)];if(null!=b)a=b.i?b.i(a):b.call(null,a);else if(b=F._,null!=b)a=b.i?b.i(a):b.call(null,a);else throw z("ISeq.-rest",a);}return a}function Ba(){}function Ca(){}
var Ea=function(){function a(d,e,f){var h=Da[t(null==d?null:d)];if(null!=h)return h.s?h.s(d,e,f):h.call(null,d,e,f);h=Da._;if(null!=h)return h.s?h.s(d,e,f):h.call(null,d,e,f);throw z("ILookup.-lookup",d);}function b(d,e){var f=Da[t(null==d?null:d)];if(null!=f)return f.j?f.j(d,e):f.call(null,d,e);f=Da._;if(null!=f)return f.j?f.j(d,e):f.call(null,d,e);throw z("ILookup.-lookup",d);}var c=null;c=function(d,e,f){switch(arguments.length){case 2:return b.call(this,d,e);case 3:return a.call(this,d,e,f)}throw Error("Invalid arity: "+
arguments.length);};c.j=b;c.s=a;return c}(),Da=function Da(a){switch(arguments.length){case 2:return Da.j(arguments[0],arguments[1]);case 3:return Da.s(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",A.i(arguments.length)].join(""));}};Da.j=function(a,b){return null!=a&&null!=a.na?a.na(a,b):Ea(a,b)};Da.s=function(a,b,c){return null!=a&&null!=a.K?a.K(a,b,c):Ea(a,b,c)};Da.fa=3;function Fa(){}
function Ga(a,b){if(null!=a&&null!=a.Xa)a=a.Xa(a,b);else{var c=Ga[t(null==a?null:a)];if(null!=c)a=c.j?c.j(a,b):c.call(null,a,b);else if(c=Ga._,null!=c)a=c.j?c.j(a,b):c.call(null,a,b);else throw z("IAssociative.-contains-key?",a);}return a}function Ha(a,b,c){if(null!=a&&null!=a.Aa)a=a.Aa(a,b,c);else{var d=Ha[t(null==a?null:a)];if(null!=d)a=d.s?d.s(a,b,c):d.call(null,a,b,c);else if(d=Ha._,null!=d)a=d.s?d.s(a,b,c):d.call(null,a,b,c);else throw z("IAssociative.-assoc",a);}return a}function Ia(){}
function Ja(a){if(null!=a&&null!=a.Ib)a=a.key;else{var b=Ja[t(null==a?null:a)];if(null!=b)a=b.i?b.i(a):b.call(null,a);else if(b=Ja._,null!=b)a=b.i?b.i(a):b.call(null,a);else throw z("IMapEntry.-key",a);}return a}function Ka(a){if(null!=a&&null!=a.Jb)a=a.J;else{var b=Ka[t(null==a?null:a)];if(null!=b)a=b.i?b.i(a):b.call(null,a);else if(b=Ka._,null!=b)a=b.i?b.i(a):b.call(null,a);else throw z("IMapEntry.-val",a);}return a}function La(){}
function Ma(a){if(null!=a&&null!=a.Cb)a=a.J;else{var b=Ma[t(null==a?null:a)];if(null!=b)a=b.i?b.i(a):b.call(null,a);else if(b=Ma._,null!=b)a=b.i?b.i(a):b.call(null,a);else throw z("IDeref.-deref",a);}return a}function Na(){}function Oa(a){if(null!=a&&null!=a.T)a=a.T(a);else{var b=Oa[t(null==a?null:a)];if(null!=b)a=b.i?b.i(a):b.call(null,a);else if(b=Oa._,null!=b)a=b.i?b.i(a):b.call(null,a);else throw z("IMeta.-meta",a);}return a}
function Pa(a,b){if(null!=a&&null!=a.U)a=a.U(a,b);else{var c=Pa[t(null==a?null:a)];if(null!=c)a=c.j?c.j(a,b):c.call(null,a,b);else if(c=Pa._,null!=c)a=c.j?c.j(a,b):c.call(null,a,b);else throw z("IWithMeta.-with-meta",a);}return a}function Qa(){}
var Sa=function(){function a(d,e,f){var h=Ra[t(null==d?null:d)];if(null!=h)return h.s?h.s(d,e,f):h.call(null,d,e,f);h=Ra._;if(null!=h)return h.s?h.s(d,e,f):h.call(null,d,e,f);throw z("IReduce.-reduce",d);}function b(d,e){var f=Ra[t(null==d?null:d)];if(null!=f)return f.j?f.j(d,e):f.call(null,d,e);f=Ra._;if(null!=f)return f.j?f.j(d,e):f.call(null,d,e);throw z("IReduce.-reduce",d);}var c=null;c=function(d,e,f){switch(arguments.length){case 2:return b.call(this,d,e);case 3:return a.call(this,d,e,f)}throw Error("Invalid arity: "+
arguments.length);};c.j=b;c.s=a;return c}(),Ra=function Ra(a){switch(arguments.length){case 2:return Ra.j(arguments[0],arguments[1]);case 3:return Ra.s(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",A.i(arguments.length)].join(""));}};Ra.j=function(a,b){return null!=a&&null!=a.ca?a.ca(a,b):Sa(a,b)};Ra.s=function(a,b,c){return null!=a&&null!=a.da?a.da(a,b,c):Sa(a,b,c)};Ra.fa=3;function Ta(){}
function Ua(a,b){if(null!=a&&null!=a.lb)a=a.lb(a,b,!0);else{var c=Ua[t(null==a?null:a)];if(null!=c)a=c.s?c.s(a,b,!0):c.call(null,a,b,!0);else if(c=Ua._,null!=c)a=c.s?c.s(a,b,!0):c.call(null,a,b,!0);else throw z("IKVReduce.-kv-reduce",a);}return a}function Va(a,b){if(null!=a&&null!=a.O)a=a.O(a,b);else{var c=Va[t(null==a?null:a)];if(null!=c)a=c.j?c.j(a,b):c.call(null,a,b);else if(c=Va._,null!=c)a=c.j?c.j(a,b):c.call(null,a,b);else throw z("IEquiv.-equiv",a);}return a}
function Wa(a){if(null!=a&&null!=a.S)a=a.S(a);else{var b=Wa[t(null==a?null:a)];if(null!=b)a=b.i?b.i(a):b.call(null,a);else if(b=Wa._,null!=b)a=b.i?b.i(a):b.call(null,a);else throw z("IHash.-hash",a);}return a}function Xa(){}function Ya(a){if(null!=a&&null!=a.M)a=a.M(a);else{var b=Ya[t(null==a?null:a)];if(null!=b)a=b.i?b.i(a):b.call(null,a);else if(b=Ya._,null!=b)a=b.i?b.i(a):b.call(null,a);else throw z("ISeqable.-seq",a);}return a}function Za(){}function $a(){}function ab(){}
function G(a,b){if(null!=a&&null!=a.yb)a=a.yb(a,b);else{var c=G[t(null==a?null:a)];if(null!=c)a=c.j?c.j(a,b):c.call(null,a,b);else if(c=G._,null!=c)a=c.j?c.j(a,b):c.call(null,a,b);else throw z("IWriter.-write",a);}return a}function bb(){}function cb(a,b,c){if(null!=a&&null!=a.P)a=a.P(a,b,c);else{var d=cb[t(null==a?null:a)];if(null!=d)a=d.s?d.s(a,b,c):d.call(null,a,b,c);else if(d=cb._,null!=d)a=d.s?d.s(a,b,c):d.call(null,a,b,c);else throw z("IPrintWithWriter.-pr-writer",a);}return a}
function db(a){if(null!=a&&null!=a.$a)a=a.$a(a);else{var b=db[t(null==a?null:a)];if(null!=b)a=b.i?b.i(a):b.call(null,a);else if(b=db._,null!=b)a=b.i?b.i(a):b.call(null,a);else throw z("IEditableCollection.-as-transient",a);}return a}function eb(a,b){if(null!=a&&null!=a.cb)a=a.cb(a,b);else{var c=eb[t(null==a?null:a)];if(null!=c)a=c.j?c.j(a,b):c.call(null,a,b);else if(c=eb._,null!=c)a=c.j?c.j(a,b):c.call(null,a,b);else throw z("ITransientCollection.-conj!",a);}return a}
function fb(a){if(null!=a&&null!=a.mb)a=a.mb(a);else{var b=fb[t(null==a?null:a)];if(null!=b)a=b.i?b.i(a):b.call(null,a);else if(b=fb._,null!=b)a=b.i?b.i(a):b.call(null,a);else throw z("ITransientCollection.-persistent!",a);}return a}function gb(a,b,c){if(null!=a&&null!=a.Ya)a=a.Ya(a,b,c);else{var d=gb[t(null==a?null:a)];if(null!=d)a=d.s?d.s(a,b,c):d.call(null,a,b,c);else if(d=gb._,null!=d)a=d.s?d.s(a,b,c):d.call(null,a,b,c);else throw z("ITransientAssociative.-assoc!",a);}return a}
function hb(a){if(null!=a&&null!=a.tb)a=a.tb(a);else{var b=hb[t(null==a?null:a)];if(null!=b)a=b.i?b.i(a):b.call(null,a);else if(b=hb._,null!=b)a=b.i?b.i(a):b.call(null,a);else throw z("IChunk.-drop-first",a);}return a}function ib(a){if(null!=a&&null!=a.ob)a=a.ob(a);else{var b=ib[t(null==a?null:a)];if(null!=b)a=b.i?b.i(a):b.call(null,a);else if(b=ib._,null!=b)a=b.i?b.i(a):b.call(null,a);else throw z("IChunkedSeq.-chunked-first",a);}return a}
function jb(a){if(null!=a&&null!=a.kb)a=a.kb(a);else{var b=jb[t(null==a?null:a)];if(null!=b)a=b.i?b.i(a):b.call(null,a);else if(b=jb._,null!=b)a=b.i?b.i(a):b.call(null,a);else throw z("IChunkedSeq.-chunked-rest",a);}return a}function kb(){}function lb(a){if(null!=a&&null!=a.va)a=a.va(a);else{var b=lb[t(null==a?null:a)];if(null!=b)a=b.i?b.i(a):b.call(null,a);else if(b=lb._,null!=b)a=b.i?b.i(a):b.call(null,a);else throw z("IIterable.-iterator",a);}return a}
function mb(a){this.Rb=a;this.o=1073741824;this.D=0}mb.prototype.yb=function(a,b){return this.Rb.append(b)};function nb(a){var b=new ea;a.P(null,new mb(b),ia());return A.i(b)}var ob="undefined"!==typeof Math&&"undefined"!==typeof Math.imul?function(a,b){return Math.imul(a,b)}:function(a,b){var c=a&65535,d=b&65535;return c*d+((a>>>16&65535)*d+c*(b>>>16&65535)<<16>>>0)|0};function pb(a){a=ob(a|0,-862048943);return ob(a<<15|a>>>-15,461845907)}
function qb(a,b){a=(a|0)^(b|0);return ob(a<<13|a>>>-13,5)+-430675100|0}function rb(a,b){a=(a|0)^b;a=ob(a^a>>>16,-2048144789);a=ob(a^a>>>13,-1028477387);return a^a>>>16}function sb(a){a:{var b=1;for(var c=0;;)if(b<a.length)c=qb(c,pb(a.charCodeAt(b-1)|a.charCodeAt(b)<<16)),b+=2;else{b=c;break a}}return rb(1===(a.length&1)?b^pb(a.charCodeAt(a.length-1)):b,ob(2,a.length))}var tb={},ub=0;
function vb(a){255<ub&&(tb={},ub=0);if(null==a)return 0;var b=tb[a];if("number"===typeof b)a=b;else{a:if(null!=a)if(b=a.length,0<b)for(var c=0,d=0;;)if(c<b)d=ob(31,d)+a.charCodeAt(c),c+=1;else{b=d;break a}else b=0;else b=0;tb[a]=b;ub+=1;a=b}return a}
function wb(a){if(null!=a&&(a.o&4194304||u===a.Wb))return a.S(null)^0;if("number"===typeof a){if(isFinite(a)){if(Number.isSafeInteger(a))a=Math.floor(a)%2147483647;else{var b=new Float64Array(1);b[0]=a;b=b.buffer;a=(new DataView(b,0,4)).getInt32();b=(new DataView(b,4,4)).getInt32();a^=b}return a}switch(a){case Infinity:return 2146435072;case -Infinity:return-1048576;default:return 2146959360}}else return!0===a?a=1231:!1===a?a=1237:"string"===typeof a?(a=vb(a),a=0===a?a:rb(qb(0,pb(a)),4)):a=a instanceof
Date?a.valueOf()^0:null==a?0:Wa(a)^0,a}function xb(a,b){return a^b+2654435769+(a<<6)+(a>>2)}function yb(a,b,c,d,e){this.jb=a;this.name=b;this.Da=c;this.Wa=d;this.ua=e;this.o=2154168321;this.D=4096}g=yb.prototype;g.toString=function(){return this.Da};g.O=function(a,b){return b instanceof yb?this.Da===b.Da:!1};
g.call=function(a){switch(arguments.length-1){case 1:return this.i(arguments[1]);case 2:return this.j(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",A.i(arguments.length-1)].join(""));}};g.apply=function(a,b){return this.call.apply(this,[this].concat(ra(b)))};g.i=function(a){return zb?zb(a,this):Ab.call(null,a,this)};g.j=function(a,b){return Bb?Bb(a,this,b):Ab.call(null,a,this,b)};g.T=function(){return this.ua};g.U=function(a,b){return new yb(this.jb,this.name,this.Da,this.Wa,b)};
g.S=function(){var a=this.Wa;return null!=a?a:this.Wa=a=xb(sb(this.name),vb(this.jb))};g.P=function(a,b){return G(b,this.Da)};var Cb=function Cb(a){switch(arguments.length){case 1:return Cb.i(arguments[0]);case 2:return Cb.j(arguments[0],arguments[1]);default:throw Error(["Invalid arity: ",A.i(arguments.length)].join(""));}};
Cb.i=function(a){for(;;){if(a instanceof yb)return a;if("string"===typeof a){var b=a.indexOf("/");return 1>b?Cb.j(null,a):Cb.j(a.substring(0,b),a.substring(b+1,a.length))}if(a instanceof H)a=a.ya;else throw Error("no conversion to symbol");}};Cb.j=function(a,b){var c=null!=a?[A.i(a),"/",A.i(b)].join(""):b;return new yb(a,b,c,null,null)};Cb.fa=2;function Db(a){return null!=a?a.D&131072||u===a.Xb?!0:a.D?!1:x(kb,a):x(kb,a)}
function I(a){if(null==a)return null;if(null!=a&&(a.o&8388608||u===a.Nb))return a.M(null);if(oa(a)||"string"===typeof a)return 0===a.length?null:new K(a,0,null);if(null!=a&&null!=a[qa])return a=(null!==a&&qa in a?a[qa]:void 0).call(a),Eb.i?Eb.i(a):Eb.call(null,a);if(x(Xa,a))return Ya(a);throw Error([A.i(a)," is not ISeqable"].join(""));}function M(a){if(null==a)return null;if(null!=a&&(a.o&64||u===a.bb))return a.ea(null);a=I(a);return null==a?null:D(a)}
function Fb(a){return null!=a?null!=a&&(a.o&64||u===a.bb)?a.ja(null):(a=I(a))?a.ja(null):N:N}function P(a){return null==a?null:null!=a&&(a.o&128||u===a.ab)?a.aa():I(Fb(a))}var Q=function Q(a){switch(arguments.length){case 1:return Q.i(arguments[0]);case 2:return Q.j(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return Q.N(arguments[0],arguments[1],2<c.length?new K(c.slice(2),0,null):null)}};Q.i=function(){return!0};
Q.j=function(a,b){return null==a?null==b:a===b||Va(a,b)};Q.N=function(a,b,c){for(;;)if(Q.j(a,b))if(P(c))a=b,b=M(c),c=P(c);else return Q.j(b,M(c));else return!1};Q.$=function(a){var b=M(a),c=P(a);a=M(c);c=P(c);return this.N(b,a,c)};Q.fa=2;function Gb(a){this.G=a}Gb.prototype.next=function(){if(null!=this.G){var a=M(this.G);this.G=P(this.G);return{value:a,done:!1}}return{value:null,done:!0}};function Hb(a){return new Gb(I(a))}
function Ib(a,b){this.value=a;this.zb=b;this.nb=null;this.o=8388672;this.D=0}Ib.prototype.M=function(){return this};Ib.prototype.ea=function(){return this.value};Ib.prototype.ja=function(){null==this.nb&&(this.nb=Eb.i?Eb.i(this.zb):Eb.call(null,this.zb));return this.nb};function Eb(a){var b=a.next();return w(b.done)?null:new Ib(b.value,a)}function Jb(a){var b=0,c=1;for(a=I(a);;)if(null!=a)b+=1,c=ob(31,c)+wb(M(a))|0,a=P(a);else return rb(qb(0,pb(c)),b)}var Kb=rb(qb(0,pb(1)),0);
function Lb(a){var b=0,c=0;for(a=I(a);;)if(null!=a)b+=1,c=c+wb(M(a))|0,a=P(a);else return rb(qb(0,pb(c)),b)}var Mb=rb(qb(0,pb(0)),0);sa["null"]=!0;ta["null"]=function(){return 0};Date.prototype.O=function(a,b){return b instanceof Date&&this.valueOf()===b.valueOf()};Va.number=function(a,b){return a===b};Na["function"]=!0;Oa["function"]=function(){return null};Wa._=function(a){return Object.prototype.hasOwnProperty.call(a,ba)&&a[ba]||(a[ba]=++ca)};function Nb(){this.J=!1;this.o=32768;this.D=0}
Nb.prototype.Cb=function(){return this.J};function Ob(a){return a instanceof Nb}function Pb(a){return Ma(a)}function Qb(a,b){var c=a.length;if(0===a.length)return b.I?b.I():b.call(null);for(var d=a[0],e=1;;)if(e<c){var f=a[e];d=b.j?b.j(d,f):b.call(null,d,f);if(Ob(d))return Ma(d);e+=1}else return d}function Rb(a,b,c){var d=a.length,e=c;for(c=0;;)if(c<d){var f=a[c];e=b.j?b.j(e,f):b.call(null,e,f);if(Ob(e))return Ma(e);c+=1}else return e}
function Sb(a,b,c,d){for(var e=a.length;;)if(d<e){var f=a[d];c=b.j?b.j(c,f):b.call(null,c,f);if(Ob(c))return Ma(c);d+=1}else return c}function Tb(a){return null!=a?a.o&2||u===a.vb?!0:a.o?!1:x(sa,a):x(sa,a)}function Ub(a){return null!=a?a.o&16||u===a.wb?!0:a.o?!1:x(za,a):x(za,a)}function R(a,b,c){var d=S.i?S.i(a):S.call(null,a);if(c>=d)return-1;!(0<c)&&0>c&&(c+=d,c=0>c?0:c);for(;;)if(c<d){if(Q.j(Vb?Vb(a,c):Wb.call(null,a,c),b))return c;c+=1}else return-1}
function U(a,b,c){var d=S.i?S.i(a):S.call(null,a);if(0===d)return-1;0<c?(--d,c=d<c?d:c):c=0>c?d+c:c;for(;;)if(0<=c){if(Q.j(Vb?Vb(a,c):Wb.call(null,a,c),b))return c;--c}else return-1}function Xb(a,b){this.l=a;this.v=b}Xb.prototype.la=function(){return this.v<this.l.length};Xb.prototype.next=function(){var a=this.l[this.v];this.v+=1;return a};function K(a,b,c){this.l=a;this.v=b;this.B=c;this.o=166592766;this.D=401408}g=K.prototype;g.toString=function(){return nb(this)};
g.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return R(this,b,0);case 2:return R(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.i=function(b){return R(this,b,0)};a.j=function(b,c){return R(this,b,c)};return a}();
g.lastIndexOf=function(){function a(c){return U(this,c,S.i?S.i(this):S.call(null,this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return U(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.i=a;b.j=function(c,d){return U(this,c,d)};return b}();g.W=function(a,b){a=b+this.v;if(0<=a&&a<this.l.length)return this.l[a];throw Error("Index out of bounds");};g.oa=function(a,b,c){a=b+this.v;return 0<=a&&a<this.l.length?this.l[a]:c};
g.va=function(){return new Xb(this.l,this.v)};g.T=function(){return this.B};g.aa=function(){return this.v+1<this.l.length?new K(this.l,this.v+1,null):null};g.Y=function(){var a=this.l.length-this.v;return 0>a?0:a};g.S=function(){return Jb(this)};g.O=function(a,b){return Yb.j?Yb.j(this,b):Yb.call(null,this,b)};g.Z=function(){return N};g.ca=function(a,b){return Sb(this.l,b,this.l[this.v],this.v+1)};g.da=function(a,b,c){return Sb(this.l,b,c,this.v)};g.ea=function(){return this.l[this.v]};
g.ja=function(){return this.v+1<this.l.length?new K(this.l,this.v+1,null):N};g.M=function(){return this.v<this.l.length?this:null};g.U=function(a,b){return b===this.B?this:new K(this.l,this.v,b)};g.X=function(a,b){return V.j?V.j(b,this):V.call(null,b,this)};K.prototype[qa]=function(){return Hb(this)};function Zb(a){return 0<a.length?new K(a,0,null):null}Va._=function(a,b){return a===b};
var $b=function $b(a){switch(arguments.length){case 0:return $b.I();case 1:return $b.i(arguments[0]);case 2:return $b.j(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return $b.N(arguments[0],arguments[1],2<c.length?new K(c.slice(2),0,null):null)}};$b.I=function(){return ac};$b.i=function(a){return a};$b.j=function(a,b){return null!=a?xa(a,b):new bc(null,b,null,1,null)};
$b.N=function(a,b,c){for(;;)if(w(c))a=$b.j(a,b),b=M(c),c=P(c);else return $b.j(a,b)};$b.$=function(a){var b=M(a),c=P(a);a=M(c);c=P(c);return this.N(b,a,c)};$b.fa=2;function S(a){if(null!=a)if(null!=a&&(a.o&2||u===a.vb))a=a.Y(null);else if(oa(a))a=a.length;else if("string"===typeof a)a=a.length;else if(null!=a&&(a.o&8388608||u===a.Nb))a:{a=I(a);for(var b=0;;){if(Tb(a)){a=b+ta(a);break a}a=P(a);b+=1}}else a=ta(a);else a=0;return a}
function cc(a,b,c){for(;;){if(null==a)return c;if(0===b)return I(a)?M(a):c;if(Ub(a))return C(a,b,c);if(I(a))a=P(a),--b;else return c}}function Wb(a){switch(arguments.length){case 2:return Vb(arguments[0],arguments[1]);case 3:return dc(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",A.i(arguments.length)].join(""));}}
function Vb(a,b){if("number"!==typeof b)throw Error("Index argument to nth must be a number");if(null==a)return a;if(null!=a&&(a.o&16||u===a.wb))return a.W(null,b);if(oa(a)){if(-1<b&&b<a.length)return a[b|0];throw Error("Index out of bounds");}if("string"===typeof a){if(-1<b&&b<a.length)return a.charAt(b|0);throw Error("Index out of bounds");}if(null!=a&&(a.o&64||u===a.bb)||null!=a&&(a.o&16777216||u===a.xb)){if(0>b)throw Error("Index out of bounds");a:for(;;){if(null==a)throw Error("Index out of bounds");
if(0===b){if(I(a)){a=M(a);break a}throw Error("Index out of bounds");}if(Ub(a)){a=C(a,b);break a}if(I(a))a=P(a),--b;else throw Error("Index out of bounds");}return a}if(x(za,a))return C(a,b);throw Error(["nth not supported on this type ",A.i(pa(null==a?null:a.constructor))].join(""));}
function dc(a,b,c){if("number"!==typeof b)throw Error("Index argument to nth must be a number.");if(null==a)return c;if(null!=a&&(a.o&16||u===a.wb))return a.oa(null,b,c);if(oa(a))return-1<b&&b<a.length?a[b|0]:c;if("string"===typeof a)return-1<b&&b<a.length?a.charAt(b|0):c;if(null!=a&&(a.o&64||u===a.bb)||null!=a&&(a.o&16777216||u===a.xb))return 0>b?c:cc(a,b,c);if(x(za,a))return C(a,b,c);throw Error(["nth not supported on this type ",A.i(pa(null==a?null:a.constructor))].join(""));}
function Ab(a){switch(arguments.length){case 2:return zb(arguments[0],arguments[1]);case 3:return Bb(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",A.i(arguments.length)].join(""));}}function zb(a,b){return null==a?null:null!=a&&(a.o&256||u===a.Hb)?a.na(null,b):oa(a)?null!=b&&b<a.length?a[b|0]:null:"string"===typeof a?null!=b&&-1<b&&b<a.length?a.charAt(b|0):null:x(Ca,a)?Da(a,b):null}
function Bb(a,b,c){return null!=a?null!=a&&(a.o&256||u===a.Hb)?a.K(null,b,c):oa(a)?null!=b&&-1<b&&b<a.length?a[b|0]:c:"string"===typeof a?null!=b&&-1<b&&b<a.length?a.charAt(b|0):c:x(Ca,a)?Da(a,b,c):c:c}var ec=function ec(a){switch(arguments.length){case 3:return ec.s(arguments[0],arguments[1],arguments[2]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return ec.N(arguments[0],arguments[1],arguments[2],3<c.length?new K(c.slice(3),0,null):null)}};
ec.s=function(a,b,c){return null!=a&&(a.o&512||u===a.Bb)?a.Aa(null,b,c):null!=a?Ha(a,b,c):fc([b,c])};ec.N=function(a,b,c,d){for(;;)if(a=ec.s(a,b,c),w(d))b=M(d),c=M(P(d)),d=P(P(d));else return a};ec.$=function(a){var b=M(a),c=P(a);a=M(c);var d=P(c);c=M(d);d=P(d);return this.N(b,a,c,d)};ec.fa=3;function gc(a,b){this.A=a;this.B=b;this.o=393217;this.D=0}g=gc.prototype;g.T=function(){return this.B};g.U=function(a,b){return new gc(this.A,b)};
g.call=function(a){switch(arguments.length-1){case 0:return this.I();case 1:return this.i(arguments[1]);case 2:return this.j(arguments[1],arguments[2]);case 3:return this.s(arguments[1],arguments[2],arguments[3]);case 4:return this.ia(arguments[1],arguments[2],arguments[3],arguments[4]);case 5:return this.xa(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);case 6:return this.Qa(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]);case 7:return this.Ra(arguments[1],
arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7]);case 8:return this.Sa(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8]);case 9:return this.Ta(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9]);case 10:return this.Fa(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10]);
case 11:return this.Ga(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11]);case 12:return this.Ha(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12]);case 13:return this.Ia(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],
arguments[11],arguments[12],arguments[13]);case 14:return this.Ja(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14]);case 15:return this.Ka(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15]);case 16:return this.La(arguments[1],
arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16]);case 17:return this.Ma(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17]);case 18:return this.Na(arguments[1],arguments[2],
arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17],arguments[18]);case 19:return this.Oa(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17],arguments[18],arguments[19]);case 20:return this.Pa(arguments[1],
arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17],arguments[18],arguments[19],arguments[20]);case 21:return this.pb(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17],
arguments[18],arguments[19],arguments[20],arguments[21]);default:throw Error(["Invalid arity: ",A.i(arguments.length-1)].join(""));}};g.apply=function(a,b){return this.call.apply(this,[this].concat(ra(b)))};g.I=function(){return this.A.I?this.A.I():this.A.call(null)};g.i=function(a){return this.A.i?this.A.i(a):this.A.call(null,a)};g.j=function(a,b){return this.A.j?this.A.j(a,b):this.A.call(null,a,b)};g.s=function(a,b,c){return this.A.s?this.A.s(a,b,c):this.A.call(null,a,b,c)};
g.ia=function(a,b,c,d){return this.A.ia?this.A.ia(a,b,c,d):this.A.call(null,a,b,c,d)};g.xa=function(a,b,c,d,e){return this.A.xa?this.A.xa(a,b,c,d,e):this.A.call(null,a,b,c,d,e)};g.Qa=function(a,b,c,d,e,f){return this.A.Qa?this.A.Qa(a,b,c,d,e,f):this.A.call(null,a,b,c,d,e,f)};g.Ra=function(a,b,c,d,e,f,h){return this.A.Ra?this.A.Ra(a,b,c,d,e,f,h):this.A.call(null,a,b,c,d,e,f,h)};g.Sa=function(a,b,c,d,e,f,h,k){return this.A.Sa?this.A.Sa(a,b,c,d,e,f,h,k):this.A.call(null,a,b,c,d,e,f,h,k)};
g.Ta=function(a,b,c,d,e,f,h,k,l){return this.A.Ta?this.A.Ta(a,b,c,d,e,f,h,k,l):this.A.call(null,a,b,c,d,e,f,h,k,l)};g.Fa=function(a,b,c,d,e,f,h,k,l,m){return this.A.Fa?this.A.Fa(a,b,c,d,e,f,h,k,l,m):this.A.call(null,a,b,c,d,e,f,h,k,l,m)};g.Ga=function(a,b,c,d,e,f,h,k,l,m,n){return this.A.Ga?this.A.Ga(a,b,c,d,e,f,h,k,l,m,n):this.A.call(null,a,b,c,d,e,f,h,k,l,m,n)};g.Ha=function(a,b,c,d,e,f,h,k,l,m,n,p){return this.A.Ha?this.A.Ha(a,b,c,d,e,f,h,k,l,m,n,p):this.A.call(null,a,b,c,d,e,f,h,k,l,m,n,p)};
g.Ia=function(a,b,c,d,e,f,h,k,l,m,n,p,q){return this.A.Ia?this.A.Ia(a,b,c,d,e,f,h,k,l,m,n,p,q):this.A.call(null,a,b,c,d,e,f,h,k,l,m,n,p,q)};g.Ja=function(a,b,c,d,e,f,h,k,l,m,n,p,q,r){return this.A.Ja?this.A.Ja(a,b,c,d,e,f,h,k,l,m,n,p,q,r):this.A.call(null,a,b,c,d,e,f,h,k,l,m,n,p,q,r)};g.Ka=function(a,b,c,d,e,f,h,k,l,m,n,p,q,r,y){return this.A.Ka?this.A.Ka(a,b,c,d,e,f,h,k,l,m,n,p,q,r,y):this.A.call(null,a,b,c,d,e,f,h,k,l,m,n,p,q,r,y)};
g.La=function(a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B){return this.A.La?this.A.La(a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B):this.A.call(null,a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B)};g.Ma=function(a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E){return this.A.Ma?this.A.Ma(a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E):this.A.call(null,a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E)};g.Na=function(a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J){return this.A.Na?this.A.Na(a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J):this.A.call(null,a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J)};
g.Oa=function(a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J,O){return this.A.Oa?this.A.Oa(a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J,O):this.A.call(null,a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J,O)};g.Pa=function(a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J,O,T){return this.A.Pa?this.A.Pa(a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J,O,T):this.A.call(null,a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J,O,T)};
g.pb=function(a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J,O,T,fa){return hc.pb?hc.pb(this.A,a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J,O,new K([T,fa],0,null)):hc.call(null,this.A,a,b,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J,O,T,fa)};function ic(a,b){return"function"===typeof a?new gc(a,b):null==a?null:Pa(a,b)}function jc(a){var b=null!=a;return(b?null!=a?a.o&131072||u===a.Kb||(a.o?0:x(Na,a)):x(Na,a):b)?Oa(a):null}function kc(a){return null!=a?a.o&16777216||u===a.xb?!0:a.o?!1:x(Za,a):x(Za,a)}
function lc(a){return null==a?!1:null!=a?a.o&1024||u===a.Zb?!0:a.o?!1:x(Ia,a):x(Ia,a)}function mc(a){return null!=a?a.o&67108864||u===a.ac?!0:a.o?!1:x(ab,a):x(ab,a)}function nc(a){return null!=a?a.o&16384||u===a.bc?!0:a.o?!1:x(La,a):x(La,a)}function oc(a){return null!=a?a.D&512||u===a.Tb?!0:!1:!1}function pc(a,b,c,d,e){for(;;){if(0===e)return c;c[d]=a[b];d+=1;--e;b+=1}}var qc={};function rc(a){return null==a?!1:!1===a?!1:!0}
function sc(a,b){return null!=a&&(a.o&512||u===a.Bb)?a.Xa(null,b):x(Fa,a)?Ga(a,b):Bb(a,b,qc)===qc?!1:!0}function tc(a,b){var c=I(b);return c?(b=M(c),c=P(c),uc?uc(a,b,c):vc.call(null,a,b,c)):a.I?a.I():a.call(null)}function wc(a,b,c){for(c=I(c);;)if(c){var d=M(c);b=a.j?a.j(b,d):a.call(null,b,d);if(Ob(b))return Ma(b);c=P(c)}else return b}
function xc(a,b){a=lb(a);if(w(a.la()))for(var c=a.next();;)if(a.la()){var d=a.next();c=b.j?b.j(c,d):b.call(null,c,d);if(Ob(c))return Ma(c)}else return c;else return b.I?b.I():b.call(null)}function yc(a,b,c){for(a=lb(a);;)if(a.la()){var d=a.next();c=b.j?b.j(c,d):b.call(null,c,d);if(Ob(c))return Ma(c)}else return c}
function vc(a){switch(arguments.length){case 2:var b=arguments[0],c=arguments[1];return null!=c&&(c.o&524288||u===c.Mb)?c.ca(null,b):oa(c)?Qb(c,b):"string"===typeof c?Qb(c,b):x(Qa,c)?Ra(c,b):Db(c)?xc(c,b):tc(b,c);case 3:return uc(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",A.i(arguments.length)].join(""));}}
function uc(a,b,c){return null!=c&&(c.o&524288||u===c.Mb)?c.da(null,a,b):oa(c)?Rb(c,a,b):"string"===typeof c?Rb(c,a,b):x(Qa,c)?Ra(c,a,b):Db(c)?yc(c,a,b):wc(a,b,c)}function zc(a,b){return(null!=b?b.o&1048576||u===b.Gb||(b.o?0:x(Ta,b)):x(Ta,b))?Ua(b,a):uc(function(c,d){var e=Ja(d);d=Ka(d);return a.s?a.s(c,e,d):a.call(null,c,e,d)},!0,b)}function Ac(a){return a}function Bc(a){a=(a-a%2)/2;return 0<=a?Math.floor(a):Math.ceil(a)}
function Cc(a){a-=a>>1&1431655765;a=(a&858993459)+(a>>2&858993459);return 16843009*(a+(a>>4)&252645135)>>24}var A=function A(a){switch(arguments.length){case 0:return A.I();case 1:return A.i(arguments[0]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return A.N(arguments[0],1<c.length?new K(c.slice(1),0,null):null)}};A.I=function(){return""};A.i=function(a){return null==a?"":[a].join("")};
A.N=function(a,b){for(a=new ea(A.i(a));;)if(w(b))a=a.append(A.i(M(b))),b=P(b);else return a.toString()};A.$=function(a){var b=M(a);a=P(a);return this.N(b,a)};A.fa=1;function Yb(a,b){if(kc(b))if(Tb(a)&&Tb(b)&&S(a)!==S(b))a=!1;else a:for(a=I(a),b=I(b);;){if(null==a){a=null==b;break a}if(null!=b&&Q.j(M(a),M(b)))a=P(a),b=P(b);else{a=!1;break a}}else a=null;return rc(a)}function bc(a,b,c,d,e){this.B=a;this.first=b;this.za=c;this.count=d;this.C=e;this.o=65937646;this.D=8192}g=bc.prototype;g.toString=function(){return nb(this)};
g.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return R(this,b,0);case 2:return R(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.i=function(b){return R(this,b,0)};a.j=function(b,c){return R(this,b,c)};return a}();
g.lastIndexOf=function(){function a(c){return U(this,c,this.count)}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return U(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.i=a;b.j=function(c,d){return U(this,c,d)};return b}();g.T=function(){return this.B};g.aa=function(){return 1===this.count?null:this.za};g.Y=function(){return this.count};g.S=function(){var a=this.C;return null!=a?a:this.C=a=Jb(this)};g.O=function(a,b){return Yb(this,b)};
g.Z=function(){return Pa(N,this.B)};g.ca=function(a,b){return tc(b,this)};g.da=function(a,b,c){return wc(b,c,this)};g.ea=function(){return this.first};g.ja=function(){return 1===this.count?N:this.za};g.M=function(){return this};g.U=function(a,b){return b===this.B?this:new bc(b,this.first,this.za,this.count,this.C)};g.X=function(a,b){return new bc(this.B,b,this,this.count+1,null)};bc.prototype[qa]=function(){return Hb(this)};function Dc(a){this.B=a;this.o=65937614;this.D=8192}g=Dc.prototype;
g.toString=function(){return nb(this)};g.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return R(this,b,0);case 2:return R(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.i=function(b){return R(this,b,0)};a.j=function(b,c){return R(this,b,c)};return a}();
g.lastIndexOf=function(){function a(c){return U(this,c,S(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return U(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.i=a;b.j=function(c,d){return U(this,c,d)};return b}();g.T=function(){return this.B};g.aa=function(){return null};g.Y=function(){return 0};g.S=function(){return Kb};g.O=function(a,b){return(null!=b?b.o&33554432||u===b.Yb||(b.o?0:x($a,b)):x($a,b))||kc(b)?null==I(b):!1};g.Z=function(){return this};
g.ca=function(a,b){return tc(b,this)};g.da=function(a,b,c){return wc(b,c,this)};g.ea=function(){return null};g.ja=function(){return N};g.M=function(){return null};g.U=function(a,b){return b===this.B?this:new Dc(b)};g.X=function(a,b){return new bc(this.B,b,null,1,null)};var N=new Dc(null);Dc.prototype[qa]=function(){return Hb(this)};function Ec(a,b,c,d){this.B=a;this.first=b;this.za=c;this.C=d;this.o=65929452;this.D=8192}g=Ec.prototype;g.toString=function(){return nb(this)};
g.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return R(this,b,0);case 2:return R(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.i=function(b){return R(this,b,0)};a.j=function(b,c){return R(this,b,c)};return a}();
g.lastIndexOf=function(){function a(c){return U(this,c,S(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return U(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.i=a;b.j=function(c,d){return U(this,c,d)};return b}();g.T=function(){return this.B};g.aa=function(){return null==this.za?null:I(this.za)};g.S=function(){var a=this.C;return null!=a?a:this.C=a=Jb(this)};g.O=function(a,b){return Yb(this,b)};g.Z=function(){return N};
g.ca=function(a,b){return tc(b,this)};g.da=function(a,b,c){return wc(b,c,this)};g.ea=function(){return this.first};g.ja=function(){return null==this.za?N:this.za};g.M=function(){return this};g.U=function(a,b){return b===this.B?this:new Ec(b,this.first,this.za,this.C)};g.X=function(a,b){return new Ec(null,b,this,null)};Ec.prototype[qa]=function(){return Hb(this)};function V(a,b){return null==b?new bc(null,a,null,1,null):null!=b&&(b.o&64||u===b.bb)?new Ec(null,a,b,null):new Ec(null,a,I(b),null)}
function H(a,b,c,d){this.jb=a;this.name=b;this.ya=c;this.Wa=d;this.o=2153775105;this.D=4096}g=H.prototype;g.toString=function(){return[":",A.i(this.ya)].join("")};g.O=function(a,b){return b instanceof H?this.ya===b.ya:!1};g.call=function(a){switch(arguments.length-1){case 1:return this.i(arguments[1]);case 2:return this.j(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",A.i(arguments.length-1)].join(""));}};g.apply=function(a,b){return this.call.apply(this,[this].concat(ra(b)))};
g.i=function(a){return zb(a,this)};g.j=function(a,b){return Bb(a,this,b)};g.S=function(){var a=this.Wa;return null!=a?a:this.Wa=a=xb(sb(this.name),vb(this.jb))+2654435769|0};g.P=function(a,b){return G(b,[":",A.i(this.ya)].join(""))};function Fc(a){if(null!=a&&(a.D&4096||u===a.Lb))return a.jb;throw Error(["Doesn't support namespace: ",A.i(a)].join(""));}
var Gc=function Gc(a){switch(arguments.length){case 1:return Gc.i(arguments[0]);case 2:return Gc.j(arguments[0],arguments[1]);default:throw Error(["Invalid arity: ",A.i(arguments.length)].join(""));}};Gc.i=function(a){if(a instanceof H)return a;if(a instanceof yb)return new H(Fc(a),Hc.i?Hc.i(a):Hc.call(null,a),a.Da,null);if(Q.j("/",a))return new H(null,a,a,null);if("string"===typeof a){var b=a.split("/");return 2===b.length?new H(b[0],b[1],a,null):new H(null,b[0],a,null)}return null};
Gc.j=function(a,b){a=a instanceof H?Hc.i?Hc.i(a):Hc.call(null,a):a instanceof yb?Hc.i?Hc.i(a):Hc.call(null,a):a;b=b instanceof H?Hc.i?Hc.i(b):Hc.call(null,b):b instanceof yb?Hc.i?Hc.i(b):Hc.call(null,b):b;return new H(a,b,[w(a)?[A.i(a),"/"].join(""):null,A.i(b)].join(""),null)};Gc.fa=2;function Ic(a,b,c){this.B=a;this.eb=b;this.G=null;this.C=c;this.o=32374988;this.D=1}g=Ic.prototype;g.toString=function(){return nb(this)};
function Jc(a){null!=a.eb&&(a.G=a.eb.I?a.eb.I():a.eb.call(null),a.eb=null);return a.G}g.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return R(this,b,0);case 2:return R(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.i=function(b){return R(this,b,0)};a.j=function(b,c){return R(this,b,c)};return a}();
g.lastIndexOf=function(){function a(c){return U(this,c,S(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return U(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.i=a;b.j=function(c,d){return U(this,c,d)};return b}();g.T=function(){return this.B};g.aa=function(){this.M(null);return null==this.G?null:P(this.G)};g.S=function(){var a=this.C;return null!=a?a:this.C=a=Jb(this)};g.O=function(a,b){return Yb(this,b)};g.Z=function(){return Pa(N,this.B)};
g.ca=function(a,b){return tc(b,this)};g.da=function(a,b,c){return wc(b,c,this)};g.ea=function(){this.M(null);return null==this.G?null:M(this.G)};g.ja=function(){this.M(null);return null!=this.G?Fb(this.G):N};g.M=function(){Jc(this);if(null==this.G)return null;for(var a=this.G;;)if(a instanceof Ic)a=Jc(a);else return this.G=a,I(this.G)};g.U=function(a,b){var c=this;return b===this.B?c:new Ic(b,function(){return c.M(null)},this.C)};g.X=function(a,b){return V(b,this)};Ic.prototype[qa]=function(){return Hb(this)};
function Kc(a){this.buf=a;this.end=0;this.o=2;this.D=0}Kc.prototype.add=function(a){this.buf[this.end]=a;return this.end+=1};Kc.prototype.wa=function(){var a=new Lc(this.buf,0,this.end);this.buf=null;return a};Kc.prototype.Y=function(){return this.end};function Lc(a,b,c){this.l=a;this.V=b;this.end=c;this.o=524306;this.D=0}g=Lc.prototype;g.Y=function(){return this.end-this.V};g.W=function(a,b){return this.l[this.V+b]};g.oa=function(a,b,c){return 0<=b&&b<this.end-this.V?this.l[this.V+b]:c};
g.tb=function(){if(this.V===this.end)throw Error("-drop-first of empty chunk");return new Lc(this.l,this.V+1,this.end)};g.ca=function(a,b){return Sb(this.l,b,this.l[this.V],this.V+1)};g.da=function(a,b,c){return Sb(this.l,b,c,this.V)};function Mc(a,b,c,d){this.wa=a;this.ra=b;this.B=c;this.C=d;this.o=31850732;this.D=1536}g=Mc.prototype;g.toString=function(){return nb(this)};
g.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return R(this,b,0);case 2:return R(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.i=function(b){return R(this,b,0)};a.j=function(b,c){return R(this,b,c)};return a}();
g.lastIndexOf=function(){function a(c){return U(this,c,S(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return U(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.i=a;b.j=function(c,d){return U(this,c,d)};return b}();g.T=function(){return this.B};g.aa=function(){return 1<ta(this.wa)?new Mc(hb(this.wa),this.ra,null,null):null==this.ra?null:Ya(this.ra)};g.S=function(){var a=this.C;return null!=a?a:this.C=a=Jb(this)};
g.O=function(a,b){return Yb(this,b)};g.Z=function(){return N};g.ea=function(){return C(this.wa,0)};g.ja=function(){return 1<ta(this.wa)?new Mc(hb(this.wa),this.ra,null,null):null==this.ra?N:this.ra};g.M=function(){return this};g.ob=function(){return this.wa};g.kb=function(){return null==this.ra?N:this.ra};g.U=function(a,b){return b===this.B?this:new Mc(this.wa,this.ra,b,this.C)};g.X=function(a,b){return V(b,this)};g.ub=function(){return null==this.ra?null:this.ra};Mc.prototype[qa]=function(){return Hb(this)};
function Nc(a,b){return 0===ta(a)?b:new Mc(a,b,null,null)}function Oc(a,b){a.add(b)}function Pc(a,b){if(Tb(b))return S(b);var c=0;for(b=I(b);;)if(null!=b&&c<a)c+=1,b=P(b);else return c}var Qc=function Qc(a){if(null==a)return null;var c=P(a);return null==c?I(M(a)):V(M(a),Qc.i?Qc.i(c):Qc.call(null,c))};
function Rc(a,b,c){var d=I(c);if(0===b)return a.I?a.I():a.call(null);c=D(d);var e=F(d);if(1===b)return a.i?a.i(c):a.call(null,c);d=D(e);var f=F(e);if(2===b)return a.j?a.j(c,d):a.call(null,c,d);e=D(f);var h=F(f);if(3===b)return a.s?a.s(c,d,e):a.call(null,c,d,e);f=D(h);var k=F(h);if(4===b)return a.ia?a.ia(c,d,e,f):a.call(null,c,d,e,f);h=D(k);var l=F(k);if(5===b)return a.xa?a.xa(c,d,e,f,h):a.call(null,c,d,e,f,h);k=D(l);var m=F(l);if(6===b)return a.Qa?a.Qa(c,d,e,f,h,k):a.call(null,c,d,e,f,h,k);l=D(m);
var n=F(m);if(7===b)return a.Ra?a.Ra(c,d,e,f,h,k,l):a.call(null,c,d,e,f,h,k,l);m=D(n);var p=F(n);if(8===b)return a.Sa?a.Sa(c,d,e,f,h,k,l,m):a.call(null,c,d,e,f,h,k,l,m);n=D(p);var q=F(p);if(9===b)return a.Ta?a.Ta(c,d,e,f,h,k,l,m,n):a.call(null,c,d,e,f,h,k,l,m,n);p=D(q);var r=F(q);if(10===b)return a.Fa?a.Fa(c,d,e,f,h,k,l,m,n,p):a.call(null,c,d,e,f,h,k,l,m,n,p);q=D(r);var y=F(r);if(11===b)return a.Ga?a.Ga(c,d,e,f,h,k,l,m,n,p,q):a.call(null,c,d,e,f,h,k,l,m,n,p,q);r=D(y);var B=F(y);if(12===b)return a.Ha?
a.Ha(c,d,e,f,h,k,l,m,n,p,q,r):a.call(null,c,d,e,f,h,k,l,m,n,p,q,r);y=D(B);var E=F(B);if(13===b)return a.Ia?a.Ia(c,d,e,f,h,k,l,m,n,p,q,r,y):a.call(null,c,d,e,f,h,k,l,m,n,p,q,r,y);B=D(E);var J=F(E);if(14===b)return a.Ja?a.Ja(c,d,e,f,h,k,l,m,n,p,q,r,y,B):a.call(null,c,d,e,f,h,k,l,m,n,p,q,r,y,B);E=D(J);var O=F(J);if(15===b)return a.Ka?a.Ka(c,d,e,f,h,k,l,m,n,p,q,r,y,B,E):a.call(null,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E);J=D(O);var T=F(O);if(16===b)return a.La?a.La(c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J):a.call(null,
c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J);O=D(T);var fa=F(T);if(17===b)return a.Ma?a.Ma(c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J,O):a.call(null,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J,O);T=D(fa);var ya=F(fa);if(18===b)return a.Na?a.Na(c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J,O,T):a.call(null,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J,O,T);fa=D(ya);ya=F(ya);if(19===b)return a.Oa?a.Oa(c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J,O,T,fa):a.call(null,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J,O,T,fa);var ue=D(ya);F(ya);if(20===b)return a.Pa?a.Pa(c,d,e,f,h,k,l,m,n,p,q,r,
y,B,E,J,O,T,fa,ue):a.call(null,c,d,e,f,h,k,l,m,n,p,q,r,y,B,E,J,O,T,fa,ue);throw Error("Only up to 20 arguments supported on functions");}function Sc(a){return null!=a&&(a.o&128||u===a.ab)?a.aa():I(Fb(a))}function Tc(a,b,c){return null==c?a.i?a.i(b):a.call(a,b):Uc(a,b,D(c),Sc(c))}function Uc(a,b,c,d){return null==d?a.j?a.j(b,c):a.call(a,b,c):Vc(a,b,c,D(d),Sc(d))}function Vc(a,b,c,d,e){return null==e?a.s?a.s(b,c,d):a.call(a,b,c,d):Wc(a,b,c,d,D(e),Sc(e))}
function Wc(a,b,c,d,e,f){if(null==f)return a.ia?a.ia(b,c,d,e):a.call(a,b,c,d,e);var h=D(f),k=P(f);if(null==k)return a.xa?a.xa(b,c,d,e,h):a.call(a,b,c,d,e,h);f=D(k);var l=P(k);if(null==l)return a.Qa?a.Qa(b,c,d,e,h,f):a.call(a,b,c,d,e,h,f);k=D(l);var m=P(l);if(null==m)return a.Ra?a.Ra(b,c,d,e,h,f,k):a.call(a,b,c,d,e,h,f,k);l=D(m);var n=P(m);if(null==n)return a.Sa?a.Sa(b,c,d,e,h,f,k,l):a.call(a,b,c,d,e,h,f,k,l);m=D(n);var p=P(n);if(null==p)return a.Ta?a.Ta(b,c,d,e,h,f,k,l,m):a.call(a,b,c,d,e,h,f,k,l,
m);n=D(p);var q=P(p);if(null==q)return a.Fa?a.Fa(b,c,d,e,h,f,k,l,m,n):a.call(a,b,c,d,e,h,f,k,l,m,n);p=D(q);var r=P(q);if(null==r)return a.Ga?a.Ga(b,c,d,e,h,f,k,l,m,n,p):a.call(a,b,c,d,e,h,f,k,l,m,n,p);q=D(r);var y=P(r);if(null==y)return a.Ha?a.Ha(b,c,d,e,h,f,k,l,m,n,p,q):a.call(a,b,c,d,e,h,f,k,l,m,n,p,q);r=D(y);var B=P(y);if(null==B)return a.Ia?a.Ia(b,c,d,e,h,f,k,l,m,n,p,q,r):a.call(a,b,c,d,e,h,f,k,l,m,n,p,q,r);y=D(B);var E=P(B);if(null==E)return a.Ja?a.Ja(b,c,d,e,h,f,k,l,m,n,p,q,r,y):a.call(a,b,
c,d,e,h,f,k,l,m,n,p,q,r,y);B=D(E);var J=P(E);if(null==J)return a.Ka?a.Ka(b,c,d,e,h,f,k,l,m,n,p,q,r,y,B):a.call(a,b,c,d,e,h,f,k,l,m,n,p,q,r,y,B);E=D(J);var O=P(J);if(null==O)return a.La?a.La(b,c,d,e,h,f,k,l,m,n,p,q,r,y,B,E):a.call(a,b,c,d,e,h,f,k,l,m,n,p,q,r,y,B,E);J=D(O);var T=P(O);if(null==T)return a.Ma?a.Ma(b,c,d,e,h,f,k,l,m,n,p,q,r,y,B,E,J):a.call(a,b,c,d,e,h,f,k,l,m,n,p,q,r,y,B,E,J);O=D(T);var fa=P(T);if(null==fa)return a.Na?a.Na(b,c,d,e,h,f,k,l,m,n,p,q,r,y,B,E,J,O):a.call(a,b,c,d,e,h,f,k,l,m,
n,p,q,r,y,B,E,J,O);T=D(fa);var ya=P(fa);if(null==ya)return a.Oa?a.Oa(b,c,d,e,h,f,k,l,m,n,p,q,r,y,B,E,J,O,T):a.call(a,b,c,d,e,h,f,k,l,m,n,p,q,r,y,B,E,J,O,T);fa=D(ya);ya=P(ya);if(null==ya)return a.Pa?a.Pa(b,c,d,e,h,f,k,l,m,n,p,q,r,y,B,E,J,O,T,fa):a.call(a,b,c,d,e,h,f,k,l,m,n,p,q,r,y,B,E,J,O,T,fa);b=[b,c,d,e,h,f,k,l,m,n,p,q,r,y,B,E,J,O,T,fa];for(c=ya;;)if(c)b.push(D(c)),c=P(c);else break;return a.apply(a,b)}
function hc(a){switch(arguments.length){case 2:return Xc(arguments[0],arguments[1]);case 3:return Yc(arguments[0],arguments[1],arguments[2]);case 4:var b=arguments[0];var c=arguments[1],d=arguments[2],e=arguments[3];b.$?(c=V(c,V(d,e)),d=b.fa,e=2+Pc(d-1,e),b=e<=d?Rc(b,e,c):b.$(c)):b=Uc(b,c,d,I(e));return b;case 5:b=arguments[0];c=arguments[1];d=arguments[2];var f=arguments[3];e=arguments[4];b.$?(c=V(c,V(d,V(f,e))),d=b.fa,e=3+Pc(d-2,e),b=e<=d?Rc(b,e,c):b.$(c)):b=Vc(b,c,d,f,I(e));return b;default:e=
[];b=arguments.length;for(c=0;;)if(c<b)e.push(arguments[c]),c+=1;else break;b=arguments[0];c=arguments[1];d=arguments[2];f=arguments[3];var h=arguments[4];e=5<e.length?new K(e.slice(5),0,null):null;b.$?(e=Qc(e),c=V(c,V(d,V(f,V(h,e)))),d=b.fa,e=4+Pc(d-3,e),b=e<=d?Rc(b,e,c):b.$(c)):b=Wc(b,c,d,f,h,Qc(e));return b}}function Xc(a,b){if(a.$){var c=a.fa,d=Pc(c+1,b);return d<=c?Rc(a,d,b):a.$(b)}b=I(b);return null==b?a.I?a.I():a.call(a):Tc(a,D(b),Sc(b))}
function Yc(a,b,c){if(a.$){b=V(b,c);var d=a.fa;c=Pc(d,c)+1;return c<=d?Rc(a,c,b):a.$(b)}return Tc(a,b,I(c))}function Zc(a){if(null!=a&&(a.o&64||u===a.bb))if(P(a)){a:{var b=[];for(a=I(a);;)if(null!=a)b.push(M(a)),a=P(a);else break a}b=fc(b)}else b=I(a)?M(a):$c;else b=a;return b}function ad(a){this.Qb=a;this.o=393216;this.D=0}g=ad.prototype;g.U=function(a,b){return new ad(b)};g.T=function(){return this.Qb};g.la=function(){return!1};g.next=function(){return Error("No such element")};g.remove=function(){return Error("Unsupported operation")};
function bd(a,b){for(;;){if(null==I(b))return!0;var c=M(b);c=a.i?a.i(c):a.call(null,c);if(w(c))b=P(b);else return!1}}
var W=function W(a){switch(arguments.length){case 1:return W.i(arguments[0]);case 2:return W.j(arguments[0],arguments[1]);case 3:return W.s(arguments[0],arguments[1],arguments[2]);case 4:return W.ia(arguments[0],arguments[1],arguments[2],arguments[3]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return W.N(arguments[0],arguments[1],arguments[2],arguments[3],4<c.length?new K(c.slice(4),0,null):null)}};
W.i=function(a){return function(b){return function(){function c(k,l){l=a.i?a.i(l):a.call(null,l);return b.j?b.j(k,l):b.call(null,k,l)}function d(k){return b.i?b.i(k):b.call(null,k)}function e(){return b.I?b.I():b.call(null)}var f=null,h=function(){function k(m,n,p){var q=null;if(2<arguments.length){q=0;for(var r=Array(arguments.length-2);q<r.length;)r[q]=arguments[q+2],++q;q=new K(r,0,null)}return l.call(this,m,n,q)}function l(m,n,p){n=Yc(a,n,p);return b.j?b.j(m,n):b.call(null,m,n)}k.fa=2;k.$=function(m){var n=
M(m);m=P(m);var p=M(m);m=Fb(m);return l(n,p,m)};k.N=l;return k}();f=function(k,l,m){switch(arguments.length){case 0:return e.call(this);case 1:return d.call(this,k);case 2:return c.call(this,k,l);default:var n=null;if(2<arguments.length){n=0;for(var p=Array(arguments.length-2);n<p.length;)p[n]=arguments[n+2],++n;n=new K(p,0,null)}return h.N(k,l,n)}throw Error("Invalid arity: "+arguments.length);};f.fa=2;f.$=h.$;f.I=e;f.i=d;f.j=c;f.N=h.N;return f}()}};
W.j=function(a,b){return new Ic(null,function(){var c=I(b);if(c){if(oc(c)){for(var d=ib(c),e=S(d),f=new Kc(Array(e)),h=0;;)if(h<e)Oc(f,function(){var k=C(d,h);return a.i?a.i(k):a.call(null,k)}()),h+=1;else break;return Nc(f.wa(),W.j(a,jb(c)))}return V(function(){var k=M(c);return a.i?a.i(k):a.call(null,k)}(),W.j(a,Fb(c)))}return null},null)};
W.s=function(a,b,c){return new Ic(null,function(){var d=I(b),e=I(c);if(d&&e){var f=M(d);var h=M(e);f=a.j?a.j(f,h):a.call(null,f,h);d=V(f,W.s(a,Fb(d),Fb(e)))}else d=null;return d},null)};W.ia=function(a,b,c,d){return new Ic(null,function(){var e=I(b),f=I(c),h=I(d);if(e&&f&&h){var k=M(e);var l=M(f),m=M(h);k=a.s?a.s(k,l,m):a.call(null,k,l,m);e=V(k,W.ia(a,Fb(e),Fb(f),Fb(h)))}else e=null;return e},null)};
W.N=function(a,b,c,d,e){return W.j(function(f){return Xc(a,f)},function k(h){return new Ic(null,function(){var l=W.j(I,h);return bd(Ac,l)?V(W.j(M,l),k(W.j(Fb,l))):null},null)}($b.N(e,d,Zb([c,b]))))};W.$=function(a){var b=M(a),c=P(a);a=M(c);var d=P(c);c=M(d);var e=P(d);d=M(e);e=P(e);return this.N(b,a,c,d,e)};W.fa=4;function cd(a,b){return null!=a?null!=a&&(a.D&4||u===a.Vb)?Pa(fb(uc(eb,db(a),b)),jc(a)):uc(xa,a,b):uc($b,a,b)}function dd(a,b){this.H=a;this.l=b}
function ed(a){return new dd(a,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null])}function fd(a){a=a.u;return 32>a?0:a-1>>>5<<5}function gd(a,b,c){for(;;){if(0===b)return c;var d=ed(a);d.l[0]=c;c=d;b-=5}}var hd=function hd(a,b,c,d){var f=new dd(c.H,ra(c.l)),h=a.u-1>>>b&31;5===b?f.l[h]=d:(c=c.l[h],null!=c?(b-=5,a=hd.ia?hd.ia(a,b,c,d):hd.call(null,a,b,c,d)):a=gd(null,b-5,d),f.l[h]=a);return f};
function id(a,b){if(b>=fd(a))return a.ha;var c=a.root;for(a=a.shift;;)if(0<a){var d=a-5;c=c.l[b>>>a&31];a=d}else return c.l}function jd(a,b){if(0<=b&&b<a.u)b=id(a,b);else throw a=a.u,Error(["No item ",A.i(b)," in vector of length ",A.i(a)].join(""));return b}var kd=function kd(a,b,c,d,e){var h=new dd(c.H,ra(c.l));if(0===b)h.l[d&31]=e;else{var k=d>>>b&31;b-=5;c=c.l[k];a=kd.xa?kd.xa(a,b,c,d,e):kd.call(null,a,b,c,d,e);h.l[k]=a}return h};
function ld(a,b,c){this.base=this.v=0;this.l=a;this.Sb=b;this.start=0;this.end=c}ld.prototype.la=function(){return this.v<this.end};ld.prototype.next=function(){32===this.v-this.base&&(this.l=id(this.Sb,this.v),this.base+=32);var a=this.l[this.v&31];this.v+=1;return a};function md(a,b,c,d){return c<d?nd(a,b,Vb(a,c),c+1,d):b.I?b.I():b.call(null)}
function nd(a,b,c,d,e){var f=c;c=d;for(d=id(a,d);;)if(c<e){var h=c&31;d=0===h?id(a,c):d;h=d[h];f=b.j?b.j(f,h):b.call(null,f,h);if(Ob(f))return Ma(f);c+=1}else return f}function X(a,b,c,d,e,f){this.B=a;this.u=b;this.shift=c;this.root=d;this.ha=e;this.C=f;this.o=167666463;this.D=401412}g=X.prototype;g.toString=function(){return nb(this)};
g.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return R(this,b,0);case 2:return R(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.i=function(b){return R(this,b,0)};a.j=function(b,c){return R(this,b,c)};return a}();
g.lastIndexOf=function(){function a(c){return U(this,c,S(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return U(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.i=a;b.j=function(c,d){return U(this,c,d)};return b}();g.na=function(a,b){return this.K(null,b,null)};g.K=function(a,b,c){return"number"===typeof b?this.oa(null,b,c):c};
g.lb=function(a,b,c){a=0;for(var d=c;;)if(a<this.u){var e=id(this,a);c=e.length;a:for(var f=0;;)if(f<c){var h=f+a,k=e[f];d=b.s?b.s(d,h,k):b.call(null,d,h,k);if(Ob(d)){e=d;break a}f+=1}else{e=d;break a}if(Ob(e))return Ma(e);a+=c;d=e}else return d};g.W=function(a,b){return jd(this,b)[b&31]};g.oa=function(a,b,c){return 0<=b&&b<this.u?id(this,b)[b&31]:c};
g.qb=function(a,b){if(0<=a&&a<this.u){if(fd(this)<=a){var c=ra(this.ha);c[a&31]=b;return new X(this.B,this.u,this.shift,this.root,c,null)}return new X(this.B,this.u,this.shift,kd(this,this.shift,this.root,a,b),this.ha,null)}if(a===this.u)return this.X(null,b);throw Error(["Index ",A.i(a)," out of bounds  [0,",A.i(this.u),"]"].join(""));};g.va=function(){var a=this.u;return new ld(0<S(this)?id(this,0):null,this,a)};g.T=function(){return this.B};g.Y=function(){return this.u};
g.S=function(){var a=this.C;return null!=a?a:this.C=a=Jb(this)};g.O=function(a,b){if(b instanceof X)if(this.u===S(b))for(a=this.va(null),b=b.va(null);;)if(a.la()){var c=a.next(),d=b.next();if(!Q.j(c,d))return!1}else return!0;else return!1;else return Yb(this,b)};g.$a=function(){return new od(this.u,this.shift,pd.i?pd.i(this.root):pd.call(null,this.root),qd.i?qd.i(this.ha):qd.call(null,this.ha))};g.Z=function(){return Pa(ac,this.B)};g.ca=function(a,b){return md(this,b,0,this.u)};
g.da=function(a,b,c){a=0;for(var d=c;;)if(a<this.u){var e=id(this,a);c=e.length;a:for(var f=0;;)if(f<c){var h=e[f];d=b.j?b.j(d,h):b.call(null,d,h);if(Ob(d)){e=d;break a}f+=1}else{e=d;break a}if(Ob(e))return Ma(e);a+=c;d=e}else return d};g.Aa=function(a,b,c){if("number"===typeof b)return this.qb(b,c);throw Error("Vector's key for assoc must be a number.");};g.Xa=function(a,b){return"number"!==typeof b||isNaN(b)||Infinity===b||parseFloat(b)!==parseInt(b,10)?!1:0<=b&&b<this.u};
g.M=function(){if(0===this.u)return null;if(32>=this.u)return new K(this.ha,0,null);a:{var a=this.root;for(var b=this.shift;;)if(0<b)b-=5,a=a.l[0];else{a=a.l;break a}}return rd?rd(this,a,0,0):sd.call(null,this,a,0,0)};g.U=function(a,b){return b===this.B?this:new X(b,this.u,this.shift,this.root,this.ha,this.C)};
g.X=function(a,b){if(32>this.u-fd(this)){a=this.ha.length;for(var c=Array(a+1),d=0;;)if(d<a)c[d]=this.ha[d],d+=1;else break;c[a]=b;return new X(this.B,this.u+1,this.shift,this.root,c,null)}a=(c=this.u>>>5>1<<this.shift)?this.shift+5:this.shift;c?(c=ed(null),c.l[0]=this.root,d=gd(null,this.shift,new dd(null,this.ha)),c.l[1]=d):c=hd(this,this.shift,this.root,new dd(null,this.ha));return new X(this.B,this.u+1,a,c,[b],null)};
g.call=function(a){switch(arguments.length-1){case 1:return this.i(arguments[1]);default:throw Error(["Invalid arity: ",A.i(arguments.length-1)].join(""));}};g.apply=function(a,b){return this.call.apply(this,[this].concat(ra(b)))};g.i=function(a){if("number"===typeof a)return this.W(null,a);throw Error("Key must be integer");};
var Y=new dd(null,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]),ac=new X(null,0,5,Y,[],Kb);X.prototype[qa]=function(){return Hb(this)};function td(a,b,c,d,e){this.ma=a;this.node=b;this.v=c;this.V=d;this.B=e;this.C=null;this.o=32375020;this.D=263680}g=td.prototype;g.toString=function(){return nb(this)};
g.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return R(this,b,0);case 2:return R(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.i=function(b){return R(this,b,0)};a.j=function(b,c){return R(this,b,c)};return a}();
g.lastIndexOf=function(){function a(c){return U(this,c,S(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return U(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.i=a;b.j=function(c,d){return U(this,c,d)};return b}();g.T=function(){return this.B};g.aa=function(){if(this.V+1<this.node.length){var a=this.ma;var b=this.node,c=this.v,d=this.V+1;a=rd?rd(a,b,c,d):sd.call(null,a,b,c,d);return null==a?null:a}return this.ub()};
g.S=function(){var a=this.C;return null!=a?a:this.C=a=Jb(this)};g.O=function(a,b){return Yb(this,b)};g.Z=function(){return N};g.ca=function(a,b){return md(this.ma,b,this.v+this.V,S(this.ma))};g.da=function(a,b,c){return nd(this.ma,b,c,this.v+this.V,S(this.ma))};g.ea=function(){return this.node[this.V]};g.ja=function(){if(this.V+1<this.node.length){var a=this.ma;var b=this.node,c=this.v,d=this.V+1;a=rd?rd(a,b,c,d):sd.call(null,a,b,c,d);return null==a?N:a}return this.kb(null)};g.M=function(){return this};
g.ob=function(){var a=this.node;return new Lc(a,this.V,a.length)};g.kb=function(){var a=this.v+this.node.length;if(a<ta(this.ma)){var b=this.ma,c=id(this.ma,a);return rd?rd(b,c,a,0):sd.call(null,b,c,a,0)}return N};g.U=function(a,b){return b===this.B?this:ud?ud(this.ma,this.node,this.v,this.V,b):sd.call(null,this.ma,this.node,this.v,this.V,b)};g.X=function(a,b){return V(b,this)};
g.ub=function(){var a=this.v+this.node.length;if(a<ta(this.ma)){var b=this.ma,c=id(this.ma,a);return rd?rd(b,c,a,0):sd.call(null,b,c,a,0)}return null};td.prototype[qa]=function(){return Hb(this)};
function sd(a){switch(arguments.length){case 3:var b=arguments[0],c=arguments[1],d=arguments[2];return new td(b,jd(b,c),c,d,null);case 4:return rd(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return ud(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);default:throw Error(["Invalid arity: ",A.i(arguments.length)].join(""));}}function rd(a,b,c,d){return new td(a,b,c,d,null)}function ud(a,b,c,d,e){return new td(a,b,c,d,e)}
function vd(a,b){return a===b.H?b:new dd(a,ra(b.l))}function pd(a){return new dd({},ra(a.l))}function qd(a){var b=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];pc(a,0,b,0,a.length);return b}var wd=function wd(a,b,c,d){c=vd(a.root.H,c);var f=a.u-1>>>b&31;if(5===b)a=d;else{var h=c.l[f];null!=h?(b-=5,a=wd.ia?wd.ia(a,b,h,d):wd.call(null,a,b,h,d)):a=gd(a.root.H,b-5,d)}c.l[f]=a;return c};
function od(a,b,c,d){this.u=a;this.shift=b;this.root=c;this.ha=d;this.D=88;this.o=275}g=od.prototype;
g.cb=function(a,b){if(this.root.H){if(32>this.u-fd(this))this.ha[this.u&31]=b;else{a=new dd(this.root.H,this.ha);var c=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];c[0]=b;this.ha=c;this.u>>>5>1<<this.shift?(b=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],c=this.shift+
5,b[0]=this.root,b[1]=gd(this.root.H,this.shift,a),this.root=new dd(this.root.H,b),this.shift=c):this.root=wd(this,this.shift,this.root,a)}this.u+=1;return this}throw Error("conj! after persistent!");};g.mb=function(){if(this.root.H){this.root.H=null;var a=this.u-fd(this),b=Array(a);pc(this.ha,0,b,0,a);return new X(null,this.u,this.shift,this.root,b,null)}throw Error("persistent! called twice");};
g.Ya=function(a,b,c){if("number"===typeof b)return xd(this,b,c);throw Error("TransientVector's key for assoc! must be a number.");};
function xd(a,b,c){if(a.root.H){if(0<=b&&b<a.u){if(fd(a)<=b)a.ha[b&31]=c;else{var d=function k(f,h){h=vd(a.root.H,h);if(0===f)h.l[b&31]=c;else{var l=b>>>f&31;f=k(f-5,h.l[l]);h.l[l]=f}return h}(a.shift,a.root);a.root=d}return a}if(b===a.u)return a.cb(null,c);throw Error(["Index ",A.i(b)," out of bounds for TransientVector of length",A.i(a.u)].join(""));}throw Error("assoc! after persistent!");}g.Y=function(){if(this.root.H)return this.u;throw Error("count after persistent!");};
g.W=function(a,b){if(this.root.H)return jd(this,b)[b&31];throw Error("nth after persistent!");};g.oa=function(a,b,c){return 0<=b&&b<this.u?this.W(null,b):c};g.na=function(a,b){return this.K(null,b,null)};g.K=function(a,b,c){if(this.root.H)return"number"===typeof b?this.oa(null,b,c):c;throw Error("lookup after persistent!");};
g.call=function(a){switch(arguments.length-1){case 1:return this.i(arguments[1]);case 2:return this.j(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",A.i(arguments.length-1)].join(""));}};g.apply=function(a,b){return this.call.apply(this,[this].concat(ra(b)))};g.i=function(a){return this.na(null,a)};g.j=function(a,b){return this.K(null,a,b)};function yd(){this.o=2097152;this.D=0}yd.prototype.O=function(){return!1};var zd=new yd;
function Ad(a,b){return rc(lc(b)&&!mc(b)?S(a)===S(b)?(null!=a?a.o&1048576||u===a.Gb||(a.o?0:x(Ta,a)):x(Ta,a))?zc(function(c,d,e){return Q.j(Bb(b,d,zd),e)?!0:new Nb},a):bd(function(c){return Q.j(Bb(b,M(c),zd),M(P(c)))},a):null:null)}function Bd(a){this.G=a}Bd.prototype.next=function(){if(null!=this.G){var a=M(this.G),b=dc(a,0,null);a=dc(a,1,null);this.G=P(this.G);return{value:[b,a],done:!1}}return{value:null,done:!0}};
function Cd(a,b){if(b instanceof H)a:{var c=a.length;b=b.ya;for(var d=0;;){if(c<=d){a=-1;break a}if(a[d]instanceof H&&b===a[d].ya){a=d;break a}d+=2}}else if("string"===typeof b||"number"===typeof b)a:for(c=a.length,d=0;;){if(c<=d){a=-1;break a}if(b===a[d]){a=d;break a}d+=2}else if(b instanceof yb)a:for(c=a.length,b=b.Da,d=0;;){if(c<=d){a=-1;break a}if(a[d]instanceof yb&&b===a[d].Da){a=d;break a}d+=2}else if(null==b)a:for(b=a.length,c=0;;){if(b<=c){a=-1;break a}if(null==a[c]){a=c;break a}c+=2}else a:for(c=
a.length,d=0;;){if(c<=d){a=-1;break a}if(Q.j(b,a[d])){a=d;break a}d+=2}return a}function Dd(a,b){this.key=a;this.J=b;this.C=null;this.o=166619935;this.D=0}g=Dd.prototype;g.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return R(this,b,0);case 2:return R(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.i=function(b){return R(this,b,0)};a.j=function(b,c){return R(this,b,c)};return a}();
g.lastIndexOf=function(){function a(c){return U(this,c,S(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return U(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.i=a;b.j=function(c,d){return U(this,c,d)};return b}();g.na=function(a,b){return this.oa(null,b,null)};g.K=function(a,b,c){return this.oa(null,b,c)};g.W=function(a,b){if(0===b)return this.key;if(1===b)return this.J;throw Error("Index out of bounds");};
g.oa=function(a,b,c){return 0===b?this.key:1===b?this.J:c};g.qb=function(a,b){return(new X(null,2,5,Y,[this.key,this.J],null)).qb(a,b)};g.T=function(){return null};g.Y=function(){return 2};g.Ib=function(){return this.key};g.Jb=function(){return this.J};g.S=function(){var a=this.C;return null!=a?a:this.C=a=Jb(this)};g.O=function(a,b){return Yb(this,b)};g.Z=function(){return null};
g.ca=function(a,b){a:if(a=this.Y(null),0===a)b=b.I?b.I():b.call(null);else for(var c=this.W(null,0),d=1;;)if(d<a){var e=this.W(null,d);c=b.j?b.j(c,e):b.call(null,c,e);if(Ob(c)){b=Ma(c);break a}d+=1}else{b=c;break a}return b};g.da=function(a,b,c){a:{a=this.Y(null);var d=c;for(c=0;;)if(c<a){var e=this.W(null,c);d=b.j?b.j(d,e):b.call(null,d,e);if(Ob(d)){b=Ma(d);break a}c+=1}else{b=d;break a}}return b};g.Aa=function(a,b,c){return ec.s(new X(null,2,5,Y,[this.key,this.J],null),b,c)};
g.Xa=function(a,b){return 0===b||1===b};g.M=function(){return new K([this.key,this.J],0,null)};g.U=function(a,b){return ic(new X(null,2,5,Y,[this.key,this.J],null),b)};g.X=function(a,b){return new X(null,3,5,Y,[this.key,this.J,b],null)};g.call=function(a){switch(arguments.length-1){case 1:return this.i(arguments[1]);case 2:return this.j(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",A.i(arguments.length-1)].join(""));}};g.apply=function(a,b){return this.call.apply(this,[this].concat(ra(b)))};
g.i=function(a){return this.W(null,a)};g.j=function(a,b){return this.oa(null,a,b)};function Ed(a){return null!=a?a.o&2048||u===a.$b?!0:!1:!1}function Fd(a,b,c){this.l=a;this.v=b;this.ua=c;this.o=32374990;this.D=262144}g=Fd.prototype;g.toString=function(){return nb(this)};
g.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return R(this,b,0);case 2:return R(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.i=function(b){return R(this,b,0)};a.j=function(b,c){return R(this,b,c)};return a}();
g.lastIndexOf=function(){function a(c){return U(this,c,S(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return U(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.i=a;b.j=function(c,d){return U(this,c,d)};return b}();g.T=function(){return this.ua};g.aa=function(){return this.v<this.l.length-2?new Fd(this.l,this.v+2,null):null};g.Y=function(){return(this.l.length-this.v)/2};g.S=function(){return Jb(this)};
g.O=function(a,b){return Yb(this,b)};g.Z=function(){return N};g.ca=function(a,b){return tc(b,this)};g.da=function(a,b,c){return wc(b,c,this)};g.ea=function(){return new Dd(this.l[this.v],this.l[this.v+1])};g.ja=function(){return this.v<this.l.length-2?new Fd(this.l,this.v+2,null):N};g.M=function(){return this};g.U=function(a,b){return b===this.ua?this:new Fd(this.l,this.v,b)};g.X=function(a,b){return V(b,this)};Fd.prototype[qa]=function(){return Hb(this)};
function Gd(a,b){this.l=a;this.v=0;this.u=b}Gd.prototype.la=function(){return this.v<this.u};Gd.prototype.next=function(){var a=new Dd(this.l[this.v],this.l[this.v+1]);this.v+=2;return a};function v(a,b,c,d){this.B=a;this.u=b;this.l=c;this.C=d;this.o=16647951;this.D=401412}g=v.prototype;g.toString=function(){return nb(this)};g.keys=function(){return Hb(Hd.i?Hd.i(this):Hd.call(null,this))};g.entries=function(){return new Bd(I(I(this)))};g.values=function(){return Hb(Id.i?Id.i(this):Id.call(null,this))};
g.has=function(a){return sc(this,a)};g.get=function(a,b){return this.K(null,a,b)};g.forEach=function(a){for(var b=I(this),c=null,d=0,e=0;;)if(e<d){var f=c.W(null,e),h=dc(f,0,null);f=dc(f,1,null);a.j?a.j(f,h):a.call(null,f,h);e+=1}else if(b=I(b))oc(b)?(c=ib(b),b=jb(b),h=c,d=S(c),c=h):(c=M(b),h=dc(c,0,null),f=dc(c,1,null),a.j?a.j(f,h):a.call(null,f,h),b=P(b),c=null,d=0),e=0;else return null};g.na=function(a,b){return this.K(null,b,null)};g.K=function(a,b,c){a=Cd(this.l,b);return-1===a?c:this.l[a+1]};
g.lb=function(a,b,c){a=this.l.length;for(var d=0;;)if(d<a){var e=this.l[d],f=this.l[d+1];c=b.s?b.s(c,e,f):b.call(null,c,e,f);if(Ob(c))return Ma(c);d+=2}else return c};g.va=function(){return new Gd(this.l,2*this.u)};g.T=function(){return this.B};g.Y=function(){return this.u};g.S=function(){var a=this.C;return null!=a?a:this.C=a=Lb(this)};
g.O=function(a,b){if(lc(b)&&!mc(b))if(a=this.l.length,this.u===b.Y(null))for(var c=0;;)if(c<a){var d=b.K(null,this.l[c],qc);if(d!==qc)if(Q.j(this.l[c+1],d))c+=2;else return!1;else return!1}else return!0;else return!1;else return!1};g.$a=function(){return new Jd(this.l.length,ra(this.l))};g.Z=function(){return Pa($c,this.B)};g.ca=function(a,b){return xc(this,b)};g.da=function(a,b,c){return yc(this,b,c)};
g.Aa=function(a,b,c){a=Cd(this.l,b);if(-1===a){if(this.u<Kd){a=this.l;for(var d=a.length,e=Array(d+2),f=0;;)if(f<d)e[f]=a[f],f+=1;else break;e[d]=b;e[d+1]=c;return new v(this.B,this.u+1,e,null)}return Pa(Ha(cd(Ld,this),b,c),this.B)}if(c===this.l[a+1])return this;b=ra(this.l);b[a+1]=c;return new v(this.B,this.u,b,null)};g.Xa=function(a,b){return-1!==Cd(this.l,b)};g.M=function(){var a=this.l;return 0<=a.length-2?new Fd(a,0,null):null};g.U=function(a,b){return b===this.B?this:new v(b,this.u,this.l,this.C)};
g.X=function(a,b){if(nc(b))return this.Aa(null,C(b,0),C(b,1));a=this;for(b=I(b);;){if(null==b)return a;var c=M(b);if(nc(c))a=Ha(a,C(c,0),C(c,1)),b=P(b);else throw Error("conj on a map takes map entries or seqables of map entries");}};g.call=function(a){switch(arguments.length-1){case 1:return this.i(arguments[1]);case 2:return this.j(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",A.i(arguments.length-1)].join(""));}};g.apply=function(a,b){return this.call.apply(this,[this].concat(ra(b)))};
g.i=function(a){return this.na(null,a)};g.j=function(a,b){return this.K(null,a,b)};var $c=new v(null,0,[],Mb),Kd=8;function Md(a,b){return a===b?!0:a===b||a instanceof H&&b instanceof H&&a.ya===b.ya?!0:Q.j(a,b)}function Nd(a){for(var b=0,c=0;;)if(b<a.length){var d;a:for(d=0;;)if(d<b){var e=Md(a[b],a[d]);if(e){d=e;break a}d=2+d}else{d=!1;break a}c=d?c:c+2;b=2+b}else return c}
function Od(a,b){var c=a.length-1,d=I(b);b=Array(c+2*S(d));a=pc(a,0,b,0,c);for(b=c;;)if(d){var e=M(d);a[b]=Ja(e);a[b+1]=Ka(e);b=2+c;d=P(d)}else return a}function fc(a){var b=a.length,c=1===(b&1),d;if(!(d=c))a:for(d=0;;)if(d<a.length){var e;b:for(e=0;;)if(e<d){var f=Md(a[d],a[e]);if(f){e=f;break b}e=2+e}else{e=!1;break b}if(e){d=e;break a}d=2+d}else{d=!1;break a}return d?Pd(a,c):new v(null,b/2,a,null)}
function Pd(a,b){var c=b?Od(a,cd($c,a[a.length-1])):a;a=Nd(c);var d=c.length;if(a<d){a=Array(a);for(var e=0,f=0;;)if(e<d)(function(){for(var h=0;;)if(h<f){var k=Md(c[e],c[h]);if(k)return k;h=2+h}else return!1})()?(b=f,e=2+e,f=b):(b=function(){for(var h=d-2;;)if(h>=e){if(Md(c[e],c[h]))return h;h-=2}else return h}(),a[f]=c[e],a[f+1]=c[b+1],b=2+f,e=2+e,f=b);else break;return new v(null,a.length/2,a,null)}return new v(null,c.length/2,c,null)}v.prototype[qa]=function(){return Hb(this)};
function Jd(a,b){this.Za={};this.Va=a;this.l=b;this.o=259;this.D=56}g=Jd.prototype;g.Y=function(){if(this.Za)return Bc(this.Va);throw Error("count after persistent!");};g.na=function(a,b){return this.K(null,b,null)};g.K=function(a,b,c){if(this.Za)return a=Cd(this.l,b),-1===a?c:this.l[a+1];throw Error("lookup after persistent!");};
g.cb=function(a,b){if(this.Za){if(Ed(b))return this.Ya(null,Qd.i?Qd.i(b):Qd.call(null,b),Rd.i?Rd.i(b):Rd.call(null,b));if(nc(b))return this.Ya(null,b.i?b.i(0):b.call(null,0),b.i?b.i(1):b.call(null,1));a=I(b);for(b=this;;){var c=M(a);if(w(c))a=P(a),b=gb(b,Qd.i?Qd.i(c):Qd.call(null,c),Rd.i?Rd.i(c):Rd.call(null,c));else return b}}else throw Error("conj! after persistent!");};g.mb=function(){if(this.Za)return this.Za=!1,new v(null,Bc(this.Va),this.l,null);throw Error("persistent! called twice");};
g.Ya=function(a,b,c){if(this.Za){a=Cd(this.l,b);if(-1===a){if(this.Va+2<=2*Kd)return this.Va+=2,this.l.push(b),this.l.push(c),this;a=Sd.j?Sd.j(this.Va,this.l):Sd.call(null,this.Va,this.l);return gb(a,b,c)}c!==this.l[a+1]&&(this.l[a+1]=c);return this}throw Error("assoc! after persistent!");};g.call=function(a){switch(arguments.length-1){case 1:return this.i(arguments[1]);case 2:return this.j(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",A.i(arguments.length-1)].join(""));}};
g.apply=function(a,b){return this.call.apply(this,[this].concat(ra(b)))};g.i=function(a){return this.K(null,a,null)};g.j=function(a,b){return this.K(null,a,b)};function Sd(a,b){for(var c=db(Ld),d=0;;)if(d<a)c=gb(c,b[d],b[d+1]),d+=2;else return c}function Td(){this.J=!1}function Ud(a,b,c){a=ra(a);a[b]=c;return a}function Vd(a,b,c,d){a=a.Ua(b);a.l[c]=d;return a}
function Wd(a,b,c){for(var d=a.length,e=0,f=c;;)if(e<d){c=a[e];if(null!=c){var h=a[e+1];c=b.s?b.s(f,c,h):b.call(null,f,c,h)}else c=a[e+1],c=null!=c?c.hb(b,f):f;if(Ob(c))return c;e+=2;f=c}else return f}function Xd(a){this.l=a;this.v=0;this.sa=this.ib=null}Xd.prototype.advance=function(){for(var a=this.l.length;;)if(this.v<a){var b=this.l[this.v],c=this.l[this.v+1];null!=b?b=this.ib=new Dd(b,c):null!=c?(b=lb(c),b=b.la()?this.sa=b:!1):b=!1;this.v+=2;if(b)return!0}else return!1};
Xd.prototype.la=function(){var a=null!=this.ib;return a?a:(a=null!=this.sa)?a:this.advance()};Xd.prototype.next=function(){if(null!=this.ib){var a=this.ib;this.ib=null;return a}if(null!=this.sa)return a=this.sa.next(),this.sa.la()||(this.sa=null),a;if(this.advance())return this.next();throw Error("No such element");};Xd.prototype.remove=function(){return Error("Unsupported operation")};function Yd(a,b,c){this.H=a;this.R=b;this.l=c;this.D=131072;this.o=0}g=Yd.prototype;
g.Ua=function(a){if(a===this.H)return this;var b=Cc(this.R),c=Array(0>b?4:2*(b+1));pc(this.l,0,c,0,2*b);return new Yd(a,this.R,c)};g.gb=function(){return Zd?Zd(this.l):$d.call(null,this.l)};g.hb=function(a,b){return Wd(this.l,a,b)};g.Ca=function(a,b,c,d){var e=1<<(b>>>a&31);if(0===(this.R&e))return d;var f=Cc(this.R&e-1);e=this.l[2*f];f=this.l[2*f+1];return null==e?f.Ca(a+5,b,c,d):Md(c,e)?f:d};
g.qa=function(a,b,c,d,e,f){var h=1<<(c>>>b&31),k=Cc(this.R&h-1);if(0===(this.R&h)){var l=Cc(this.R);if(2*l<this.l.length){a=this.Ua(a);b=a.l;f.J=!0;c=2*(l-k);f=2*k+(c-1);for(l=2*(k+1)+(c-1);0!==c;)b[l]=b[f],--l,--c,--f;b[2*k]=d;b[2*k+1]=e;a.R|=h;return a}if(16<=l){k=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];k[c>>>b&31]=ae.qa(a,b+5,c,d,e,f);for(e=d=0;;)if(32>d)0===(this.R>>>d&1)?
d+=1:(k[d]=null!=this.l[e]?ae.qa(a,b+5,wb(this.l[e]),this.l[e],this.l[e+1],f):this.l[e+1],e+=2,d+=1);else break;return new be(a,l+1,k)}b=Array(2*(l+4));pc(this.l,0,b,0,2*k);b[2*k]=d;b[2*k+1]=e;pc(this.l,2*k,b,2*(k+1),2*(l-k));f.J=!0;a=this.Ua(a);a.l=b;a.R|=h;return a}l=this.l[2*k];h=this.l[2*k+1];if(null==l)return l=h.qa(a,b+5,c,d,e,f),l===h?this:Vd(this,a,2*k+1,l);if(Md(d,l))return e===h?this:Vd(this,a,2*k+1,e);f.J=!0;f=b+5;d=ce?ce(a,f,l,h,c,d,e):de.call(null,a,f,l,h,c,d,e);e=2*k;k=2*k+1;a=this.Ua(a);
a.l[e]=null;a.l[k]=d;return a};
g.pa=function(a,b,c,d,e){var f=1<<(b>>>a&31),h=Cc(this.R&f-1);if(0===(this.R&f)){var k=Cc(this.R);if(16<=k){h=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];h[b>>>a&31]=ae.pa(a+5,b,c,d,e);for(d=c=0;;)if(32>c)0===(this.R>>>c&1)?c+=1:(h[c]=null!=this.l[d]?ae.pa(a+5,wb(this.l[d]),this.l[d],this.l[d+1],e):this.l[d+1],d+=2,c+=1);else break;return new be(null,k+1,h)}a=Array(2*(k+1));pc(this.l,
0,a,0,2*h);a[2*h]=c;a[2*h+1]=d;pc(this.l,2*h,a,2*(h+1),2*(k-h));e.J=!0;return new Yd(null,this.R|f,a)}var l=this.l[2*h];f=this.l[2*h+1];if(null==l)return k=f.pa(a+5,b,c,d,e),k===f?this:new Yd(null,this.R,Ud(this.l,2*h+1,k));if(Md(c,l))return d===f?this:new Yd(null,this.R,Ud(this.l,2*h+1,d));e.J=!0;e=this.R;k=this.l;a+=5;a=ee?ee(a,l,f,b,c,d):de.call(null,a,l,f,b,c,d);c=2*h;h=2*h+1;d=ra(k);d[c]=null;d[h]=a;return new Yd(null,e,d)};g.va=function(){return new Xd(this.l)};var ae=new Yd(null,0,[]);
function fe(a){this.l=a;this.v=0;this.sa=null}fe.prototype.la=function(){for(var a=this.l.length;;){if(null!=this.sa&&this.sa.la())return!0;if(this.v<a){var b=this.l[this.v];this.v+=1;null!=b&&(this.sa=lb(b))}else return!1}};fe.prototype.next=function(){if(this.la())return this.sa.next();throw Error("No such element");};fe.prototype.remove=function(){return Error("Unsupported operation")};function be(a,b,c){this.H=a;this.u=b;this.l=c;this.D=131072;this.o=0}g=be.prototype;
g.Ua=function(a){return a===this.H?this:new be(a,this.u,ra(this.l))};g.gb=function(){return ge?ge(this.l):he.call(null,this.l)};g.hb=function(a,b){for(var c=this.l.length,d=0;;)if(d<c){var e=this.l[d];if(null!=e){b=e.hb(a,b);if(Ob(b))return b;d+=1}else d+=1}else return b};g.Ca=function(a,b,c,d){var e=this.l[b>>>a&31];return null!=e?e.Ca(a+5,b,c,d):d};
g.qa=function(a,b,c,d,e,f){var h=c>>>b&31,k=this.l[h];if(null==k)return a=Vd(this,a,h,ae.qa(a,b+5,c,d,e,f)),a.u+=1,a;b=k.qa(a,b+5,c,d,e,f);return b===k?this:Vd(this,a,h,b)};g.pa=function(a,b,c,d,e){var f=b>>>a&31,h=this.l[f];if(null==h)return new be(null,this.u+1,Ud(this.l,f,ae.pa(a+5,b,c,d,e)));a=h.pa(a+5,b,c,d,e);return a===h?this:new be(null,this.u,Ud(this.l,f,a))};g.va=function(){return new fe(this.l)};function ie(a,b,c){b*=2;for(var d=0;;)if(d<b){if(Md(c,a[d]))return d;d+=2}else return-1}
function je(a,b,c,d){this.H=a;this.Ba=b;this.u=c;this.l=d;this.D=131072;this.o=0}g=je.prototype;g.Ua=function(a){if(a===this.H)return this;var b=Array(2*(this.u+1));pc(this.l,0,b,0,2*this.u);return new je(a,this.Ba,this.u,b)};g.gb=function(){return Zd?Zd(this.l):$d.call(null,this.l)};g.hb=function(a,b){return Wd(this.l,a,b)};g.Ca=function(a,b,c,d){a=ie(this.l,this.u,c);return 0>a?d:Md(c,this.l[a])?this.l[a+1]:d};
g.qa=function(a,b,c,d,e,f){if(c===this.Ba){b=ie(this.l,this.u,d);if(-1===b){if(this.l.length>2*this.u)return b=2*this.u,c=2*this.u+1,a=this.Ua(a),a.l[b]=d,a.l[c]=e,f.J=!0,a.u+=1,a;c=this.l.length;b=Array(c+2);pc(this.l,0,b,0,c);b[c]=d;b[c+1]=e;f.J=!0;d=this.u+1;a===this.H?(this.l=b,this.u=d,a=this):a=new je(this.H,this.Ba,d,b);return a}return this.l[b+1]===e?this:Vd(this,a,b+1,e)}return(new Yd(a,1<<(this.Ba>>>b&31),[null,this,null,null])).qa(a,b,c,d,e,f)};
g.pa=function(a,b,c,d,e){return b===this.Ba?(a=ie(this.l,this.u,c),-1===a?(a=2*this.u,b=Array(a+2),pc(this.l,0,b,0,a),b[a]=c,b[a+1]=d,e.J=!0,new je(null,this.Ba,this.u+1,b)):Q.j(this.l[a+1],d)?this:new je(null,this.Ba,this.u,Ud(this.l,a+1,d))):(new Yd(null,1<<(this.Ba>>>a&31),[null,this])).pa(a,b,c,d,e)};g.va=function(){return new Xd(this.l)};
function de(a){switch(arguments.length){case 6:return ee(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);case 7:return ce(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]);default:throw Error(["Invalid arity: ",A.i(arguments.length)].join(""));}}function ee(a,b,c,d,e,f){var h=wb(b);if(h===d)return new je(null,h,2,[b,c,e,f]);var k=new Td;return ae.pa(a,h,b,c,k).pa(a,d,e,f,k)}
function ce(a,b,c,d,e,f,h){var k=wb(c);if(k===e)return new je(null,k,2,[c,d,f,h]);var l=new Td;return ae.qa(a,b,k,c,d,l).qa(a,b,e,f,h,l)}function ke(a,b,c,d,e){this.B=a;this.ta=b;this.v=c;this.G=d;this.C=e;this.o=32374988;this.D=0}g=ke.prototype;g.toString=function(){return nb(this)};
g.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return R(this,b,0);case 2:return R(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.i=function(b){return R(this,b,0)};a.j=function(b,c){return R(this,b,c)};return a}();
g.lastIndexOf=function(){function a(c){return U(this,c,S(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return U(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.i=a;b.j=function(c,d){return U(this,c,d)};return b}();g.T=function(){return this.B};g.aa=function(){if(null==this.G){var a=this.ta,b=this.v+2;return le?le(a,b,null):$d.call(null,a,b,null)}a=this.ta;b=this.v;var c=P(this.G);return le?le(a,b,c):$d.call(null,a,b,c)};
g.S=function(){var a=this.C;return null!=a?a:this.C=a=Jb(this)};g.O=function(a,b){return Yb(this,b)};g.Z=function(){return N};g.ca=function(a,b){return tc(b,this)};g.da=function(a,b,c){return wc(b,c,this)};g.ea=function(){return null==this.G?new Dd(this.ta[this.v],this.ta[this.v+1]):M(this.G)};
g.ja=function(){var a=this,b=null==a.G?function(){var c=a.ta,d=a.v+2;return le?le(c,d,null):$d.call(null,c,d,null)}():function(){var c=a.ta,d=a.v,e=P(a.G);return le?le(c,d,e):$d.call(null,c,d,e)}();return null!=b?b:N};g.M=function(){return this};g.U=function(a,b){return b===this.B?this:new ke(b,this.ta,this.v,this.G,this.C)};g.X=function(a,b){return V(b,this)};ke.prototype[qa]=function(){return Hb(this)};
function $d(a){switch(arguments.length){case 1:return Zd(arguments[0]);case 3:return le(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",A.i(arguments.length)].join(""));}}function Zd(a){return le(a,0,null)}function le(a,b,c){if(null==c)for(c=a.length;;)if(b<c){if(null!=a[b])return new ke(null,a,b,null,null);var d=a[b+1];if(w(d)&&(d=d.gb(),w(d)))return new ke(null,a,b+2,d,null);b+=2}else return null;else return new ke(null,a,b,c,null)}
function me(a,b,c,d,e){this.B=a;this.ta=b;this.v=c;this.G=d;this.C=e;this.o=32374988;this.D=0}g=me.prototype;g.toString=function(){return nb(this)};g.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return R(this,b,0);case 2:return R(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.i=function(b){return R(this,b,0)};a.j=function(b,c){return R(this,b,c)};return a}();
g.lastIndexOf=function(){function a(c){return U(this,c,S(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return U(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.i=a;b.j=function(c,d){return U(this,c,d)};return b}();g.T=function(){return this.B};g.aa=function(){var a=this.ta,b=this.v,c=P(this.G);return ne?ne(a,b,c):he.call(null,a,b,c)};g.S=function(){var a=this.C;return null!=a?a:this.C=a=Jb(this)};g.O=function(a,b){return Yb(this,b)};
g.Z=function(){return N};g.ca=function(a,b){return tc(b,this)};g.da=function(a,b,c){return wc(b,c,this)};g.ea=function(){return M(this.G)};g.ja=function(){var a=this.ta;var b=this.v,c=P(this.G);a=ne?ne(a,b,c):he.call(null,a,b,c);return null!=a?a:N};g.M=function(){return this};g.U=function(a,b){return b===this.B?this:new me(b,this.ta,this.v,this.G,this.C)};g.X=function(a,b){return V(b,this)};me.prototype[qa]=function(){return Hb(this)};
function he(a){switch(arguments.length){case 1:return ge(arguments[0]);case 3:return ne(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",A.i(arguments.length)].join(""));}}function ge(a){return ne(a,0,null)}function ne(a,b,c){if(null==c)for(c=a.length;;)if(b<c){var d=a[b];if(w(d)&&(d=d.gb(),w(d)))return new me(null,a,b+1,d,null);b+=1}else return null;else return new me(null,a,b,c,null)}function oe(a,b){this.ga=a;this.Ab=b;this.sb=!1}
oe.prototype.la=function(){return!this.sb||this.Ab.la()};oe.prototype.next=function(){if(this.sb)return this.Ab.next();this.sb=!0;return new Dd(null,this.ga)};oe.prototype.remove=function(){return Error("Unsupported operation")};function pe(a,b,c,d,e,f){this.B=a;this.u=b;this.root=c;this.ka=d;this.ga=e;this.C=f;this.o=16123663;this.D=139268}g=pe.prototype;g.toString=function(){return nb(this)};g.keys=function(){return Hb(Hd.i?Hd.i(this):Hd.call(null,this))};g.entries=function(){return new Bd(I(I(this)))};
g.values=function(){return Hb(Id.i?Id.i(this):Id.call(null,this))};g.has=function(a){return sc(this,a)};g.get=function(a,b){return this.K(null,a,b)};g.forEach=function(a){for(var b=I(this),c=null,d=0,e=0;;)if(e<d){var f=c.W(null,e),h=dc(f,0,null);f=dc(f,1,null);a.j?a.j(f,h):a.call(null,f,h);e+=1}else if(b=I(b))oc(b)?(c=ib(b),b=jb(b),h=c,d=S(c),c=h):(c=M(b),h=dc(c,0,null),f=dc(c,1,null),a.j?a.j(f,h):a.call(null,f,h),b=P(b),c=null,d=0),e=0;else return null};g.na=function(a,b){return this.K(null,b,null)};
g.K=function(a,b,c){return null==b?this.ka?this.ga:c:null==this.root?c:this.root.Ca(0,wb(b),b,c)};g.lb=function(a,b,c){a=this.ka?b.s?b.s(c,null,this.ga):b.call(null,c,null,this.ga):c;Ob(a)?b=Ma(a):null!=this.root?(b=this.root.hb(b,a),b=Ob(b)?Pb.i?Pb.i(b):Pb.call(null,b):b):b=a;return b};g.va=function(){var a=this.root?lb(this.root):new ad($c);return this.ka?new oe(this.ga,a):a};g.T=function(){return this.B};g.Y=function(){return this.u};g.S=function(){var a=this.C;return null!=a?a:this.C=a=Lb(this)};
g.O=function(a,b){return Ad(this,b)};g.$a=function(){return new qe(this.root,this.u,this.ka,this.ga)};g.Z=function(){return Pa(Ld,this.B)};g.Aa=function(a,b,c){if(null==b)return this.ka&&c===this.ga?this:new pe(this.B,this.ka?this.u:this.u+1,this.root,!0,c,null);a=new Td;b=(null==this.root?ae:this.root).pa(0,wb(b),b,c,a);return b===this.root?this:new pe(this.B,a.J?this.u+1:this.u,b,this.ka,this.ga,null)};g.Xa=function(a,b){return null==b?this.ka:null==this.root?!1:this.root.Ca(0,wb(b),b,qc)!==qc};
g.M=function(){if(0<this.u){var a=null!=this.root?this.root.gb():null;return this.ka?V(new Dd(null,this.ga),a):a}return null};g.U=function(a,b){return b===this.B?this:new pe(b,this.u,this.root,this.ka,this.ga,this.C)};g.X=function(a,b){if(nc(b))return this.Aa(null,C(b,0),C(b,1));a=this;for(b=I(b);;){if(null==b)return a;var c=M(b);if(nc(c))a=Ha(a,C(c,0),C(c,1)),b=P(b);else throw Error("conj on a map takes map entries or seqables of map entries");}};
g.call=function(a){switch(arguments.length-1){case 1:return this.i(arguments[1]);case 2:return this.j(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",A.i(arguments.length-1)].join(""));}};g.apply=function(a,b){return this.call.apply(this,[this].concat(ra(b)))};g.i=function(a){return this.na(null,a)};g.j=function(a,b){return this.K(null,a,b)};var Ld=new pe(null,0,null,!1,null,Mb);pe.prototype[qa]=function(){return Hb(this)};
function qe(a,b,c,d){this.H={};this.root=a;this.count=b;this.ka=c;this.ga=d;this.o=259;this.D=56}function re(a,b,c){if(a.H){if(null==b)a.ga!==c&&(a.ga=c),a.ka||(a.count+=1,a.ka=!0);else{var d=new Td;b=(null==a.root?ae:a.root).qa(a.H,0,wb(b),b,c,d);b!==a.root&&(a.root=b);d.J&&(a.count+=1)}return a}throw Error("assoc! after persistent!");}g=qe.prototype;g.Y=function(){if(this.H)return this.count;throw Error("count after persistent!");};
g.na=function(a,b){return null==b?this.ka?this.ga:null:null==this.root?null:this.root.Ca(0,wb(b),b)};g.K=function(a,b,c){return null==b?this.ka?this.ga:c:null==this.root?c:this.root.Ca(0,wb(b),b,c)};
g.cb=function(a,b){a:if(this.H)if(Ed(b))a=re(this,Qd.i?Qd.i(b):Qd.call(null,b),Rd.i?Rd.i(b):Rd.call(null,b));else if(nc(b))a=re(this,b.i?b.i(0):b.call(null,0),b.i?b.i(1):b.call(null,1));else for(a=I(b),b=this;;){var c=M(a);if(w(c))a=P(a),b=re(b,Qd.i?Qd.i(c):Qd.call(null,c),Rd.i?Rd.i(c):Rd.call(null,c));else{a=b;break a}}else throw Error("conj! after persistent");return a};
g.mb=function(){if(this.H){this.H=null;var a=new pe(null,this.count,this.root,this.ka,this.ga,null)}else throw Error("persistent! called twice");return a};g.Ya=function(a,b,c){return re(this,b,c)};g.call=function(a){switch(arguments.length-1){case 1:return this.i(arguments[1]);case 2:return this.j(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",A.i(arguments.length-1)].join(""));}};g.apply=function(a,b){return this.call.apply(this,[this].concat(ra(b)))};
g.i=function(a){return this.na(null,a)};g.j=function(a,b){return this.K(null,a,b)};function se(a,b){this.F=a;this.ua=b;this.o=32374988;this.D=0}g=se.prototype;g.toString=function(){return nb(this)};g.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return R(this,b,0);case 2:return R(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.i=function(b){return R(this,b,0)};a.j=function(b,c){return R(this,b,c)};return a}();
g.lastIndexOf=function(){function a(c){return U(this,c,S(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return U(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.i=a;b.j=function(c,d){return U(this,c,d)};return b}();g.T=function(){return this.ua};g.aa=function(){var a=(null!=this.F?this.F.o&128||u===this.F.ab||(this.F.o?0:x(Ba,this.F)):x(Ba,this.F))?this.F.aa():P(this.F);return null==a?null:new se(a,null)};g.S=function(){return Jb(this)};
g.O=function(a,b){return Yb(this,b)};g.Z=function(){return N};g.ca=function(a,b){return tc(b,this)};g.da=function(a,b,c){return wc(b,c,this)};g.ea=function(){return this.F.ea(null).key};g.ja=function(){var a=(null!=this.F?this.F.o&128||u===this.F.ab||(this.F.o?0:x(Ba,this.F)):x(Ba,this.F))?this.F.aa():P(this.F);return null!=a?new se(a,null):N};g.M=function(){return this};g.U=function(a,b){return b===this.ua?this:new se(this.F,b)};g.X=function(a,b){return V(b,this)};se.prototype[qa]=function(){return Hb(this)};
function Hd(a){return(a=I(a))?new se(a,null):null}function Qd(a){return Ja(a)}function te(a,b){this.F=a;this.ua=b;this.o=32374988;this.D=0}g=te.prototype;g.toString=function(){return nb(this)};g.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return R(this,b,0);case 2:return R(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.i=function(b){return R(this,b,0)};a.j=function(b,c){return R(this,b,c)};return a}();
g.lastIndexOf=function(){function a(c){return U(this,c,S(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return U(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.i=a;b.j=function(c,d){return U(this,c,d)};return b}();g.T=function(){return this.ua};g.aa=function(){var a=(null!=this.F?this.F.o&128||u===this.F.ab||(this.F.o?0:x(Ba,this.F)):x(Ba,this.F))?this.F.aa():P(this.F);return null==a?null:new te(a,null)};g.S=function(){return Jb(this)};
g.O=function(a,b){return Yb(this,b)};g.Z=function(){return N};g.ca=function(a,b){return tc(b,this)};g.da=function(a,b,c){return wc(b,c,this)};g.ea=function(){return this.F.ea(null).J};g.ja=function(){var a=(null!=this.F?this.F.o&128||u===this.F.ab||(this.F.o?0:x(Ba,this.F)):x(Ba,this.F))?this.F.aa():P(this.F);return null!=a?new te(a,null):N};g.M=function(){return this};g.U=function(a,b){return b===this.ua?this:new te(this.F,b)};g.X=function(a,b){return V(b,this)};te.prototype[qa]=function(){return Hb(this)};
function Id(a){return(a=I(a))?new te(a,null):null}function Rd(a){return Ka(a)}function Hc(a){if(null!=a&&(a.D&4096||u===a.Lb))return a.name;if("string"===typeof a)return a;throw Error(["Doesn't support name: ",A.i(a)].join(""));}
function ve(a,b,c,d,e,f,h){var k=ha;ha=null==ha?null:ha-1;try{if(null!=ha&&0>ha)return G(a,"#");G(a,c);if(0===na.i(f))I(h)&&G(a,function(){var r=we.i(f);return w(r)?r:"..."}());else{if(I(h)){var l=M(h);b.s?b.s(l,a,f):b.call(null,l,a,f)}for(var m=P(h),n=na.i(f)-1;;)if(!m||null!=n&&0===n){I(m)&&0===n&&(G(a,d),G(a,function(){var r=we.i(f);return w(r)?r:"..."}()));break}else{G(a,d);var p=M(m);c=a;h=f;b.s?b.s(p,c,h):b.call(null,p,c,h);var q=P(m);c=n-1;m=q;n=c}}return G(a,e)}finally{ha=k}}
function xe(a,b){b=I(b);for(var c=null,d=0,e=0;;)if(e<d){var f=c.W(null,e);G(a,f);e+=1}else if(b=I(b))c=b,oc(c)?(b=ib(c),d=jb(c),c=b,f=S(b),b=d,d=f):(f=M(c),G(a,f),b=P(c),c=null,d=0),e=0;else return null}var ye={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"};function ze(a){return['"',A.i(a.replace(RegExp('[\\\\"\b\f\n\r\t]',"g"),function(b){return ye[b]})),'"'].join("")}
function Ae(a,b){return(a=rc(zb(a,la)))?(a=null!=b?b.o&131072||u===b.Kb?!0:!1:!1)?null!=jc(b):a:a}
function Be(a,b,c){if(null==a)return G(b,"nil");if(Ae(c,a)){G(b,"^");var d=jc(a);Z.s?Z.s(d,b,c):Z.call(null,d,b,c);G(b," ")}if(a.Pb)return a.cc(a,b,c);if(null!=a?a.o&2147483648||u===a.ba||(a.o?0:x(bb,a)):x(bb,a))return cb(a,b,c);if(!0===a||!1===a)return G(b,A.i(a));if("number"===typeof a)return G(b,isNaN(a)?"##NaN":a===Number.POSITIVE_INFINITY?"##Inf":a===Number.NEGATIVE_INFINITY?"##-Inf":A.i(a));if(null!=a&&a.constructor===Object)return G(b,"#js "),d=W.j(function(f){var h=/[A-Za-z_\*\+\?!\-'][\w\*\+\?!\-']*/;
if("string"===typeof f)if(h=h.exec(f),null!=h&&Q.j(h[0],f))if(1===h.length)h=h[0];else if(w(Ed.i?Ed.i(h):Ed.call(null,h)))h=new X(null,2,5,Y,[Qd.i?Qd.i(h):Qd.call(null,h),Rd.i?Rd.i(h):Rd.call(null,h)],null);else if(nc(h))h=ic(h,null);else if(oa(h))b:{var k=h.length;if(32>k)h=new X(null,k,5,Y,h,null);else for(var l=32,m=(new X(null,32,5,Y,h.slice(0,32),null)).$a(null);;)if(l<k){var n=l+1;m=eb(m,h[l]);l=n}else{h=fb(m);break b}}else h=fb(uc(eb,db(ac),h));else h=null;else throw new TypeError("re-matches must match against a string.");
return new Dd(null!=h?Gc.i(f):f,a[f])},da(a)),Ce.ia?Ce.ia(d,Z,b,c):Ce.call(null,d,Z,b,c);if(oa(a))return ve(b,Z,"#js ["," ","]",c,a);if("string"===typeof a)return w(ka.i(c))?G(b,ze(a)):G(b,a);if("function"===typeof a){var e=a.name;c=w(function(){var f=null==e;return f?f:/^[\s\xa0]*$/.test(e)}())?"Function":e;return xe(b,Zb(["#object[",c,w(!1)?[' "',A.i(a),'"'].join(""):"","]"]))}if(a instanceof Date)return c=function(f,h){for(f=A.i(f);;)if(f.length<h)f=["0",f].join("");else return f},xe(b,Zb(['#inst "',
c(a.getUTCFullYear(),4),"-",c(a.getUTCMonth()+1,2),"-",c(a.getUTCDate(),2),"T",c(a.getUTCHours(),2),":",c(a.getUTCMinutes(),2),":",c(a.getUTCSeconds(),2),".",c(a.getUTCMilliseconds(),3),"-",'00:00"']));if(a instanceof RegExp)return xe(b,Zb(['#"',a.source,'"']));if("symbol"===t(a)||"undefined"!==typeof Symbol&&a instanceof Symbol)return xe(b,Zb(["#object[",a.toString(),"]"]));if(w(function(){var f=null==a?null:a.constructor;return null==f?null:f.rb}()))return xe(b,Zb(["#object[",a.constructor.rb.replace(RegExp("/",
"g"),"."),"]"]));e=function(){var f=null==a?null:a.constructor;return null==f?null:f.name}();c=w(function(){var f=null==e;return f?f:/^[\s\xa0]*$/.test(e)}())?"Object":e;return null==a.constructor?xe(b,Zb(["#object[",c,"]"])):xe(b,Zb(["#object[",c," ",A.i(a),"]"]))}function Z(a,b,c){var d=De.i(c);return w(d)?(c=ec.s(c,Ee,Be),d.s?d.s(a,b,c):d.call(null,a,b,c)):Be(a,b,c)}function Fe(a){return a instanceof yb?Cb.j(null,Hc(a)):Gc.j(null,Hc(a))}
function Ge(a){if(w(!1)){var b=I(a),c=I(b),d=M(c);P(c);dc(d,0,null);dc(d,1,null);c=null==a?null:null!=a&&(a.o&4||u===a.Db)?a.Z(null):(null!=a?a.o&4||u===a.Db||(a.o?0:x(ua,a)):x(ua,a))?va(a):null;for(a=null;;){d=a;b=I(b);a=M(b);var e=P(b),f=a;a=dc(f,0,null);b=dc(f,1,null);if(w(f))if(a instanceof H||a instanceof yb)if(w(d))if(Q.j(d,Fc(a)))c=ec.s(c,Fe(a),b),a=d,b=e;else return null;else if(d=Fc(a),w(d))c=ec.s(c,Fe(a),b),a=d,b=e;else return null;else return null;else return new X(null,2,5,Y,[d,c],null)}}else return null}
function He(a,b,c,d,e){return ve(d,function(f,h,k){var l=Ja(f);c.s?c.s(l,h,k):c.call(null,l,h,k);G(h," ");f=Ka(f);return c.s?c.s(f,h,k):c.call(null,f,h,k)},[A.i(a),"{"].join(""),", ","}",e,I(b))}function Ce(a,b,c,d){var e=lc(a)?Ge(a):null,f=dc(e,0,null);e=dc(e,1,null);return w(f)?He(["#:",A.i(f)].join(""),e,b,c,d):He(null,a,b,c,d)}K.prototype.ba=u;K.prototype.P=function(a,b,c){return ve(b,Z,"("," ",")",c,this)};Ic.prototype.ba=u;Ic.prototype.P=function(a,b,c){return ve(b,Z,"("," ",")",c,this)};
Dd.prototype.ba=u;Dd.prototype.P=function(a,b,c){return ve(b,Z,"["," ","]",c,this)};ke.prototype.ba=u;ke.prototype.P=function(a,b,c){return ve(b,Z,"("," ",")",c,this)};Fd.prototype.ba=u;Fd.prototype.P=function(a,b,c){return ve(b,Z,"("," ",")",c,this)};Ib.prototype.ba=u;Ib.prototype.P=function(a,b,c){return ve(b,Z,"("," ",")",c,this)};td.prototype.ba=u;td.prototype.P=function(a,b,c){return ve(b,Z,"("," ",")",c,this)};Ec.prototype.ba=u;Ec.prototype.P=function(a,b,c){return ve(b,Z,"("," ",")",c,this)};
pe.prototype.ba=u;pe.prototype.P=function(a,b,c){return Ce(this,Z,b,c)};me.prototype.ba=u;me.prototype.P=function(a,b,c){return ve(b,Z,"("," ",")",c,this)};Mc.prototype.ba=u;Mc.prototype.P=function(a,b,c){return ve(b,Z,"("," ",")",c,this)};te.prototype.ba=u;te.prototype.P=function(a,b,c){return ve(b,Z,"("," ",")",c,this)};X.prototype.ba=u;X.prototype.P=function(a,b,c){return ve(b,Z,"["," ","]",c,this)};Dc.prototype.ba=u;Dc.prototype.P=function(a,b){return G(b,"()")};v.prototype.ba=u;
v.prototype.P=function(a,b,c){return Ce(this,Z,b,c)};se.prototype.ba=u;se.prototype.P=function(a,b,c){return ve(b,Z,"("," ",")",c,this)};bc.prototype.ba=u;bc.prototype.P=function(a,b,c){return ve(b,Z,"("," ",")",c,this)};function Ie(){}function Je(a){if(null!=a&&null!=a.Fb)a=a.Fb(a);else{var b=Je[t(null==a?null:a)];if(null!=b)a=b.i?b.i(a):b.call(null,a);else if(b=Je._,null!=b)a=b.i?b.i(a):b.call(null,a);else throw z("IEncodeJS.-clj-\x3ejs",a);}return a}
function Ke(a,b){if(null!=a?u===a.Eb||(a.Ob?0:x(Ie,a)):x(Ie,a))a=Je(a);else if("string"===typeof a||"number"===typeof a||a instanceof H||a instanceof yb)a=b.i?b.i(a):b.call(null,a);else{var c=Zb([a]);a=ia();null==c?b=!0:(null!=c?c.o&2||u===c.vb||(c.o?0:x(sa,c)):x(sa,c))?b=0===ta(c):(b=I(c),b=null==b?!0:!1===b?!0:!1);if(b)a="";else{b=A;var d=b.i,e=new ea,f=new mb(e);Z(M(c),f,a);c=I(P(c));for(var h=null,k=0,l=0;;)if(l<k){var m=h.W(null,l);G(f," ");Z(m,f,a);l+=1}else if(c=I(c))h=c,oc(h)?(c=ib(h),k=jb(h),
h=c,m=S(c),c=k,k=m):(m=M(h),G(f," "),Z(m,f,a),c=P(h),h=null,k=0),l=0;else break;a=d.call(b,e)}}return a}var Le=function Le(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return Le.N(arguments[0],1<c.length?new K(c.slice(1),0,null):null)};
Le.N=function(a,b){b=Zc(b);var c=Bb(b,Me,Hc),d=function h(f){if(null==f)return null;if(null!=f?u===f.Eb||(f.Ob?0:x(Ie,f)):x(Ie,f))return Je(f);if(f instanceof H)return c.i?c.i(f):c.call(null,f);if(f instanceof yb)return A.i(f);if(lc(f)){var k={};f=I(f);for(var l=null,m=0,n=0;;)if(n<m){var p=l.W(null,n),q=dc(p,0,null),r=dc(p,1,null);p=k;q=Ke(q,d);r=h(r);p[q]=r;n+=1}else if(f=I(f))oc(f)?(m=ib(f),f=jb(f),l=m,m=S(m)):(l=M(f),m=dc(l,0,null),n=dc(l,1,null),l=k,m=Ke(m,d),n=h(n),l[m]=n,f=P(f),l=null,m=0),
n=0;else break;return k}if(null==f?0:null!=f?f.o&8||u===f.Ub||(f.o?0:x(wa,f)):x(wa,f)){k=[];f=I(W.j(h,f));l=null;for(n=m=0;;)if(n<m)p=l.W(null,n),k.push(p),n+=1;else if(f=I(f))l=f,oc(l)?(f=ib(l),n=jb(l),l=f,m=S(f),f=n):(f=M(l),k.push(f),f=P(l),l=null,m=0),n=0;else break;return k}return f};return d(a)};Le.fa=1;Le.$=function(a){var b=M(a);a=P(a);return this.N(b,a)};var la=new H(null,"meta","meta",1499536964),Ne=new H(null,"anim","anim",-1276068045),na=new H(null,"print-length","print-length",1931866356),Oe=new H(null,"size","size",1098693007),Pe=new H(null,"game","game",-441523833),ma=new H(null,"dup","dup",556298533),Qe=new H(null,"touchToMouse","touchToMouse",834074581),Re=new H(null,"buttons","buttons",-1953831197),ka=new H(null,"readably","readably",1129599760),Se=new H(null,"from","from",1815293044),Te=new H(null,"main-menu","main-menu",-1471790381),Ue=
new H(null,"width","width",-384071477),Ve=new H(null,"isStatic","isStatic",1002568003),Ee=new H(null,"fallback-impl","fallback-impl",-1501286995),Me=new H(null,"keyword-fn","keyword-fn",-64566675),We=new H(null,"speed","speed",1257663751),Xe=new H(null,"to","to",192099007),Ye=new H(null,"destroy","destroy",-843660405),Ze=new H(null,"font","font",-1506159249),$e=new H(null,"spin","spin",-869832076),af=new H(null,"score","score",-1963588780),bf=new H(null,"jump","jump",-971319427),cf=new H(null,"background",
"background",-863952629),df=new H(null,"mouse","mouse",478628972),ja=new H(null,"flush-on-newline","flush-on-newline",-151457939),ef=new H(null,"height","height",1025178622),ff=new H(null,"global","global",93595047),gf=new H(null,"loop","loop",-395552849),hf=new H(null,"anims","anims",300543630),jf=new H(null,"letterbox","letterbox",1671383600),kf=new H(null,"sliceX","sliceX",-1861376171),lf=new H(null,"sliceY","sliceY",1476268871),mf=new H(null,"volume","volume",1900330799),nf=new H(null,"keyboard",
"keyboard",-617357087),we=new H(null,"more-marker","more-marker",-14717935),of=new H(null,"run","run",-1821166653),pf=new H(null,"debug","debug",-1608172596),De=new H(null,"alt-impl","alt-impl",670969595),qf=new H(null,"game-over","game-over",-607322695),rf=new H(null,"jumpForce","jumpForce",1496881882),sf=new H(null,"debugKey","debugKey",-429497682);var tf={},uf={},vf=[];function wf(a,b){var c=uf[a];if(void 0!==c)return c;try{vf.push(a);var d=tf[a],e=shadow$provide[a];if(void 0===d){if(void 0===e)throw"Module not provided: "+a;d={exports:{}};tf[a]=d}if(e){delete shadow$provide[a];try{e.call(d,aa,wf,d,d.exports)}catch(h){throw console.warn("shadow-cljs - failed to load",a),console.error(h),h;}if(b){var f=b.globals;if(f)for(a=0;a<f.length;a++)window[f[a]]=d.exports}}}finally{vf.pop()}return d.exports}wf.cache={};wf.resolve=function(a){return a};
wf.exportCopy=function(a,b){let c={};a=a.exports;for(let d in b)"default"==d||d in a||d in c||(c[d]={enumerable:!0,get:function(){return b[d]}});Object.defineProperties(a,c)};wf.esmDefault=function(a){return a&&a.__esModule?a:{"default":a}};wf.dynamic=function(a){return Promise.resolve().then(function(){return wf(a)})};var xf;xf=wf(0,{});function yf(a,b,c){return a.sprite(b,Le(c))}function zf(a,b,c,d){a.loadSprite(b,c,Le(d))}function Af(a,b){return a.add(Le(b))}function Bf(a,b){return a.onButtonPress("jump",b)}function Cf(a,b,c){a.play(b,Le(c))}function Df(a,b){a.onGround(b)}function Ef(a,b){return a.area(Le(b))}function Ff(a){return a.anchor("center")}function Gf(a,b){return a.body(Le(b))}function Hf(a,b,c){return a.pos(b,c)}function If(a,b){a.onUpdate(b)}function Jf(a,b,c){return a.wait(b,c)}
function Kf(a,b,c){a.onCollide(b,c)}function Lf(a,b,c){return a.text(b,Le(c))}function Mf(a,b){return a.loop(1,b)};function Nf(a){return M(Zb(a.get("game-state")))}function Of(a){a=Nf(a);return w(a)?a.speed:1E3}function Pf(a){a=Nf(a);return w(a)?a.score:0}function Qf(a,b){a=Nf(a);return w(a)?a.score=b:N};function Rf(a){a.loadSound("jump","/sonic-runner-cljs/sounds/jump.wav");a.loadSound("destroy","/sonic-runner-cljs/sounds/destroy.wav");a.loadSound("hyper-ring","/sonic-runner-cljs/sounds/hyper-ring.wav");a.loadSound("hurt","/sonic-runner-cljs/sounds/hurt.wav");zf(a,"sonic","/sonic-runner-cljs/graphics/sonic.png",new v(null,3,[kf,8,lf,2,hf,new v(null,2,[of,new v(null,4,[Se,0,Xe,7,gf,!0,We,30],null),bf,new v(null,4,[Se,8,Xe,15,gf,!0,We,100],null)],null)],null))}
function Sf(a,b,c){var d=M(Zb(b.get("score")));w(d)&&(d.text=c,Jf(a,1,function(){return d.text=""}))}
function Tf(a){Rf(a);var b=Af(a,new X(null,7,5,Y,[yf(a,"sonic",new v(null,1,[Ne,"run"],null)),a.scale(4),a.area(),a.z(10),Ff(a),Gf(a,new v(null,1,[rf,1300],null)),a.pos(200,745)],null));Bf(a,function(){return w(b.isGrounded())?(b.play("jump"),Cf(a,"jump",new v(null,1,[mf,.5],null)),b.jump()):null});Df(b,function(){return b.play("run")});Kf(b,"ring",function(c){Cf(a,"ring",new v(null,1,[mf,.5],null));a.destroy(c);Sf(a,b,"+1");c=Pf(a);return Qf(a,c+1)});Kf(b,"motobug",function(c){w(b.isGrounded())?
(Cf(a,"hurt",new v(null,1,[mf,.5],null)),c=M(Zb(a.get("game-state"))),c=w(c)?a.go(qf,a,c):a.go(qf,a,$c)):(Cf(a,"destroy",new v(null,1,[mf,.5],null)),Cf(a,"hyper-ring",new v(null,1,[mf,.5],null)),a.destroy(c),b.play("jump"),b.jump(),Sf(a,b,"+10"),c=Pf(a),c=Qf(a,c+10));return c});Af(b,new X(null,5,5,Y,[Lf(a,"",new v(null,2,[Ze,"mania",Oe,20],null)),a.color(255,255,0),Ff(a),a.pos(0,-40),"score"],null))};function Uf(a){a.loadSprite("platform","/sonic-runner-cljs/graphics/platforms.png");a.loadSprite("chemical-bg","/sonic-runner-cljs/graphics/chemical-bg.png");a.loadSound("city","/sonic-runner-cljs/sounds/city.mp3")}
function Vf(a){Uf(a);Cf(a,"city",new v(null,2,[mf,.2,gf,!0],null));Af(a,new X(null,5,5,Y,[a.rect(1920,3E3),a.opacity(0),a.area(),a.pos(0,832),Gf(a,new v(null,1,[Ve,!0],null))],null));var b=Of(a),c=new X(null,2,5,Y,[Af(a,new X(null,4,5,Y,[a.sprite("chemical-bg"),a.pos(0,-50),a.scale(2),a.opacity(.5)],null)),Af(a,new X(null,4,5,Y,[a.sprite("chemical-bg"),a.pos(3840,-50),a.scale(2),a.opacity(.5)],null))],null);If(a,function(){var f=b/3,h=c.i?c.i(0):c.call(null,0),k=c.i?c.i(1):c.call(null,1);h.move(-1*
f,0);k.move(-1*f,0);0>k.pos.x&&h.pos.x<k.pos.x&&h.moveTo(k.pos.x+3840,0);return 0>h.pos.x&&k.pos.x<h.pos.x?k.moveTo(h.pos.x+3840,0):null});var d=Of(a),e=new X(null,2,5,Y,[Af(a,new X(null,3,5,Y,[a.sprite("platform"),a.pos(0,450),a.scale(4)],null)),Af(a,new X(null,3,5,Y,[a.sprite("platform"),a.pos(5120,450),a.scale(4)],null))],null);If(a,function(){var f=e.i?e.i(0):e.call(null,0),h=e.i?e.i(1):e.call(null,1);f.move(-1*d,0);h.move(-1*d,0);0>h.pos.x&&f.pos.x<h.pos.x&&f.moveTo(h.pos.x+5120,450);return 0>
f.pos.x&&h.pos.x<f.pos.x?h.moveTo(f.pos.x+5120,450):null})};function Wf(a){a.loadSound("ring","/sonic-runner-cljs/sounds/ring.wav");zf(a,"ring","/sonic-runner-cljs/graphics/ring.png",new v(null,3,[kf,16,lf,1,hf,new v(null,1,[$e,new v(null,4,[Se,0,Xe,15,gf,!0,We,30],null)],null)],null))}function Xf(a,b,c){Wf(a);var d=Of(a),e=Af(a,new X(null,7,5,Y,[yf(a,"ring",new v(null,1,[Ne,"spin"],null)),a.scale(4),Ef(a,a.rect(a.vec2(-5,0),32,32)),Ff(a),a.offscreen(Le(new v(null,1,[Ye,!0],null))),a.pos(b,c),"ring"],null));If(a,function(){return e.move(-1*d,0)})};function Yf(a,b,c){zf(a,"motobug","/sonic-runner-cljs/graphics/motobug.png",new v(null,3,[kf,5,lf,1,hf,new v(null,1,[of,new v(null,4,[Se,0,Xe,4,gf,!0,We,8],null)],null)],null));var d=Of(a),e=Af(a,new X(null,8,5,Y,[yf(a,"motobug",new v(null,1,[Ne,"run"],null)),a.scale(4),Ef(a,a.rect(a.vec2(-5,0),32,32)),Ff(a),a.offscreen(Le(new v(null,1,[Ye,!0],null))),a.pos(b,c),new v(null,1,[We,500],null),"motobug"],null));If(a,function(){return e.move(-1*(d+e.speed),0)})};function Zf(a){var b=Af(a,new X(null,3,5,Y,[Lf(a,["SCORE: ",A.i(Pf(a))].join(""),new v(null,2,[Ze,"mania",Oe,72],null)),a.pos(50,0),a.color(50,150,230)],null)),c=Af(a,new X(null,3,5,Y,[Lf(a,["SPEED: ",A.i(Of(a))].join(""),new v(null,2,[Ze,"mania",Oe,72],null)),a.pos(50,75),a.color(50,150,230)],null));If(a,function(){b.text=["SCORE: ",A.i(Pf(a))].join("");return c.text=["SPEED: ",A.i(Of(a))].join("")})};var $f=function $f(a,b,c){Xf(a,b,c);var e=a.rand(.5,5);return Jf(a,e,function(){return $f.s?$f.s(a,b,c):$f.call(null,a,b,c)})},ag=function ag(a,b,c){Yf(a,b,c);var e=a.rand(.5,5);return Jf(a,e,function(){return ag.s?ag.s(a,b,c):ag.call(null,a,b,c)})};function bg(a){return Mf(a,function(){var b=Of(a);if(w(new X(null,1,5,Y,[1500>b],null))){b+=25;var c=Nf(a);b=w(c)?c.speed=b:N}else b=null;return b})};var cg,dg;a:for(var eg=[Re,ff,Ue,cf,pf,sf,jf,Qe,ef],fg=[new v(null,1,[bf,new v(null,2,[nf,new X(null,1,5,Y,["space"],null),df,"left"],null)],null),!1,1920,new X(null,3,5,Y,[0,0,0],null),!0,"d",!0,!0,1080],gg=eg.length,hg=0,ig=db(Ld);;)if(hg<gg){if(fg.length<=hg)throw Error(["No value supplied for key: ",A.i(eg[hg])].join(""));var jg=hg+1,kg=gb(ig,eg[hg],fg[hg]);hg=jg;ig=kg}else{dg=fb(ig);break a}cg=xf.default(Le(dg));cg.setGravity(3100);
cg.scene(Pe,function(a){Af(a,new X(null,2,5,Y,[new v(null,2,[af,0,We,1E3],null),"game-state"],null));Tf(a);Vf(a);Zf(a);$f(a,1950,745);ag(a,1950,773);return bg(a)});
cg.scene(qf,function(a,b){Af(a,new X(null,3,5,Y,[Lf(a,"GAME OVER",new v(null,2,[Ze,"mania",Oe,96],null)),Hf(a,a.center().x,200),Ff(a)],null));Af(a,new X(null,4,5,Y,[Lf(a,["SCORE: ",A.i(b.score)].join(""),new v(null,2,[Ze,"mania",Oe,96],null)),Hf(a,a.center().x,380),Ff(a),a.color(255,255,0)],null));Af(a,new X(null,3,5,Y,[Lf(a,"Press Space / Click / Touch to return to main menu",new v(null,2,[Ze,"mania",Oe,48],null)),Hf(a,a.center().x,a.center().y-0),Ff(a)],null));return Bf(a,function(){return a.go(Te,
a)})});cg.scene(Te,function(a){a.loadFont("mania","/sonic-runner-cljs/fonts/mania.ttf");Tf(a);Vf(a);Af(a,new X(null,3,5,Y,[Lf(a,"SONIC RING RUN",new v(null,2,[Ze,"mania",Oe,96],null)),Hf(a,a.center().x,200),Ff(a)],null));Af(a,new X(null,3,5,Y,[Lf(a,"Press Space / Click / Touch to Play",new v(null,2,[Ze,"mania",Oe,48],null)),Hf(a,a.center().x,a.center().y-200),Ff(a)],null));return Bf(a,function(){return a.go(Pe,a)})});cg.go(Te,cg);console.log("Sonic infinite scroller Initialized");
}).call(this);